/*
 * wallaby-vscode - v1.0.244
 * http://wallabyjs.com
 * Copyright (c) 2014-2020 Wallaby.js - All Rights Reserved.
 *
 * This source code file is a part of wallaby-vscode and is a proprietary (closed source) software.

 * IMPORTANT:
 * Wallaby.js is a tool made by software developers for software developers with passion and love for what we do.
 * Pirating the tool is not only illegal and just morally wrong,
 * it is also unfair to other fellow programmers who are using it legally,
 * and very harmful for the tool and its future.
 */

!function r(s,l,c){process.env.WALLABY_PRODUCTION=!0;var u="function"==typeof require&&require;module.exports=function a(i,e){if(!l[i]){if(!s[i]){var t="function"==typeof require&&require;if(!e&&t)return t(i,!0);if(u)return u(i,!0);var n=new Error("Cannot find module '"+i+"'");throw n.code="MODULE_NOT_FOUND",n}var o=l[i]={exports:{}};s[i][0].call(o.exports,function(e){var t=s[i][1][e];return a(t||e)},o,o.exports,r,s,l,c)}return l[i].exports}(c[0])}({1:[function(l,e,t){"use strict";var u=this&&this.__assign||function(){return(u=Object.assign||function(e){for(var t,a=1,i=arguments.length;a<i;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},d=this&&this.__awaiter||function(e,r,s,l){return new(s||(s=Promise))(function(a,t){function i(e){try{o(l.next(e))}catch(e){t(e)}}function n(e){try{o(l.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(i,n)}o((l=l.apply(e,r||[])).next())})},_=this&&this.__generator||function(a,i){var n,o,r,e,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&t[0]?o.return:t[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,t[1])).done)return r;switch(o=0,r&&(t=[2&t[0],r.value]),t[0]){case 0:case 1:r=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,o=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(r=0<(r=s.trys).length&&r[r.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!r||t[1]>r[0]&&t[1]<r[3])){s.label=t[1];break}if(6===t[0]&&s.label<r[1]){s.label=r[1],r=t;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(t);break}r[2]&&s.ops.pop(),s.trys.pop();continue}t=i.call(a,s)}catch(e){t=[6,e],o=0}finally{n=r=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},v=l("fs"),b=l("path"),w=l("os"),s=l("vscode"),a=l("./lib/compositeDisposable"),T=s.window,i=s.workspace,r=/^darwin/.test(process.platform),c=l("./package.json").version,n=function(){function m(){}return m.prototype.activate=function(o){return d(this,void 0,void 0,function(){var t=this;return _(this,function(e){return this.strictSSL=void 0,this.protocol="https",this._disposables=new a,o.subscriptions.push({dispose:function(){return t.deactivate()}}),this._initializeDownloadSettings(),this._initializeImages(o),this._disposables.add(function(){delete t._failedUpdateCount,clearTimeout(t._updateChecker)}),setImmediate(function(){return d(t,void 0,void 0,function(){var t,u,a,i,n=this;return _(this,function(e){switch(e.label){case 0:this._baseUrl=this.protocol+"://update.wallabyjs.com/",this._versionFile=b.join(__dirname,"wallaby.json"),this._corePackage=b.join(__dirname,"..","wallaby","package.json"),this._coreFolder=b.dirname(this._corePackage),this._coreVersionManifest=b.join(__dirname,"..","core.json"),this._lkp=b.join(w.homedir(),".wallaby","key.lic"),this._oldlkp=b.join(v.realpathSync(o.extensionPath),"..",".wlck"),this._updating=!0,!v.existsSync(this._lkp)&&v.existsSync(this._oldlkp)&&(this._lkp=this._oldlkp),(m._isDebugMode()||m._noAutomaticInstallMode())&&(this._baseDownload=function(){throw new Error("Can not delete/download/extract in this mode")}),this._setupStatusIndicator(),this._readVersionManifestAndRefreshCoreLocation(),t=!v.existsSync(b.join(w.homedir(),".wallaby")),u={context:o,coreClient:this._reloadCoreClient(),reloadCoreClient:function(){n._updatingAfterLicenseChange?delete u.coreClient:(n._readVersionManifestAndRefreshCoreLocation(),u.coreClient=n._reloadCoreClient(),u.coreVersion=n._wallabyCoreVersion(),n._updating||u.coreClient||(clearTimeout(n._updateChecker),n._performUpdate(u,!1)))},statusBar:this._statusBar,onFirstStart:function(){clearTimeout(n._updateChecker),n._performUpdate(u,!1)},licenseChanged:function(e){var o=e.wasRunning,r=e.hasEverStartedOnOpenedProject,s=e.newKey,l=e.start,c=e.stop;return d(n,void 0,void 0,function(){var t,a,i,n=this;return _(this,function(e){switch(e.label){case 0:return this._updatingAfterLicenseChange=!0,t=!1,a=u.coreVersion,this._readVersionManifestAndRefreshCoreLocation(),a!==this._wallabyCoreVersion()&&o&&(c(),t=!0),i=function(){return d(n,void 0,void 0,function(){var t;return _(this,function(e){switch(e.label){case 0:t=u.updateAvailable,e.label=1;case 1:return e.trys.push([1,,3,4]),u.updateAvailable=function(){},clearTimeout(this._updateChecker),[4,this._performUpdate(u,!1)];case 2:return e.sent(),this._readVersionManifestAndRefreshCoreLocation(),u.coreClient=this._reloadCoreClient(),u.coreVersion=this._wallabyCoreVersion(),[3,4];case 3:return u.updateAvailable=t,[7];case 4:return[2]}})})},o?[3,2]:[4,i()];case 1:return e.sent(),[3,6];case 2:return s.freeLicense?(c(),t=!0,[4,i()]):[3,4];case 3:return e.sent(),[3,6];case 4:return u.onCoreDownload=function(){c(),t=!0},[4,i()];case 5:e.sent(),delete u.onCoreDownload,e.label=6;case 6:return delete this._updatingAfterLicenseChange,(t||!o&&r)&&l(),[2]}})})},readyForUse:function(){},updateAvailable:function(){},forceCoreUpdate:function(){m._isDebugMode()||m._noAutomaticInstallMode()?T.showErrorMessage("Force core update is not available when 'wallaby.noAutomaticInstall' is 'true'."):(T.showInformationMessage("Downloading Wallaby.js core. Depending on the speed of your internet connection this may take a few moments."),clearTimeout(n._updateChecker),n._performUpdate(u,!0))},debug:m._isDebugMode(),licensed:!1,isMac:r,firstInstall:t,deactivate:function(){return n.deactivate()},version:m._getVsCodeVersion(),coreVersion:this._wallabyCoreVersion()};try{a=l("./lib/controller"),this._controller=new a(u),this._controller.activate(),this._disposables.add(function(){return n._controller.deactivate()})}catch(e){m._notifyError(e.message)}e.label=1;case 1:return e.trys.push([1,3,4,5]),[4,this._updateIfRequired(!0,void 0,!1,!0,void 0)];case 2:return e.sent(),u.coreClient||u.reloadCoreClient(),console.log("[Wallaby Console] VS Code extension v"+c),console.log("[Wallaby Console] Core v"+u.coreVersion),this._hideStatusIndicator(),u.readyForUse(),[3,5];case 3:return i=e.sent(),m._notifyError(i.message),[3,5];case 4:return this._hideStatusIndicator(),this._updating=!1,[7];case 5:return[2]}})})}),[2]})})},m.prototype._wallabyCoreVersion=function(){try{return m._requireNoCache(this._corePackage).version}catch(e){return"0.0.0"}},m.prototype._addNewVersionToManifest=function(e,t){var a;try{a=JSON.parse(v.readFileSync(this._coreVersionManifest).toString());var i=(new Date).getTime();Object.keys(a).forEach(function(e){!a[e].invalidated&&a[e].releaseDate<=t&&(a[e].invalidated=i)})}catch(e){a={}}a[e]={releaseDate:t,invalidated:!1,expiry:{}},this._readVersionManifestAndRefreshCoreLocation(a,!0)},m.prototype._readVersionManifestAndRefreshCoreLocation=function(t,a){var e;if(!t)try{t=JSON.parse(v.readFileSync(this._coreVersionManifest).toString())}catch(e){try{if(!v.existsSync(this._corePackage))return;m._requireNoCache(this._corePackage).version;var i=v.statSync(this._corePackage).mtime.getTime();t={"":{releaseDate:i,invalidated:!(a=!0),expiry:{}}}}catch(e){return}}var n=null===(e=this._expiryDate())||void 0===e?void 0:e.getTime(),o=Object.keys(t).map(function(e){return u({id:e,folder:b.join(__dirname,"..","wallaby"+e)},t[e])}).sort(function(e,t){return t.releaseDate-e.releaseDate}),r=(new Date).getTime()-72e5;o.forEach(function(e){v.existsSync(e.folder)?e.invalidated&&0===Object.keys(e.expiry).length&&e.invalidated<r&&(a=!0,delete t[e.id],m._remove(e.folder,!0)):(a=!0,delete t[e.id])});var s=o.filter(function(e){return(!n||e.releaseDate<n)&&t[e.id]});if(s.length){if(n&&n<(new Date).getTime()&&!t[s[0].id].expiry[n]){t[s[0].id].expiry[n]=!0;for(var l=1;l<s.length;l++)delete t[s[l].id].expiry[n];a=!0}var c=(s.find(function(e){return!e.invalidated})||s[0]).id;this._corePackage=b.join(__dirname,"..","wallaby"+c,"package.json")}else this._corePackage=b.join(__dirname,"..","wallaby_missing","package.json");return this._coreFolder=b.dirname(this._corePackage),a&&v.writeFileSync(this._coreVersionManifest,JSON.stringify(t)),t},m.prototype._initializeDownloadSettings=function(){try{var e=s.workspace.getConfiguration();if(e){var t=e.get("http.proxy","");t&&(process.env.http_proxy=t);var a=e.get("https.proxy","");a&&(process.env.https_proxy=a)}}catch(e){}try{s.workspace.getConfiguration()&&(s.workspace.getConfiguration().get("wallaby.useHttpForDownload",!1)&&(this.protocol="http"),s.workspace.getConfiguration().get("wallaby.strictSSL",!0)||(this.strictSSL=!1))}catch(e){}},m.prototype._initializeImages=function(i){try{var e=s.workspace.getConfiguration();if(e){var n=e.get("wallaby.colors",{});n&&Object.keys(n).forEach(function(t){try{if(!t)return;var e=i.asAbsolutePath(b.join("images",t+".svg"));if(!v.existsSync(e))return;var a=(~t.indexOf("snapshot")?'<svg width="16px" height="16px" xmlns="http://www.w3.org/2000/svg"'+w.EOL+'     viewBox="0 0 16 16">'+w.EOL+'  <path fill="#62b455"'+w.EOL+'        d="m 13.5,5.25 v 7.071429 C 13.5,12.972098 13.038098,13.5 12.46875,13.5 H 3.53125 C 2.9619018,13.5 2.5,12.972098 2.5,12.321429 V 5.25 C 2.5,4.5993304 2.9619018,4.0714286 3.53125,4.0714286 H 5.421875 L 5.6861206,3.2636161 C 5.8365357,2.8044643 6.2210937,2.5 6.6507812,2.5 h 2.6962772 c 0.4296873,0 0.8142946,0.3044643 0.9646606,0.7636161 l 0.266406,0.8078125 H 12.46875 C 13.038098,4.0714286 13.5,4.5993304 13.5,5.25 Z M 10.578125,8.7857143 C 10.578125,7.1602674 9.4222908,5.8392857 8,5.8392857 c -1.4222411,0 -2.578125,1.3209817 -2.578125,2.9464286 0,1.6254467 1.1558839,2.9464277 2.578125,2.9464277 1.4222908,0 2.578125,-1.320981 2.578125,-2.9464277 z m -0.6875,0 c 0,1.190849 -0.8486201,2.1607147 -1.890625,2.1607147 -1.0420044,0 -1.890625,-0.9698657 -1.890625,-2.1607147 0,-1.1908487 0.8486206,-2.1607148 1.890625,-2.1607148 1.0420049,0 1.890625,0.9698661 1.890625,2.1607148 z"></path>'+w.EOL+"</svg>":'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="16px" height="16px">'+w.EOL+"  <g>"+w.EOL+'    <rect x="2.5" y="2.5" width="11" height="11" rx="2.5" ry="2.5" style="fill:#62b455;fill-opacity:1;" />'+w.EOL+"  </g>"+w.EOL+"</svg>").replace(/fill:#.[^;]*/,"fill:"+n[t]).replace(/fill="#.[^"]*/,'fill="'+n[t]);a!==v.readFileSync(e).toString()&&v.writeFileSync(e,a)}catch(e){console.error("Failed to set icon "+t+" type to "+n[t]+". "+e.message)}})}}catch(e){}},m.prototype._reloadCoreClient=function(){var a=this;Object.keys(originalRequire.cache).forEach(function(e){var t=originalRequire.cache[e];t.filename&&~t.filename.indexOf(a._coreFolder+b.sep)&&delete originalRequire.cache[e]});try{return originalRequire(b.join(this._coreFolder,"client"))}catch(e){return}},m.prototype._performUpdate=function(i,n){return d(this,void 0,void 0,function(){var t,a=this;return _(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,3,4]),this._updating=!0,[4,this._updateIfRequired(!1,i.licensed,n,!1,i.onCoreDownload)];case 1:if(e.sent())try{delete this._failedUpdateCount,this.showUpdateNotifications()&&T.showInformationMessage("Wallaby.js core has been successfully updated to v"+m._requireNoCache(this._corePackage).version+"."),i.updateAvailable(n)}catch(e){console.error(e)}return[3,4];case 2:return t=e.sent(),this._failedUpdateCount=this._failedUpdateCount?this._failedUpdateCount+1:1,console.error(t),[3,4];case 3:return this._failedUpdateCount&&3<this._failedUpdateCount?[2]:(this._updateChecker=setTimeout(function(){return a._performUpdate(i,!1)},6e5),this._updating=!1,[7]);case 4:return[2]}})})},m.prototype._updateIfRequired=function(p,h,g,f,y){return d(this,void 0,void 0,function(){var t,a,i,n,o,r,s,l,c,u,d=this;return _(this,function(e){switch(e.label){case 0:return t=!1,a=this._expiryDateString(),i=this._baseUrl,n=function(e){return d._download({name:"version",from:e+"wallaby.json?licensed="+(h?"true":"false")+(a?"&expiry="+a.replace(/\//g,"-"):""),to:d._versionFile})},g?(r=!1,[3,3]):[3,1];case 1:return[4,m._stat(this._corePackage)];case 2:r=e.sent(),e.label=3;case 3:if(o=r,s=b.join(w.homedir(),".wallaby","downloads","wallaby.zip"),o||g||!v.existsSync(s))return[3,7];e.label=4;case 4:return e.trys.push([4,6,,7]),[4,this._extract(s,this._coreFolder)];case 5:return e.sent(),o=v.statSync(this._corePackage),f||(t=!0),[3,7];case 6:return l=e.sent(),console.error(l),[3,7];case 7:return m._isDebugMode()||m._noAutomaticInstallMode()||p&&o?(c={core:o&&m._requireNoCache(this._corePackage).version||"unknown"},[3,14]):[3,8];case 8:this._statusUpdater("Downloading wallaby.js version file"),e.label=9;case 9:return e.trys.push([9,11,,13]),[4,n(this._baseUrl)];case 10:return e.sent(),[3,13];case 11:return e.sent(),i=this.protocol+"://s3.amazonaws.com/wallaby-downloads/",[4,n("http://update.wallabyjs.com/")];case 12:return e.sent(),[3,13];case 13:c=this._version(),e.label=14;case 14:if(u=!0,(m._isDebugMode()||m._noAutomaticInstallMode())&&!o)throw new Error("With wallaby.noAutomaticInstall option set, you need to manually install wallaby core and dependencies when the extension is installed/updated.");if(o&&m._requireNoCache(this._corePackage).version===c.core)return[3,19];this._statusUpdater("Downloading and extracting wallaby.js core"),u=!1,y&&y(),e.label=15;case 15:return e.trys.push([15,17,,19]),[4,this._downloadZip({name:"core",from:i+"wallaby-v"+c.core+".zip"})];case 16:return t=e.sent(),[3,19];case 17:return e.sent(),[4,this._downloadZip({name:"core",from:this.protocol+"://s3.amazonaws.com/wallaby-downloads/wallaby-v"+c.core+".zip"})];case 18:return t=e.sent(),[3,19];case 19:return p&&!u&&this.showUpdateNotifications()&&T.showInformationMessage("Wallaby.js core v"+c.core+" has been successfully installed."),[2,t]}})})},m._isDebugMode=function(){return i.getConfiguration()&&i.getConfiguration().get("wallaby.debug",!1)},m._noAutomaticInstallMode=function(){return i.getConfiguration()&&i.getConfiguration().get("wallaby.noAutomaticInstall",!1)},m.prototype._version=function(){var t;return m._requireNoCache(this._versionFile).latestServer.forEach(function(e){e.substring(0,e.lastIndexOf("."))===c.substring(0,e.lastIndexOf("."))&&(t=e)}),{core:t}},m._requireNoCache=function(e){return delete originalRequire.cache[originalRequire.resolve(e)],originalRequire(e)},m._stat=function(e){try{return v.statSync(e)}catch(e){return!1}},m._remove=function(n,a){return d(this,void 0,void 0,function(){var t;return _(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,6]),[4,new Promise(function(a,i){l("fs-extra").remove(n,function(e,t){e?i(e):a()})})];case 1:return e.sent(),[3,6];case 2:if(t=e.sent(),!a)return[3,3];throw t;case 3:return[4,m._remove(n,!0)];case 4:e.sent(),e.label=5;case 5:return[3,6];case 6:return[2]}})})},m.prototype._downloadZip=function(n){return d(this,void 0,void 0,function(){var t,a,i;return _(this,function(e){switch(e.label){case 0:return v.existsSync(b.join(w.homedir(),".wallaby"))||v.mkdirSync(b.join(w.homedir(),".wallaby")),v.existsSync(b.join(w.homedir(),".wallaby","downloads"))||v.mkdirSync(b.join(w.homedir(),".wallaby","downloads")),t=b.join(w.homedir(),".wallaby","downloads","wallaby.zip"),[4,this._baseDownload(n.from,n.name,t)];case 1:a=e.sent(),e.label=2;case 2:return e.trys.push([2,4,,5]),[4,this._extract(t,n.to)];case 3:return e.sent(),[3,5];case 4:throw i=e.sent(),new Error("Error while unzipping wallaby.js "+n.name+" file: "+i.message);case 5:return[2,a]}})})},m.prototype._download=function(t){return d(this,void 0,void 0,function(){return _(this,function(e){switch(e.label){case 0:return[4,this._baseDownload(t.from,t.name,t.to)];case 1:return[2,e.sent()]}})})},m.prototype._baseDownload=function(i,n,o){var r=this;return new Promise(function(t,a){var e=l("request");try{e({url:i,headers:{"User-Agent":"VS Code "+s.version},strictSSL:r.strictSSL}).pipe(v.createWriteStream(o)).on("error",function(e){return a(new Error("Error while downloading wallaby.js "+n+" file: "+e.message))}).on("error",function(e){return a(new Error("Error while saving wallaby.js "+n+" file: "+e.message))}).on("close",function(){return d(r,void 0,void 0,function(){return _(this,function(e){return[2,t(o)]})})}).on("response",function(e){e&&500<=e.statusCode&&a(new Error("Error while downloading wallaby.js "+n+" status code: "+e.statusCode))})}catch(e){a(e)}})},m.prototype._extract=function(s,e){return d(this,void 0,void 0,function(){var t,i,a,n,o,r;return _(this,function(e){switch(e.label){case 0:for(t=l("adm-zip-mit"),i=new t(s),a=new Date(i.getEntry("package.json").header.time),JSON.parse(i.readAsText("package.json")).version,n=l("crypto"),o=n.randomBytes(3).toString("hex");v.existsSync(b.join(__dirname,"..","wallaby"+o));)o=n.randomBytes(3).toString("hex");return r=b.join(__dirname,"..","wallaby"+o),[4,new Promise(function(t,a){i.extractAllToAsync(r,!0,function(e){e?a(e):t()})})];case 1:return e.sent(),this._addNewVersionToManifest(o,a.getTime()),[2]}})})},m._notifyError=function(e){T.showErrorMessage(e)},m.prototype._setupStatusIndicator=function(){var a=this;this._statusBar=T.createStatusBarItem(s.StatusBarAlignment.Right,Number.NEGATIVE_INFINITY),this._statusBar.show();var e=this._statusBar.hide.bind(this._statusBar),t=this._statusBar.dispose.bind(this._statusBar);this._statusBar.hide=function(){a._statusBar.stopProgress(),a._statusBar._mainText="",a._statusBar._extensionText="",a._statusBar.text="",a._statusBar.tooltip="",e()},this._statusBar.dispose=function(){a._statusBar.stopProgress(),t()},this._statusBar.displayProgress=function(){var e=0,t=["[=--------]","[-=-------]","[--=------]","[---=-----]","[----=----]","[-----=---]","[------=--]","[-------=-]","[--------=]","[-------=-]","[------=--]","[-----=---]","[----=----]","[---=-----]","[--=------]","[-=-------]"];clearInterval(a._statusBar._progress),a._statusBar._progress=setInterval(function(){a._statusBar.setMainText(t[e=++e%t.length]+"   "),a._statusBar._doUpdateText()},150)},this._statusBar.setMainText=function(e){a._statusBar._mainText=e},this._statusBar.setExtensionText=function(e){a._statusBar._extensionText=e},this._statusBar.updateText=function(){return a._statusBar._doUpdateText()},this._statusBar._doUpdateText=function(){a._statusBar.text=(a._statusBar._extensionText||"")+"   "+(a._statusBar._mainText||"")},this._statusBar.stopProgress=function(){clearInterval(a._statusBar._progress),delete a._statusBar._progress},this._statusBar.displayProgress(),this._statusUpdater=function(e){a._statusBar.tooltip=e},this._disposables.add(function(){a._removeStatusIndicator()}),this._statusBar.hide()},m.prototype._expiryDate=function(){try{var e=this._expiryDateString().split("/"),t=e[0],a=e[1],i=e[2];return new Date(Date.UTC(parseInt(i,10),parseInt(a,10)-1,parseInt(t,10)))}catch(e){}},m.prototype._expiryDateString=function(){try{var e=l("fs").readFileSync(this._lkp).toString();if(e){var t=e.split(":");2===t.length&&(e=(a=t[1])&&a.replace(/^\s+|\s+$/gm,""))}return new Buffer(e,"base64").toString().split("\n")[2]}catch(e){}var a},m._getVsCodeVersion=function(){try{var e=s.version.split("."),t=e[0],a=e[1];return{major:parseInt(t,10),minor:parseInt(a,10)}}catch(e){return{major:1,minor:0}}},m.prototype._hideStatusIndicator=function(){this._statusBar&&this._statusBar.hide(),this._statusUpdater=function(){}},m.prototype._removeStatusIndicator=function(){this._statusBar&&this._statusBar.dispose(),this._statusUpdater=function(){}},m.prototype.deactivate=function(){this._disposed||(this._disposables.dispose(),this._disposed=!0)},m.prototype.showUpdateNotifications=function(){return s.workspace.getConfiguration().get("wallaby.showUpdateNotifications",!0)},m}();t.activate=function(e){(new n).activate(e)}},{"./lib/compositeDisposable":3,"./lib/controller":4,"./package.json":11,"adm-zip-mit":void 0,crypto:void 0,fs:void 0,"fs-extra":void 0,os:void 0,path:void 0,request:void 0,vscode:void 0}],2:[function(a,e,t){"use strict";var i=a("vscode"),n=a("path");t.activate=function(e){var t=i.workspace.getConfiguration()&&i.workspace.getConfiguration().get("wallaby.debug",!1);return t&&(global.originalRequire=a),t||"dist"===n.basename(__dirname)?a("./extension").activate(e):(global.originalRequire=a)("./dist/index").activate(e)}},{"./extension":1,path:void 0,vscode:void 0}],3:[function(e,t,a){"use strict";var i=function(){function e(){this._disposables=[]}return e.prototype.add=function(e){e.dispose?this._disposables.push(e):this._disposables.push({dispose:e})},e.prototype.dispose=function(){this._disposables.forEach(function(e){return e.dispose()})},e}();t.exports=i},{}],4:[function(o,e,t){"use strict";var i,a=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)},function(e,t){function a(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}),r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,a=1,i=arguments.length;a<i;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},s=this&&this.__awaiter||function(e,r,s,l){return new(s||(s=Promise))(function(a,t){function i(e){try{o(l.next(e))}catch(e){t(e)}}function n(e){try{o(l.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(i,n)}o((l=l.apply(e,r||[])).next())})},h=this&&this.__generator||function(a,i){var n,o,r,e,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&t[0]?o.return:t[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,t[1])).done)return r;switch(o=0,r&&(t=[2&t[0],r.value]),t[0]){case 0:case 1:r=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,o=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(r=0<(r=s.trys).length&&r[r.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!r||t[1]>r[0]&&t[1]<r[3])){s.label=t[1];break}if(6===t[0]&&s.label<r[1]){s.label=r[1],r=t;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(t);break}r[2]&&s.ops.pop(),s.trys.pop();continue}t=i.call(a,s)}catch(e){t=[6,e],o=0}finally{n=r=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},u=this&&this.__spreadArrays||function(){for(var e=0,t=0,a=arguments.length;t<a;t++)e+=arguments[t].length;var i=Array(e),n=0;for(t=0;t<a;t++)for(var o=arguments[t],r=0,s=o.length;r<s;r++,n++)i[n]=o[r];return i},C=o("path"),n=o("crypto"),_=o("fs-extra"),v=o("os"),S=o("vscode"),l=o("events"),k=o("lodash"),D=o("./compositeDisposable"),E=o("./screenshotContentProvider"),P=o("./testTimelineContentProvider"),O=o("./testsOutputBuilder"),N=o("./valueExplorer"),j=o("./traceExplorer"),F=o("./testFileCoverageExplorer"),y=S.workspace,L=S.window,A="wallaby-output",c=1,R={"wallaby.start":{visible:!0},"wallaby.stop":{visible:!0},"wallaby.startExclusively":{visible:!0},"wallaby.showCommandPalette":{visible:!1},"wallaby.showLastScreenshot":{visible:!0},"wallaby.showLicense":{visible:!0},"wallaby.runProjectTests":{visible:!0},"wallaby.runLineTests":{visible:!0},"wallaby.runFileTests":{visible:!0},"wallaby.updateProjectSnapshots":{visible:!0},"wallaby.updateFileSnapshots":{visible:!0},"wallaby.updateTestSnapshots":{visible:!0},"wallaby.jumpToFailingTest":{visible:!0},"wallaby.jumpToErrorSource":{visible:!0},"wallaby.toggleUncovered":{visible:!0},"wallaby.toggleTestFilter":{visible:!0},"wallaby.showLineTests":{visible:!0},"wallaby.showLineTestsFromMenu":{visible:!1},"wallaby.selectConfigFile":{visible:!0},"wallaby.showFailingTests":{visible:!0},"wallaby.showSideBySideDiff":{visible:!0},"wallaby.openWallabyApp":{visible:!0},"wallaby.showValue":{visible:!0},"wallaby.copyValue":{visible:!0},"wallaby.copyExpressionPath":{visible:!1},"wallaby.copyExpressionData":{visible:!1},"wallaby.goToExpressionSource":{visible:!1},"wallaby.copyDiagnosticsReportToClipboard":{visible:!0},"wallaby.runModeOnSave":{visible:!0},"wallaby.runModeImmediate":{visible:!0},"wallaby.runModeToggle":{visible:!0},"wallaby.forceCoreUpdate":{visible:!0},"wallaby.resetTestFilter":{visible:!1},"wallaby.resetUncovered":{visible:!1},"wallaby.playTraceNextStep":{visible:!1},"wallaby.playTracePrevStep":{visible:!1},"wallaby.playTraceNextStepOut":{visible:!1},"wallaby.playTracePrevStepOut":{visible:!1},"wallaby.playTraceNextStepOver":{visible:!1},"wallaby.playTracePrevStepOver":{visible:!1},"wallaby.playTraceForwardToSelection":{visible:!1},"wallaby.playTraceBackwardToSelection":{visible:!1},"wallaby.openCallStackFrame":{visible:!1},"wallaby.revealTraceStep":{visible:!1},"wallaby.stopTraceNavigation":{visible:!1},"wallaby.statusBarCommand":{visible:!1},"wallaby.debugTest":{visible:!0},"wallaby.showTestStory":{visible:!0},"wallaby.showTestStoryBeside":{visible:!0},"wallaby.jumpToTest":{visible:!0},"wallaby.searchTests":{visible:!0},"wallaby.openFile":{visible:!1},"wallaby.addToExclusiveTestRun":{visible:!0},"wallaby.addToExclusiveTestRunFromMenu":{visible:!1},"wallaby.startExclusivelyFromMenu":{visible:!1},"wallaby.revealValue":{visible:!0},"wallaby.lockTestStory":{visible:!1},"wallaby.unlockTestStory":{visible:!1},"wallaby.navigate":{visible:!1}},B={"wallaby.feature.diagnostics":{version:[1,0,735],enabled:!0},"wallaby.feature.debugger":{version:[1,0,799],enabled:!0},"wallaby.feature.testStory":{version:[1,0,899],enabled:!0},"wallaby.feature.exclusiveTestRun":{version:[1,0,865],enabled:!0},"wallaby.feature.testFilters":{version:[1,0,778],enabled:!0}},d=function(x){function p(t){var u=x.call(this)||this,d=u;u._state=t,u._context=t.context,u._statusBar=t.statusBar,u._reloadCoreClient=t.reloadCoreClient;var e=function(e){if(t&&t.coreClient)return e(t.coreClient)};u._tryGetSession=function(){return e(function(e){return e.Session})},u._tryGetUtils=function(){return e(function(e){return e.utils})},u._tryGetDmp=function(){return e(function(e){return e.dmp})},u._isMac=t.isMac,u._firstInstall=t.firstInstall,u._deactivator=t.deactivate,u._lineAndColumnLinks=!1,u._activeLicenseSession=null,u._coreVersion=t.coreVersion,u._setFeatureContext(),t.updateAvailable=k.bind(u._updateAvailable,u),t.readyForUse=k.bind(u._readyForUse,u),u._disposables=new D,k.each(R,function(e,t){return d._disposables.add(S.commands.registerCommand(t,function(e){return d[t.substring(8,t.length)](e)}))}),u._activeTraceFrameWithNowhereToGoDecorationType=L.createTextEditorDecorationType({rangeBehavior:1,borderStyle:"solid",borderRadius:"2px",borderWidth:"1px",dark:{backgroundColor:"rgba(255, 0, 0, 0.2)",borderColor:"rgba(255, 0, 0, 0.2)"},light:{backgroundColor:"rgba(255, 0, 52, 0.35)",borderColor:"rgba(255, 0, 52, 0.35)"}}),u._activeTraceFrameDecorationType=L.createTextEditorDecorationType({rangeBehavior:1,borderStyle:"solid",borderRadius:"2px",borderWidth:"1px",dark:{backgroundColor:"rgba(255, 255, 0, 0.2)",borderColor:"rgba(255, 255, 0, 0.2)"},light:{backgroundColor:"rgba(255, 255, 102, 0.45)",borderColor:"rgba(255, 255, 102, 0.45)"}});var a={rangeBehavior:1,borderStyle:"solid",borderRadius:"2px",borderWidth:"1px",dark:{backgroundColor:"rgba(122, 189, 122, 0.3)",borderColor:"rgba(122, 189, 122, 0.3)"},light:{backgroundColor:"rgba(206, 231, 206, 0.45)",borderColor:"rgba(206, 231, 206, 0.45)"}};u._activeTraceCallStackFrameDecorationType=L.createTextEditorDecorationType(a),u._activeValueCallStackFrameDecorationType=L.createTextEditorDecorationType(a);var i="#c80000",n="#fe536a",o="#0000ff",r="rgba(86, 156, 214, 1)",s=new S.ThemeColor("editorCodeLens.foreground"),l=s,c=s;u._coverageDecorationTypes={0:u._createCoverageDecorationType("errorSource",o,r),1:u._createCoverageDecorationType("notCovered",o,r),2:u._createCoverageDecorationType("covered",o,r),3:u._createCoverageDecorationType("partiallyCovered",o,r),4:u._createCoverageDecorationType("errorSource",i,n),5:u._createCoverageDecorationType("errorPath",o,r),6:u._createCoverageDecorationType("errorSource",l,c),7:u._createCoverageDecorationType("notCovered",l,c),8:u._createCoverageDecorationType("covered",l,c),9:u._createCoverageDecorationType("partiallyCovered",l,c),10:u._createCoverageDecorationType("errorSource",i,n),11:u._createCoverageDecorationType("errorPath",l,c),20:u._createCoverageDecorationType("snapshot.errorSource",o,r),21:u._createCoverageDecorationType("snapshot.notCovered",o,r),22:u._createCoverageDecorationType("snapshot.covered",o,r),23:u._createCoverageDecorationType("snapshot.partiallyCovered",o,r),24:u._createCoverageDecorationType("snapshot.errorSource",i,n),25:u._createCoverageDecorationType("snapshot.errorPath",o,r),26:u._createCoverageDecorationType("snapshot.errorSource",l,c),27:u._createCoverageDecorationType("snapshot.notCovered",l,c),28:u._createCoverageDecorationType("snapshot.covered",l,c),29:u._createCoverageDecorationType("snapshot.partiallyCovered",l,c),30:u._createCoverageDecorationType("snapshot.errorSource",i,n),31:u._createCoverageDecorationType("snapshot.errorPath",l,c)},u._outputDocumentSelector={language:A},u._setupVersionSpecificComponents(t.version),u._uncoveredRegionDecorationType=L.createTextEditorDecorationType({backgroundColor:"#d2a032",color:"#ffffff"}),u._testsOutputChannel=L.createOutputChannel("Wallaby.js Tests"),u._consoleOutputChannel=L.createOutputChannel("Wallaby.js Console"),u._testsOutputChannel.append("‌"),u._consoleOutputChannel.append("‍");var p=k.bind(d._absoluteFilePath,d);u._failingTestsOutput=new O(u._testsOutputChannel,p,u._tryGetDmp,u._disposables,u._lineAndColumnLinks,!0,u._outputDocumentSelector,u._sideBySideDiffSupported,k.bind(u._getWallabyAppUrl,u),"‌",k.bind(u._isInExperimentalMode,u)),u._lineTestsOutput=new O(u._testsOutputChannel,p,u._tryGetDmp,u._disposables,u._lineAndColumnLinks,void 0,u._outputDocumentSelector,u._sideBySideDiffSupported,k.bind(u._getWallabyAppUrl,u),"‌",k.bind(u._isInExperimentalMode,u)),S.workspace.registerTextDocumentContentProvider&&(d._screenshotProvider=new E(function(){return C.join(d._session.projectCachePath,"instrumented","screen.png")}),d._testTimelineContentProvider=new P(p),d._disposables.add(S.workspace.registerTextDocumentContentProvider("wallaby-screenshot",d._screenshotProvider)),d._disposables.add(S.workspace.registerTextDocumentContentProvider("wallaby-test-timeline",d._testTimelineContentProvider)),d._disposables.add(S.workspace.registerTextDocumentContentProvider("wallaby-diff",{provideTextDocumentContent:function(e){return new Buffer(e.query.toString(),"base64").toString()}})));var h=new S.CodeAction("Debug test",S.CodeActionKind.Empty),g=new S.CodeAction("Open test story",S.CodeActionKind.Empty),f=new S.CodeAction("Add test to filter",S.CodeActionKind.Empty),y=new S.CodeAction("Remove test from filter",S.CodeActionKind.Empty),m=new S.CodeAction("Reveal in Value Explorer",S.CodeActionKind.Empty),_=new S.CodeAction("Show assertion diff",S.CodeActionKind.Empty),v=new S.CodeAction("Update test snapshots",S.CodeActionKind.Empty),b=new S.CodeAction("Show value",S.CodeActionKind.Empty),w=new S.CodeAction("Jump to error source",S.CodeActionKind.Empty);h.command={command:"wallaby.debugTest",title:""},f.command=y.command={command:"wallaby.toggleTestFilter",title:""},g.command={command:"wallaby.showTestStory",title:""},m.command={command:"wallaby.revealValue",title:""},_.command={command:"wallaby.showSideBySideDiff",title:""},v.command={command:"wallaby.updateTestSnapshots",title:""},b.command={command:"wallaby.showValue",title:""},w.command={command:"wallaby.jumpToErrorSource",title:""},u._onDidUpdateDocuments=new S.EventEmitter;var T=["javascript","javascriptreact","typescript","typescriptreact","coffeescript","vue"];return u._disposables.add(S.languages.registerCodeActionsProvider(T,{provideCodeActions:function(e,t){if(d._session){var a=d._getDocumentFilePath(e),i=d._session.openedDocuments[a];if(i&&(!i.changeTs||i.changeTs<i.updateTs)){if(i.testDeclarations){var n=i.testDeclarations[t.end.line];if(n){if(u._traceExplorer.traceBeingNavigated())return[];var o=[h,g,n.filtered?y:f];return n.snap&&o.push(v),o}}var r=[],s=L.activeTextEditor;if(s){var l=s.selection;l&&l.start.line===l.end.line&&l.start.character!==l.end.character&&r.push(b)}if(i.messages&&i.messages[t.end.line]&&r.push(m),i.errors){var c=i.errors[t.end.line];c&&(c.diff&&r.push(_),c.snap&&r.push(v),c.source||r.push(w))}return r}}return[]}},{providedCodeActionKinds:[S.CodeActionKind.Empty]})),u._disposables.add(S.languages.registerHoverProvider(T,{provideHover:function(e,t){var a=d._stats&&d._stats.failingNumber,i=d._getDocumentFilePath(e),n=t.line+1,o=d._session&&((d._session.openedDocuments[i]||{}).testMatchSnapshotCalls||{})[t.line],r=function(t){if(!d._session)return t();d._session.requestSnapshot({file:i,line:n,type:"content"},function(e){return e&&e.name?t(d._createHover("```\nSnapshot name: `"+e.name+"` \n"+e.content+"\n```")):t()})};if(a||o)return new Promise(function(t){return d._session?a?void d._session.requestError({file:d._getDocumentFilePath(e),line:n,type:"errorSource"},function(e){return e&&e.error&&(e.error.expected||e.error.actual)?t(d._createHover(d._failingTestsOutput.createDiffMarkdown(e.error.expected,e.error.actual,e.error.snapshot,n))):o?r(t):t()}):r(t):t()})}})),u._disposables.add(S.languages.registerDefinitionProvider(T,{provideDefinition:function(e,t){var i=d._getDocumentFilePath(e),n=t.line+1;if(d._session&&((d._session.openedDocuments[i]||{}).testMatchSnapshotCalls||{})[t.line])return new Promise(function(a){if(!d._session)return a();d._session.requestSnapshot({file:i,line:n,type:"location"},function(e){if(!e||!e.name)return a();var t=parseInt(e.loc,10)-1;return 0<=t?a(new S.Location(S.Uri.file(d._absoluteFilePath(e.file)),new S.Position(t,0))):a()})})}})),u._disposables.add(S.languages.registerCodeLensProvider(T,{onDidChangeCodeLenses:u._onDidUpdateDocuments.event,provideCodeLenses:function(r){if(!d._codeLensEnabled)return[];var t=function(e,n){var o=[];if(e.testDeclarations)return k.each(e.testDeclarations,function(e,t){if(e)try{t=parseInt(t,10);var a=r.lineAt(t),i=new S.Range(a.lineNumber,a.firstNonWhitespaceCharacterIndex+2,a.lineNumber,a.range.end.character);B["wallaby.feature.debugger"].enabled&&o.push(new S.CodeLens(i,{title:e.debugged?"Stop debugger":"Debug",tooltip:e.debugged?"Stop debugger":"Debug",command:e.debugged?"wallaby.stopTraceNavigation":"wallaby.debugTest",arguments:[a.lineNumber+1]})),B["wallaby.feature.testStory"].enabled&&(e.debugged&&n||o.push(new S.CodeLens(i,{title:"View story",tooltip:"View story",command:"wallaby.showTestStoryBeside",arguments:[{line:a.lineNumber+1,force:!0},!0,!0]}))),!d._traceExplorer.traceBeingNavigated()&&B["wallaby.feature.testFilters"].enabled&&o.push(new S.CodeLens(i,{title:e.filtered?"Remove from filter":"Focus",tooltip:e.filtered?"Remove from filter":"Add to filter",command:"wallaby.toggleTestFilter",arguments:[a.lineNumber+1]})),!d._traceExplorer.traceBeingNavigated()&&e.snap&&o.push(new S.CodeLens(i,{title:1<e.snap?"Update snapshots":"Update snapshot",tooltip:1<e.snap?"Update snapshots":"Update snapshot",command:"wallaby.updateTestSnapshots",arguments:[a.lineNumber+1]}))}catch(e){}}),o};if(d._session){var e=d._getDocumentFilePath(r),a=d._session.openedDocuments[e];if(a){if(!a.errorTs&&(!a.changeTs||a.changeTs<a.updateTs))return t(a,d._anyVisibleTimelineEditors());if(a.changeTs>a.updateTs||a.errorTs<=a.updateTs&&a.createTs<a.updateTs)return new Promise(function(e){a.provideLenses=function(){e(t(a,d._anyVisibleTimelineEditors()))}})}}return[]}})),u._codeLensEnabled=S.workspace.getConfiguration().get("wallaby.codeLens",!0),u._disposables.add(S.workspace.onDidChangeConfiguration(function(e){d._codeLensEnabled=S.workspace.getConfiguration().get("wallaby.codeLens",!0)})),u._valueExplorer=new N(u._context,function(){return"https://wallabyjs.com/docs/intro/"+(u._traceExplorer.traceBeingNavigated()?"time-travel-debugger.html#inspecting-runtime-values":"value-explorer.html")}),u._traceExplorer=new j(u._context),u._testFileCoverageExplorer=new F(u._context),u._setContext("wallaby.inExperimentalMode",u._isInExperimentalMode()),u._wallabyAppPublicUrl="https://wallabyjs.com/app/",u._wallabyAppLocalUrl="http://localhost:51245/",u}return a(p,x),p.prototype._setFeatureContext=function(){var a,i=this;try{a=this._coreVersion.split(".").map(function(e){return parseInt(e,10)})}catch(e){a=[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER]}Object.keys(B).forEach(function(e){var t=B[e];try{t.enabled=!(a[0]<t.version[0]||a[1]<t.version[1]||a[2]<t.version[2])}catch(e){t.enabled=!0}i._setContext(e,t.enabled)})},p.prototype._createHover=function(e){return S.MarkdownString&&((e=new S.MarkdownString(e)).isTrusted=!0),new S.Hover(e)},p.prototype._isInExperimentalMode=function(){return S.workspace.getConfiguration().get("wallaby.experimental",!1)},p.prototype._setupVersionSpecificComponents=function(e){var t=e.major,a=e.minor;1<=t&&2<=a&&S.workspace.registerTextDocumentContentProvider&&(this._sideBySideDiffSupported=!0),1<=t&&3<=a&&(this._hideAfterContentDecorationType=L.createTextEditorDecorationType({isWholeLine:!0,after:{margin:"0 0 0 10000px"}})),1<=t&&5<=a&&(this._lineAndColumnLinks=!0),1<=t&&10<=a&&(p._escapeInlineMessage=function(e){return e}),1<=t&&11<=a&&(this._outputDocumentSelector.scheme="*"),1<=t&&16<=a&&(this._multiFolderWorkspaces=!0)},p.prototype._createCoverageDecorationType=function(e,t,a){return L.createTextEditorDecorationType({isWholeLine:!0,rangeBehavior:1,gutterIconPath:this._context.asAbsolutePath(C.join("images",e+".svg")).split("\\").join("/"),light:{after:{color:t}},dark:{after:{color:a}}})},p.prototype.activate=function(){var i=this,n=this;this._diagnosticEntries={},this._diagnosticCollection=S.languages.createDiagnosticCollection("wallaby"),this._originalOnceDocumentStopsChanging=this._onceDocumentStopsChanging,this._onceDocumentStopsChanging=k.debounce(k.bind(this._originalOnceDocumentStopsChanging,this),100),this._outputDebouncedTestResults=k.debounce(k.bind(this._outputTestResults,this),100),this._processOpenedEditors=k.debounce(k.bind(this._processOpenedEditors,this),100),n._statusBar.updateText=k.debounce(k.bind(n._statusBar.updateText,n._statusBar),200),this._executeCommand=k.bind(this._execute,this),this._packagePath=_.realpathSync(this._context.extensionPath),this._packageMetadata=o(C.join(this._packagePath,"package.json")),this._wallabyFolder=C.join(v.homedir(),".wallaby"),this._lkp=C.join(this._wallabyFolder,"key.lic"),this._ol=C.join(this._wallabyFolder,".ol");try{_.existsSync(this._wallabyFolder)||_.mkdirSync(this._wallabyFolder);var e=C.join(this._packagePath,"..",".wlck");if(!_.existsSync(this._lkp)&&_.existsSync(e)){var t=_.readFileSync(e).toString();_.writeFileSync(n._lkp,t),_.unlinkSync(e)}}catch(e){}n._commands=k.reduce(this._packageMetadata.contributes.commands,function(e,t){var a=R[t.command];return a&&a.visible&&(e[t.title]=t),e},{}),n._keyBindings=k.reduce(this._packageMetadata.contributes.keybindings,function(e,t){return e[t.command]=t,e},{}),n._firstInstall&&L.showInformationMessage("Start with displaying all wallaby.js commands using "+n._formatShortcut(n._keyBindings["wallaby.showCommandPalette"])+" shortcut."),this._statusBar.command="wallaby.statusBarCommand";var a=n._keyBindings["wallaby.showSideBySideDiff"];this._snapshotFailedInlineMessage="Use 'Show Side-by-Side Diff' command "+(a&&a.key?"["+n._formatShortcut(a)+"]":"")+" or line hover tip to see the snapshot error details.",this._setActiveProjectRootAndConfig(),this._disposables.add(function(){if(n.stop(!0),n._statusBar&&n._statusBar.hide(),i._activeLicenseSession)try{i._activeLicenseSession.stop(),i._activeLicenseSession=null}catch(e){}n._testsOutputChannel.dispose(),n._consoleOutputChannel.dispose(),k.each(n._coverageDecorationTypes,function(e){return e.dispose()}),n._uncoveredRegionDecorationType.dispose(),n._activeTraceFrameDecorationType.dispose(),n._activeTraceCallStackFrameDecorationType.dispose(),n._activeValueCallStackFrameDecorationType.dispose(),n._activeTraceFrameWithNowhereToGoDecorationType.dispose(),n._testTimelineContentProvider&&n._testTimelineContentProvider.dispose()}),this.on("stopped",function(){n._setContext("wallaby.started",!1),n._setContext("wallaby.reportedAtLeastOnceLogValue",!1),n._setContext("wallaby.testFilterToggled",!1),n._setContext("wallaby.uncoveredToggled",!1),n._testFilterToggled=!1,n._removeStatus()}),this.on("projectConfigured",function(e){k.isNumber(e.editDelay)&&(n._onceDocumentStopsChanging=k.debounce(k.bind(n._originalOnceDocumentStopsChanging,n),e.editDelay))}),this.on("busy",function(){clearTimeout(n._statusUpdateTimeout),n._statusUpdateTimeout=setTimeout(function(){return n._updateStatus("progress")},300)}),this.on("copyToClipboard",function(e){S.env.clipboard.writeText(e.data)}),this.on("notification",function(e){var t=[];if(~e.text.indexOf("extended-trial-license-link")&&t.push({title:"Request License",command:"_requestTrialLicense"}),!~e.text.indexOf("expire")||"warning"!==e.type||!i._suppressExpirationNotifications){~e.text.indexOf("activate-link")&&t.push({title:"Enter License",command:"wallaby.showLicense"}),~e.text.indexOf("continue-trial-link")&&t.push({title:"Continue Trial",command:"_continueTrial"}),~e.text.indexOf("purchase")&&t.push({title:"Purchase",command:"_openPurchasePage"}),~e.text.indexOf("PhantomJs docs")&&t.push({title:"View Documentation",command:"_openPhantomJsDocs"}),~e.text.indexOf("auto-config-info-link")&&t.push({title:"View Documentation",command:"_openAutoConfigDocs"}),e.text=e.text.replace(/<br\/><br\/>/g," ").replace(/<br\/>/g," ").replace(/<[^>]*>/g,"");var a=[e.text].concat(t);L["show"+e.type.charAt(0).toUpperCase()+e.type.substr(1)+("info"===e.type?"rmation":"")+"Message"].apply(L,a).then(n._executeCommand),0===e.text.indexOf("Can not start node.js process")&&L.showInformationMessage('You may use the "wallaby.node" setting to configure the location of node.')}}),this.on("stats",function(e){e&&(n._stats=e,k.isObject(e)&&i._traceExplorer.update(e.trace),delete i._lineTestsOutputIsActive,i._outputDebouncedTestResults(i._failingTestsOutput,e,!1),i._updateDiagnosticsCollection(e),i._runScheduledActionOnResultsAvailable()),n._updateStatus()}),this.on("activeTestFileCoverageChanged",function(e){i._testFileCoverageExplorer.update(e)}),this.on("filesToTrack",function(e,t){var a=i;k.reduce(t,function(e,t){return e[t]||(e[t]={changes:[],path:t}),e},e.filesToTrack),a._processOpenedEditors(e)}),this.on("live",function(e,t){e.wallabyAppPort=t.wallabyAppPort,n._setContext("wallaby.started",!0),n._observeDocuments(e)}),this.on("documentUpdates",function(e,t){n._updateDocuments(e,t),n._displayStatusForActiveEditor(e),n._screenshotProvider&&n._screenshotProvider.update(),n._isTimelineViewer(L.activeTextEditor)&&n._forEachVisibleTimelineEditor(function(e){return n._testTimelineContentProvider.updateTimelineEditorInlineValueDecorations(e,p._activeLine(),t)}),n._runScheduledActionOnResultsAvailable()}),this.on("fileMessages",function(e){n._setContext("wallaby.reportedAtLeastOnceLogValue",!0),i._valueExplorer.update(e)}),this.on("wallabyAppUrl",function(e){i._currentWallabyAppLocalUrl=e}),this._multiFolderWorkspaces&&y.onDidChangeWorkspaceFolders&&this._disposables.add(y.onDidChangeWorkspaceFolders(function(){var e=i._activeConfig;i._setActiveProjectRootAndConfig(i._activeConfig),e!==i._activeConfig&&i.stop(!0)})),this._projectRunningState()&&S.workspace.getConfiguration().get("wallaby.startAutomatically",!0)&&this.start()},p.prototype._projectRunningState=function(){return this._activeProjectRoot()&&this._context.workspaceState.get("wallaby:runningstate:"+p._hash(this._activeProjectRoot()))},p.prototype._setProjectRunningState=function(e){e?this._context.workspaceState.update("wallaby:runningstate:"+p._hash(this._activeProjectRoot()),1):this._context.workspaceState.update("wallaby:runningstate:"+p._hash(this._activeProjectRoot()),0)},p.prototype._configFile=function(e){this._setActiveProjectRootAndConfig(e)},p.prototype._findProject=function(t){if(t){if(this._multiFolderWorkspaces&&y.workspaceFolders){var e=k.find(y.workspaceFolders,function(e){return~t.indexOf(e.uri.fsPath+C.sep)});if(e)return e.uri.fsPath}else if(y.rootPath&&~t.indexOf(y.rootPath))return y.rootPath}else{if(!this._multiFolderWorkspaces||!y.workspaceFolders)return y.rootPath;var a=this._context.workspaceState.get("wallaby:activeProjectRoot");if(a&&k.find(y.workspaceFolders,function(e){return a===e.uri.fsPath}))return a;if(y.workspaceFolders.length)return y.workspaceFolders[0].uri.fsPath}},p.prototype._setActiveProjectRootAndConfig=function(e,t){!e||_.existsSync(e)||e.endsWith("auto.detect")||(e=void 0),this._activeProject=this._findProject(e)||void 0,e&&!this._activeProject&&(e=void 0,this._activeProject=this._findProject()),this._context.workspaceState.update("wallaby:activeProjectRoot",this._activeProject),this._activeProject?(e?this._activeConfig=e:(this._activeConfig=this._context.workspaceState.get("wallaby:configPath:"+p._hash(this._activeProjectRoot())),!this._activeConfig||_.existsSync(this._activeConfig)||this._activeConfig.endsWith("auto.detect")||delete this._activeConfig,!this._activeConfig&&t&&(this._activeConfig=this._configByConvention())),this._context.workspaceState.update("wallaby:configPath:"+p._hash(this._activeProject),this._activeConfig),this._activeConfigFolder=this._activeConfig?C.dirname(this._activeConfig):void 0):(this._activeConfig=void 0,this._activeConfigFolder=void 0)},p.prototype._activeProjectRoot=function(){return this._activeProject},p.prototype._configPath=function(){return this._activeConfig},p.prototype._configFolderPath=function(){return this._activeConfigFolder},p.prototype.deactivate=function(){this._disposed||(this._disposables.dispose(),this._disposed=!0)},p.prototype._forceDeactivate=function(){this._deactivator(),k.each(R,function(e,t){return S.commands.registerCommand(t,function(){return L.showWarningMessage("Wallaby.js trial session is over, please restart VS Code for a new trial session.")})})},p.prototype.selectConfigFile=function(){var o=this,r=this,s=r._tryGetUtils();if(s){var l=this._activeProjectRoot(),c=this._relativeConfigPath();l?y.findFiles("**/*wallaby*.*","**/node_modules/**",500).then(function(e){var t=[{label:"Automatic Configuration <project directory>",path:C.resolve(o._activeProjectRoot(),"auto.detect")},{label:"Automatic Configuration <custom directory>...",path:"selectDirectory"}],a=k.map(e,function(e){return{label:r._relativeNormalizedFilePath(s,e.fsPath,r._activeProjectRoot()),path:e.fsPath}}),i=u(t,a),n=l&&c?"Currently selected: "+C.join(C.basename(l),c):void 0;return L.showQuickPick(i,{placeHolder:n}).then(function(e){e&&("selectDirectory"===e.path?L.showOpenDialog({canSelectFolders:!0,defaultUri:S.Uri.file(y.rootPath),openLabel:"Select Folder"}).then(function(e){if(e&&e[0]){var t=r._relativeNormalizedFilePath(s,e[0].fsPath,r._activeProjectRoot());r._configFile(C.resolve(o._activeProjectRoot(),t,"auto.detect")),r.start()}}):(r._configFile(e.path),r.start()))})}):L.showWarningMessage("Please open some folder/project before selecting configuration.")}else r._showWallabyUpdatingWarning()},p.prototype.playTraceNextStep=function(e){void 0===e&&(e={}),this._requestTrace(e)},p.prototype.playTraceNextStepOver=function(){this._requestTrace({over:!0})},p.prototype.playTraceNextStepOut=function(){this._requestTrace({out:!0})},p.prototype.playTracePrevStep=function(){this._requestTrace({back:!0})},p.prototype.playTracePrevStepOver=function(){this._requestTrace({back:!0,over:!0})},p.prototype.playTracePrevStepOut=function(){this._requestTrace({back:!0,out:!0})},p.prototype.playTraceForwardToSelection=function(){this._playTraceToSelection()},p.prototype.playTraceBackwardToSelection=function(){this._playTraceToSelection({back:!0})},p.prototype.openCallStackFrame=function(e){var t=this,a=!e.noTrace;a?k.each(L.visibleTextEditors,function(e){return t._destroyStackTraceDecorations(e)}):(this._destroyAllValueCallStackDecorations(),clearTimeout(this._destroyAllValueCallStackDecorationsTimeout),this._destroyAllValueCallStackDecorationsTimeout=setTimeout(function(){return t._destroyAllValueCallStackDecorations()},2e3)),this._navigateWithTraceHighlight(e,a?this._activeTraceCallStackFrameDecorationType:this._activeValueCallStackFrameDecorationType,{requestTimelineIfStepIsOutOfSight:!0}),a&&this._traceExplorer.updateTraceContext(e)},p.prototype._destroyAllValueCallStackDecorations=function(){var t=this;k.each(L.visibleTextEditors,function(e){return t._destroyValueCallStackDecorations(e)})},p.prototype.revealTraceStep=function(e){e&&this._navigateWithTraceHighlight(e,this._activeTraceFrameDecorationType,{requestTimelineIfStepIsOutOfSight:!0})},p.prototype.stopTraceNavigation=function(){var t=this;this._traceExplorer.stopTraceNavigation(),this._closeTestTimeline(!0),k.each(L.visibleTextEditors,function(e){return t._destroyStackTraceDecorations(e)}),this._updateStatus()},p.prototype._openWallabyTools=function(){var t=this,a=L.activeTextEditor;!this._traceExplorer.traceBeingNavigated()||this._testTimelineContentProvider&&this._testTimelineContentProvider.isExpectingTimelineLoad()||(this._haveAlreadyOpenedWallabyTools=!0,S.commands.executeCommand("workbench.view.extension.wallaby"),setTimeout(function(){if(a&&a.document&&!t._isTimelineViewer(L.activeTextEditor)){var e=t._getDocumentFilePath(a.document);e&&t._session&&t._session.filesToTrack[e]&&L.showTextDocument(a.document,{preserveFocus:!1})}},400))},p.prototype._playTraceToSelection=function(e){void 0===e&&(e={});var t=L.activeTextEditor;if(t){if(e.line=p._activeLine(),e.file=this._getDocumentFilePath(t.document),this._isTimelineViewer(t)){var a=this._testTimelineContentProvider.getOriginalLocationByLine(e.line);if(!a)return;e.line=a.line,e.file=a.file,e.frame=a.step}this._requestTrace(e)}},p.prototype._requestTrace=function(e){var t=this;void 0===e&&(e={}),this._session&&this._traceExplorer.requestTrace(e).then(function(e){return t._processTraceNavigation(e,!1)})},p.prototype._processTraceNavigation=function(e,t){var a=this;return void 0===t&&(t=!0),e&&e.restart&&!this._haveAlreadyOpenedWallabyTools&&(t=!1,this._openWallabyTools()),k.each(L.visibleTextEditors,function(e){return a._destroyStackTraceDecorations(e)}),this._traceExplorer.traceNavigated(e),this._updateStatus(),!e&&this._traceExplorer.lastActiveStep()?this._navigateWithTraceHighlight(this._traceExplorer.lastActiveStep(),this._activeTraceFrameWithNowhereToGoDecorationType,{onlyHighlightRangeInVisibleEditors:t,requestTimelineIfStepIsOutOfSight:!0}):e?this._navigateWithTraceHighlight(e,this._activeTraceFrameDecorationType,{onlyHighlightRangeInVisibleEditors:t,requestTimelineIfStepIsOutOfSight:!0}):void 0},p.prototype._navigateWithTraceHighlight=function(s,l,e){var t=this,a=e.onlyHighlightRangeInVisibleEditors,i=void 0!==a&&a,n=e.reveal,o=void 0===n||n,r=e.requestTimelineIfStepIsOutOfSight,c=void 0!==r&&r,u=function(e,t){var a=s.range[0]!==s.range[2],i=0<=t?t:s.range[0]-1,n=e.document&&e.document.lineAt(i),o=s.range[1],r=!o&&n?n.firstNonWhitespaceCharacterIndex:o;a?e.setDecorations(l,[new S.Range(i,r,i,1e4)]):e.setDecorations(l,[new S.Range(i,r,i,s.range[3])])};if(this._anyVisibleTimelineEditors()&&!this._testTimelineContentProvider.unlocked()){var d=this._testTimelineContentProvider.getLineByStep(s.frame);0<=d?(o&&this._forEachVisibleTimelineEditor(function(e){var t=new S.Position(d,s.range[1]);e.revealRange(new S.Range(t,t),2),e.selection=new S.Selection(t,t)}),this._forEachVisibleTimelineEditor(function(e){return u(e,d)})):(this._forEachVisibleTimelineEditor(function(e){return t._destroyStackTraceDecorations(e)}),c&&this.showTestStory({before:s.frame},!0,this._testTimelineContentProvider.openedBeside(),!0)),this._isTimelineViewer(L.activeTextEditor)&&(i=!0,this._testTimelineContentProvider.openedBeside()&&this._navigate(s.file,s.loc,{focus:!1,select:!1,viewColumn:this._testTimelineContentProvider.viewColumnWhenOpened()-1}).then(u))}if(!i)return this._navigate(s.file,s.loc,{reveal:o}).then(u);k.filter(L.visibleTextEditors,function(e){return e&&e.document&&t._getDocumentFilePath(e.document)===s.file}).forEach(function(e){return u(e)})},p.prototype.openWallabyApp=function(){try{o("openurl").open(this._getWallabyAppUrl())}catch(e){}},p.prototype._getWallabyAppUrl=function(){return this._started?this._currentWallabyAppLocalUrl+(this._session&&this._session.wallabyAppPort?"?port="+this._session.wallabyAppPort:""):this._wallabyAppPublicUrl},p.prototype.showFailingTests=function(){if(this._stats){var e=this._lineTestsOutputIsActive;if(delete this._lineTestsOutputIsActive,this._testsOutputEditor){var t=this._testsOutputEditor.document;t&&1===t.lineCount&&(e=!0)}this._outputTestResults(this._failingTestsOutput,this._stats,e),this._failingTestsOutput.show()}},p.prototype.statusBarCommand=function(){this.showFailingTests(),this._traceExplorer.traceBeingNavigated()&&(S.commands.executeCommand("wallaby.revealTraceStep",this._traceExplorer.lastActiveStep()),S.commands.executeCommand("wallaby.traceExplorer.focus"))},p.prototype.showCommandPalette=function(){var n=this;L.showQuickPick(k.map(n._commands,function(e,t){var a={label:t},i=n._keyBindings[e.command];return i&&(a.description=n._formatShortcut(i)),a})).then(function(e){return e&&S.commands.executeCommand(n._commands[e.label].command)})},p.prototype._formatShortcut=function(e){var a=this;if(e){var t=a._isMac?e.mac:e.key;return k.map(t.split(" "),function(e){return k.map(e.split("+"),function(e){var t=e.charAt(0).toUpperCase()+e.slice(1);return a._isMac&&t.replace("Cmd","⌘").replace("Ctrl","⌃").replace("Alt","⌥").replace("Shift","⇧")||t}).join(a._isMac?"":"+")}).join(" ")}},p.prototype.showLastScreenshot=function(){this._session&&this._screenshotProvider&&this._screenshotProvider.display()},p.prototype.runLineTests=function(){this._runTests("line")},p.prototype.revealValue=function(){var e=L.activeTextEditor;if(e&&this._session){var t=this._getDocumentFilePath(e.document);t&&this._valueExplorer.reveal(t,p._activeLine())}},p.prototype.debugTest=function(e){this._traceExplorer.traceBeingNavigated()&&this._traceExplorer.stopTraceNavigation(),e&&e.showTimeline&&this._openTestTimelineOnTraceNavigationStarted({},!0),this._runTests("initialTraceRun",e)},p.prototype.showTestStoryBeside=function(e){this.showTestStory(e||{},!0,!0)},p.prototype.showTestStory=function(e,t,a,i){void 0===e&&(e={}),void 0===t&&(t=!0),this._session&&this._testTimelineContentProvider&&(this._testTimelineContentProvider.changeLock(!0,this._visibleTimelineEditors()),this._testTimelineContentProvider.showNewTimelineBeside(a),this._traceExplorer.traceBeingNavigated()&&!e.force?this._openTestTimeline(e,t,i):(this.debugTest(e.line),this._openTestTimelineOnTraceNavigationStarted(e,t)))},p.prototype.lockTestStory=function(){this._session&&this._testTimelineContentProvider&&(this._testTimelineContentProvider.changeLock(!0,this._visibleTimelineEditors()),this.showTestStory({},!0,this._testTimelineContentProvider.openedBeside()))},p.prototype.unlockTestStory=function(){var t=this;this._session&&this._testTimelineContentProvider&&(this._forEachVisibleTimelineEditor(function(e){return t._destroyStackTraceDecorations(e)}),this._testTimelineContentProvider.changeLock(!1,this._visibleTimelineEditors()))},p.prototype._openTestTimelineOnTraceNavigationStarted=function(e,t){var a=this,i=this._traceExplorer.onTraceNavigationStarted(function(){i.dispose(),a._openTestTimeline(e,t)})},p.prototype._openTestTimeline=function(e,a,i){var n=this;this._session&&this._testTimelineContentProvider&&!this._testTimelineContentProvider.isExpectingTimelineLoad()&&(this._testTimelineContentProvider.expectingTimelineLoad(),this._session.requestTestTimeline(e,function(t){return s(n,void 0,void 0,function(){return h(this,function(e){switch(e.label){case 0:return[4,this._testTimelineContentProvider.show(t,this._visibleTimelineEditors())];case 1:return e.sent(),this._highlightActiveTraceStepIfRequired(L.activeTextEditor,{reveal:a,onlyHighlightRangeInVisibleEditors:!!i}),[2]}})})}))},p.prototype.runFileTests=function(){this._runTests("file")},p.prototype.runProjectTests=function(){this._runTests("project")},p.prototype.updateTestSnapshots=function(e){this._runTests("line",e)},p.prototype.updateFileSnapshots=function(){this._runTests("file")},p.prototype.updateProjectSnapshots=function(){this._runTests("project")},p.prototype.jumpToFailingTest=function(){this._jumpTo("failingTest")},p.prototype.jumpToErrorSource=function(){this._jumpTo("errorSource")},p.prototype.searchTests=function(){this.jumpToTest()},p.prototype.jumpToTest=function(a){var i=this,e=new Promise(function(t){i._session&&i._session.requestTests({filter:a},function(e){t((e||[]).map(function(e){return{label:i._buildTestName(e.name,e.failing,e.status,!a),description:e.suite,detail:e.file,test:e}}))})});L.showQuickPick(e,{matchOnDescription:!0,matchOnDetail:!0}).then(function(e){e&&(e.test.status&&"executed"!==e.test.status?i._session.requestLocation({file:e.test.file,test:e.test.name,type:"unexecutedTest"},function(e){return i._navigate(e.file,e.loc)}):i._navigate(e.test.file,e.test.location))})},p.prototype.showSideBySideDiff=function(){if(this._session){var e=L.activeTextEditor,t=e&&this._getDocumentFilePath(e.document),a=p._activeLine();this._session.requestError({file:t,line:a,type:"failingTest"},function(e){var t;e&&e.error&&(e.error.expected||e.error.actual)&&(t=S.commands).executeCommand.apply(t,u(["vscode.diff"],O.diffCommandArguments(e.error.expected,e.error.actual)))})}},p.prototype.showLineTests=function(){var t=this;if(this._session){var e=L.activeTextEditor,a=e&&this._getDocumentFilePath(e.document),i=p._activeLine();a&&i&&this._session.openedDocuments[a]&&this._session.requestLineReport({file:a,line:i},function(e){t._lineTestsOutputIsActive=!0,t._lineTestsOutput.show(),t._outputTestResults(t._lineTestsOutput,e.report.tests&&e.report.tests.length?e.report:"Line is not covered or covered not by tests",!0)})}},p.prototype.showLineTestsFromMenu=function(){this.showLineTests()},p.prototype.showValue=function(){this._showValue("show",!0)},p.prototype.copyValue=function(){this._showValue("copy")},p.prototype.copyDiagnosticsReportToClipboard=function(){this._session&&this._session.copyDiagnosticsReportToClipboard({editorVersion:S.version,pluginVersion:this._packageMetadata.version})},p.prototype.runModeOnSave=function(){this._session.setRunMode("onsave")},p.prototype.runModeImmediate=function(){this._session.setRunMode("immediate")},p.prototype.runModeToggle=function(){this._session.setRunMode("toggle")},p.prototype.forceCoreUpdate=function(){this._state.forceCoreUpdate()},p.prototype.toggleTestFilter=function(e){if(this._session){var t=L.activeTextEditor;if(t){var a=t&&this._getDocumentFilePath(t.document);e=e||p._activeLine(),this._session.toggleTestFilter({file:a,line:e})}}},p.prototype.resetTestFilter=function(){this._session&&(this._setContext("wallaby.testFilterToggled",!1),this._session.toggleTestFilter({}))},p.prototype.resetUncovered=function(e){(e=e||L.activeTextEditor)&&(this._setContext("wallaby.uncoveredToggled",!1),e._wallabyUncoveredDisplayed&&this._destroyUncoveredDecorations(e))},p.prototype.startExclusively=function(e,t){this.addToExclusiveTestRun(e,t,!0)},p.prototype.startExclusivelyFromMenu=function(e){e&&this.addToExclusiveTestRun(e.fsPath,!0,!0)},p.prototype.addToExclusiveTestRun=function(e,t,a){var i=this._tryGetUtils();if(i){if(!e&&!t){var n=L.activeTextEditor;e=n&&n.document&&n.document.uri&&n.document.uri.fsPath}e&&(e=this._relativeNormalizedFilePath(i,e),!this._session||a?this.start(e):this._session.addTestLocations([e]))}else this._showWallabyUpdatingWarning()},p.prototype.addToExclusiveTestRunFromMenu=function(e){e&&this.addToExclusiveTestRun(e.fsPath,!0)},p.prototype._showValue=function(d,p){return s(this,void 0,void 0,function(){var t,a,i,n,o,r,s,l,c,u;return h(this,function(e){switch(e.label){case 0:return(t=L.activeTextEditor)&&((a=this._session)&&(i=t.selection)&&i.end)?(n=i.start.line+1,o=i.end.line+1,r=this._getDocumentFilePath(t.document),s=t.document,this._isTimelineViewer(t)?(l=this._testTimelineContentProvider.getOriginalLocationByLine(n))?(c=o-n,n=l.line,o=n+c,r=l.file,[4,y.openTextDocument(this._absoluteFilePath(r))]):[2]:[3,2]):[2];case 1:return(s=e.sent())?[3,3]:[2];case 2:if(!r||!this._session.openedDocuments[r])return[2];e.label=3;case 3:return u=s.getText(),a.evaluateExpressionInEditor(r,u,[n,i.start.character,o,i.end.character],d),p&&this._scheduleOnResultsAvailable(r,i.end,function(){return S.commands.executeCommand("editor.action.showHover")}),[2]}})})},p.prototype._scheduleOnResultsAvailable=function(e,t,a){this._runOnResultsAvailable={filePath:e,selectionEnd:t,action:a}},p.prototype._updateDiagnosticsCollection=function(e){var l=this;if(S.workspace.getConfiguration().get("wallaby.reportFailuresAsProblems",!0)){var c={};try{e&&e.errors&&e.errors.length&&e.errors.filter(function(e){return e&&e.snapshot}).forEach(function(e){if(e.stack&&e.stack.length){var t=e.stack[0],a=l._absoluteFilePath(t.file),i=t.loc.split(":"),n=i[0],o=i[1],r=new S.Position(parseInt(n,10)-1,parseInt(o,10)),s={code:"",message:e.message,range:new S.Range(r,r),severity:S.DiagnosticSeverity.Error,source:"Wallaby.js"};c[a]||(c[a]=[]),c[a].push(s)}}),e&&e.tests&&e.tests.forEach(function(e){if(e.file&&e.errors){var t=l._absoluteFilePath(e.file);c[t]||(c[t]=[]);var a=e.path.join(" "),i=e.declarationLoc.split(":"),n=i[0],o=i[1],r=new S.Position(parseInt(n,10)-1,parseInt(o,10)),s={code:"",message:a,range:new S.Range(r,r),severity:S.DiagnosticSeverity.Error,source:"Wallaby.js",relatedInformation:e.errors.map(function(e){if(e.stack&&!(0<!e.stack.length)&&e.stack[0].loc&&e.stack[0].file)try{var t=((e.stack[0].loc||"")+":0").split(":"),a=t[0],i=t[1],n=parseInt(a,10)-1,o=parseInt(i,10),r=S.Uri.file(l._absoluteFilePath(e.stack[0].file));if(n<1)return;return{message:e.message,location:new S.Location(r,new S.Position(n,o))}}catch(e){return}}).filter(function(e){return!!e})};c[t].push(s),c[t].sort(function(e,t){return e.range.start.line===t.range.start.line?e.range.start.character-t.range.start.character:e.range.start.line-t.range.start.line})}})}catch(e){console.error(e)}Object.keys(c).forEach(function(e){var t=l._diagnosticEntries[e],a=c[e];if(!t||a.length!==t.length||JSON.stringify(a)!==JSON.stringify(t)){var i=S.Uri.file(e);l._diagnosticCollection.set(i,a)}}),Object.keys(this._diagnosticEntries).forEach(function(e){if(!c[e]){var t=S.Uri.file(e);l._diagnosticCollection.set(t,void 0)}}),this._diagnosticEntries=c}},p.prototype._runScheduledActionOnResultsAvailable=function(){if(this._runOnResultsAvailable){var e=L.activeTextEditor;if(e)if(this._session){var t=e.selection;if(t&&t.end){var a=this._getDocumentFilePath(e.document);if(a&&this._session.openedDocuments[a]&&a===this._runOnResultsAvailable.filePath&&t.end===this._runOnResultsAvailable.selectionEnd)try{this._runOnResultsAvailable.action()}finally{delete this._runOnResultsAvailable}}}}},p.prototype.copyExpressionPath=function(e){e&&e.copyExpressionPath()},p.prototype.copyExpressionData=function(e){e&&e.copyExpressionData()},p.prototype.goToExpressionSource=function(e){e&&e.data()&&e.data().expressionLocation&&this._navigate(e.data().expressionLocation.file,e.data().expressionLocation.loc)},p.prototype.start=function(e){var t=this;if(this._currentWallabyAppLocalUrl=this._wallabyAppLocalUrl,this._activeProjectRoot()){var a=this;if(this.stop(!1),this._reloadCoreClient(),!this._state.coreClient)return this._startWhenUpdated=!0,void a._showWallabyStartAfterUpdateWarning();if(delete this._startWhenUpdated,this._configPath()||(this._setActiveProjectRootAndConfig(void 0,!0),this._configPath())){y.saveAll(!1),this._consoleOutputChannelUsed&&(this._consoleOutputChannel.clear(),this._consoleOutputChannel.append("‍"));var i="wallaby:autostart:notification";!this._context.globalState.get(i)&&S.workspace.getConfiguration().get("wallaby.startAutomatically",!0)&&(L.showWarningMessage("Please note: Wallaby.js is configured to start automatically if it was last running when your project was closed.","Update Setting to not Start Automatically").then(function(e){e&&S.workspace.getConfiguration().update("wallaby.startAutomatically",!1,!0)}),this._context.globalState.update(i,!0)),p._checkConfigurationSettings(),this._updateConfigurationFromSettings(),this._setProjectRunningState(!1);var n=this._session=new(this._tryGetSession());n.disposables=new D,n.filesToTrack=Object.create(null),n.openedDocuments=Object.create(null),n.projectCachePath=C.join(this._packagePath,"projects",p._hash(this._configPath())),n.start({localRoot:this._activeProjectRoot(),projectPath:n.projectCachePath,configPath:this._configPath(),testsPath:e,client:"VSCode",lkp:this._lkp}),n.on("started",function(e){a._started=!0,delete a._starting,a._appendLineToConsoleOutputChannel(O.markupText("message","[Info]")+" Started Wallaby.js Core v"+e.version),a._coreVersion=e.version,a._setFeatureContext(),a.emit("started",e)}),n.on("stopped",function(e){a.stop(!1),e.deactivate&&a._forceDeactivate()}),n.on("expiredLicense",function(){delete a._state.onFirstStart}),n.on("notification",function(e){return a.emit("notification",e)}),n.on("busy",function(){a._state.onFirstStart&&(a._state.onFirstStart(),delete a._state.onFirstStart),a._session&&a.emit("busy")}),n.on("copyToClipboard",function(e){return a.emit("copyToClipboard",e)}),n.on("stats",function(e){return a.emit("stats",e)}),n.on("activeTestFileCoverageChanged",function(e){return a.emit("activeTestFileCoverageChanged",e)}),n.on("fileMessages",function(e){return a.emit("fileMessages",e)}),n.on("projectConfigured",function(e){return a.emit("projectConfigured",e)}),n.on("filesToTrack",function(e){return a.emit("filesToTrack",n,e)}),n.on("live",function(e){return a.emit("live",n,e)}),n.on("documentUpdates",function(e){return a.emit("documentUpdates",n,e)}),n.on("navigationRequested",function(e){return a._navigate(e.file,e.loc)}),n.on("wallabyAppUrl",function(e){return a.emit("wallabyAppUrl",e.url)}),n.on("testFilterToggled",function(e){a._setContext("wallaby.testFilterToggled",e.enabled),a._testFilterToggled=e.enabled,a._stats&&(delete a._lineTestsOutputIsActive,a._outputDebouncedTestResults(t._failingTestsOutput,a._stats,!0)),a._updateStatus()}),n.on("traceNavigationReset",function(){return t.stopTraceNavigation()}),n.on("traceNavigated",function(e){return t._processTraceNavigation(e)}),n.on("traceTestSelectionRequested",function(e){return t._selectTestForDebugging(e)}),n.on("testFilterTestSelectionRequested",function(e){return t._selectTestForFiltering(e)}),n.on("testTimelineReset",function(){return t._closeTestTimeline()}),n.on("consoleError",function(e){return e&&k.each(e.split("\n"),function(e){return e&&a._appendLineToConsoleOutputChannel(""+O.markupText("error","[Error] "+e.replace(/\u0000/g,"")))})}),n.on("consoleLog",function(e){return e&&k.each(e.split("\n"),function(e){return e&&a._appendLineToConsoleOutputChannel(O.markupText("message","[Info]")+" "+e.replace(/\u0000/g,""))})}),this._starting=!0,this.emit("starting"),a._updateStatus("progress"),this._valueExplorer.reset(this,n),this._traceExplorer.reset(this,n),this._testFileCoverageExplorer.reset(),n.disposables.add(function(){delete t._runOnResultsAvailable,k.each(L.visibleTextEditors,function(t){k.each(a._coverageDecorationTypes,function(e){return t.setDecorations(e,[])}),a._hideAfterContentDecorationType&&t.setDecorations(a._hideAfterContentDecorationType,[]),a._destroyUncoveredDecorations(t),a._destroyStackTraceDecorations(t)})})}else p._notifyHowToSelectConfig(this)}else L.showWarningMessage("Please open some folder/project before starting wallaby.js.")},p.prototype._appendLineToConsoleOutputChannel=function(e){this._consoleOutputChannel.appendLine(e),this._consoleOutputChannelUsed=!0},p._checkConfigurationSettings=function(){try{var e=S.workspace.getConfiguration();e&&!e.get("editor.glyphMargin",!0)&&L.showWarningMessage("Wallaby.js will not display coverage indicators because the `editor.glyphMargin` setting is set to `false`.")}catch(e){}},p.prototype._selectTestForDebugging=function(e){var n=this,t=e.tests,a=e.originalRequest;L.showQuickPick(k.map(t,function(e){var t=e.testData,a=t.slice(1,t.length-1).join(" > "),i=t[t.length-1];return{label:i=n._buildTestName(i,e.failing),description:a,detail:e.file,test:t}}),{matchOnDescription:!0,matchOnDetail:!0}).then(function(e){return e&&n._session&&n._session.runTests(r({initialTraceRun:!0,tests:[e.test]},a))})},p.prototype._selectTestForFiltering=function(e){var n=this,t=e.tests,a=e.file;if(t&&t.length){var i=t.map(function(e){var t=e.path,a=t.slice(1,t.length-1).join(" > "),i=t[t.length-1];return{label:i=n._buildTestName(i,e.failing),description:e.toggled?"$(filter) "+a:a,detail:e.file,test:t}});L.showQuickPick(i,{matchOnDescription:!0,matchOnDetail:!0}).then(function(e){return e&&n._session&&n._session.toggleTestFilter({file:a,test:e.test})})}},p.prototype._updateConfigurationFromSettings=function(){try{var e=S.workspace.getConfiguration();if(e){this._suppressExpirationNotifications=e.get("wallaby.suppressExpirationNotifications",!1),this._failingTestsOutput&&this._failingTestsOutput.setContentLimit(e.get("wallaby.outputContentSize",0));var t=e.get("wallaby.node",""),a=e.get("wallaby.useWsl",!1);t&&(process.env.WALLABY_NODE=t),process.env.WALLABY_USE_WSL=a}}catch(e){}},p.prototype.stop=function(e){this._statusUpdateTimeout&&clearTimeout(this._statusUpdateTimeout),this._diagnosticCollection.clear(),e||this._setProjectRunningState(!1);var t=this._session;delete this._started,delete this._starting,delete this._session,delete this._stats,t&&(t.disposables&&t.disposables.dispose(),t.stop(),delete t.filesToTrack,delete t.openedDocuments,delete t.disposables,this.emit("stopped"),this._appendLineToConsoleOutputChannel(O.markupText("message","[Info]")+" Wallaby.js stopped"),this._outputTestResults(this._lineTestsOutput,"",!0),this._valueExplorer.reset(),this._traceExplorer.reset(),this._testFileCoverageExplorer.reset(),this._failingTestsOutput.reset(),this._testsOutputEditor=null),this._onDidUpdateDocuments.fire()},p.prototype._readyForUse=function(){this._started||(this._coreVersion=this._state.coreVersion,this._setFeatureContext()),this._startWhenUpdated&&this.start()},p.prototype._updateAvailable=function(e){var t=this;this._started?e&&L.showInformationMessage("Wallaby has been updated. To use the updated version, you must restart Wallaby.",{title:"Restart Now",command:"now"},{title:"Restart Later",command:"later"}).then(function(e){e&&"now"===e.command&&t.start()}):this._readyForUse()},p.prototype.openFile=function(t){var a=this;if(t&&t.path){var e=this._absoluteFilePath(t.path);e&&L.showTextDocument(S.Uri.file(e)).then(function(e){return t.showCoverage&&a._showUncovered(e,void 0,!0)})}},p.prototype.toggleUncovered=function(){var e=L.activeTextEditor;if(e){var t=!!e._wallabyUncoveredDisplayed;this._destroyUncoveredDecorations(e),this._setContext("wallaby.uncoveredToggled",!1),t||this._showUncovered(e)}},p.prototype._destroyUncoveredDecorations=function(e){e&&(e.setDecorations(this._uncoveredRegionDecorationType,[]),delete e._wallabyUncoveredDisplayed)},p.prototype._destroyStackTraceDecorations=function(e){if(e)try{e.setDecorations(this._activeTraceFrameDecorationType,[]),e.setDecorations(this._activeTraceCallStackFrameDecorationType,[]),e.setDecorations(this._activeTraceFrameWithNowhereToGoDecorationType,[])}catch(e){}},p.prototype._destroyValueCallStackDecorations=function(e){if(e)try{e.setDecorations(this._activeValueCallStackFrameDecorationType,[])}catch(e){}},p.prototype.showLicense=function(){var h=this,g=this,f=g._tryGetUtils();if(f){var y="";try{y=JSON.parse(new Buffer(_.readFileSync(this._ol).toString(),"base64").toString())}catch(e){y={}}var m="";try{m=_.readFileSync(g._lkp).toString()}catch(e){}L.showInputBox({value:y.wallabyEmail&&y.wallabyEmail.length?y.wallabyEmail:100<m.length?m:"",prompt:"Enter your wallaby.js license key",ignoreFocusOut:!0}).then(function(e){if(!k.isUndefined(e))if(/^[a-zA-Z0-9_+&*-]+(?:\.[a-zA-Z0-9_+&*-]+)*@(?:[a-zA-Z0-9-]+\.)+[a-zA-Z]{2,63}$/.test(e))try{if(y.wallabyEmail=e.trim(),y.lastUpdate=(new Date).getTime(),_.writeFileSync(h._ol,new Buffer(JSON.stringify(y)).toString("base64")),h._activeLicenseSession&&(h._activeLicenseSession.stop(),h._activeLicenseSession=null),h._reloadCoreClient(),!h._state.coreClient)return;var t=new(h._tryGetSession());t.stop=function(){t===h._activeLicenseSession&&(h._activeLicenseSession=null)},t.start({localRoot:g._lkp,projectPath:g._lkp,configPath:g._lkp,client:"VSCode",lkp:h._lkp,ol:!0}),t.on("notification",function(e){return g.emit("notification",e)}),h._activeLicenseSession=t}catch(e){L.showErrorMessage("Unable to save email activation request: "+e.message)}else{try{_.unlinkSync(h._ol)}catch(e){}var a=m,i=e||"",n=!!g._parseLicenseKey(f,a),o=g._parseLicenseKey(f,i),r=!!o,s=!1;if(r||!i&&n)try{if(_.writeFileSync(g._lkp,i),o.isBundle){var l=C.join(v.homedir(),".quokka"),c=C.join(l,".qlc");_.existsSync(l)||_.mkdirSync(l),_.writeFileSync(c,i);var u=C.join(l,"config.json"),d={};try{var p=_.readFileSync(u).toString();d=JSON.parse(p)}catch(e){}d.pro=!0,_.writeFileSync(u,JSON.stringify(d)),S.commands.executeCommand("quokka.switchToPro").catch(function(e){})}s=r}catch(e){L.showErrorMessage("Unable to save license key: "+e.message),s=!1}else L.showWarningMessage("The entered license key is not a valid wallaby.js license key");s&&(L.showInformationMessage("Wallaby.js is licensed to: "+o.licensee+". Free upgrades until: "+o.expiration),g._state.licenseChanged({wasRunning:g._started||g._starting,hasEverStartedOnOpenedProject:0<=g._projectRunningState(),newKey:o,start:function(){return g.start()},stop:function(){(g._started||g._starting)&&(g.stop(!0),g._showWallabyStartAfterUpdateWarning())}}))}})}else g._showWallabyUpdatingWarning()},p.prototype._showWallabyStartAfterUpdateWarning=function(){L.showWarningMessage("Wallaby.js is updating and will be started automatically when the update is complete.","Dismiss")},p.prototype._showWallabyUpdatingWarning=function(){L.showWarningMessage("Wallaby.js is updating, you will be notified when the update is complete.","Dismiss")},p.prototype._parseLicenseKey=function(e,t){if(k.isString(t))try{var a=e.parseKey(t);if(a.licenseeName&&a.expirationDateString&&(~a.licensedProduct.indexOf("(Freedom)")||~a.licensedProduct.indexOf("(VS Code)")))return{licensee:a.licenseeName,freeLicense:a.freeLicense,isBundle:0===a.licensedProduct.indexOf("Wallaby.js + Quokka.js"),expiration:a.expirationDateStringFormatted||a.expirationDateString}}catch(e){return}},p.prototype._showUncovered=function(t,e,a){var i=this;if(this._session){var n=t&&this._getDocumentFilePath(t.document);n&&(a||this._session.openedDocuments[n])&&(a&&(t._wallabySuppressUncoveredReset=!0),this._setContext("wallaby.uncoveredToggled",!0),this._session.requestUncoveredRegions({file:n,line:e},function(e){return i._highlightUncovered(t,e.ranges)}))}},p.prototype._highlightUncovered=function(e,t){e._wallabyUncoveredDisplayed=!0,e.setDecorations(this._uncoveredRegionDecorationType,k.map(t,function(e){return new S.Range(e[0]-1,e[1],e[2]-1,e[3])}))},p.prototype._jumpTo=function(e){var t=this;if(this._session){var a=L.activeTextEditor,i=a&&this._getDocumentFilePath(a.document),n=p._activeLine();this._session.requestLocation({file:i,line:n,type:e},function(e){return t._navigate(e.file,e.loc)})}},p.prototype._runTests=function(e,t){if(this._session){var a,i;if(t&&(a=k.isNumber(t)?t:(i=t.file,t.loc&&parseInt((t.loc+"").split(":")[0],10))),!i){var n=L.activeTextEditor;i=n&&this._getDocumentFilePath(n.document)}a||(a=("line"===e||"initialTraceRun"===e)&&p._activeLine()),this._session.runTests({file:"project"!==e&&i,line:a,initialTraceRun:"initialTraceRun"===e,evaluateExpression:"valueLine"===e})}},p._activeLine=function(){var e=L.activeTextEditor;return e&&e.selection&&e.selection.active&&e.selection.active.line+1},p._notifyHowToSelectConfig=function(e){return L.showWarningMessage("Please select wallaby.js configuration file.",{title:"Select Wallaby.js Config File",command:function(){return e.selectConfigFile()}}).then(e._executeCommand)},p.prototype._execute=function(e){if(e&&e.command)return"function"==typeof e.command?e.command(e):~e.command.indexOf("wallaby.")?S.commands.executeCommand(e.command):this[e.command]()},p.prototype._getDocumentFilePath=function(e){var t=this._tryGetUtils();if(t)return e.uri&&e.uri.fsPath&&this._relativeNormalizedFilePath(t,e.uri.fsPath)},p.prototype._observeDocuments=function(i){var n=this,o=this;if(!i.isDisposed()){var r={};L.visibleTextEditors.forEach(function(e){if(e&&e.document&&e.document.isDirty&&!r[e.document.fileName]&&(r[e.document.fileName]=!0,!e.document.uri||!e.document.uri.scheme||"file"===e.document.uri.scheme)){var t=n._getDocumentFilePath(e.document);if(t){var a=e.document.getText();i.fileChangedInEditor(t,a,void 0)}}}),o._setOutputLanguage(L.visibleTextEditors);var s=!1;(o._testsOutputDocumentFileName||o._consoleOutputDocumentFileName)&&(o._ignoreLaggyOutputHack||(s=!o._testsOutputDocumentFileName&&o._consoleOutputDocumentFileName?o._consoleOutputDocumentFileName:!!o._testsOutputDocumentFileName)),o._testsOutputEditor&&o._revealFirstLineInTestOutputEditor(),i.disposables.add(L.onDidChangeVisibleTextEditors(function(e){o._setOutputLanguage(e),o._testsOutputEditor&&o._revealFirstLineInTestOutputEditor(),n._testTimelineContentProvider&&n._testTimelineContentProvider.uri()&&!n._anyVisibleTimelineEditors(e)&&n._testTimelineContentProvider.resetOpenedBesideMode()})),i.disposables.add(y.onDidChangeTextDocument(function(e){var t=e.document;if(t&&t.uri&&"output"===t.uri.scheme){if("Log"!==t.languageId||o._testsOutputDocumentFileName||o._consoleOutputDocumentFileName||(o._setOutputLanguage(L.visibleTextEditors),s||(s=!o._testsOutputDocumentFileName&&o._consoleOutputDocumentFileName?o._consoleOutputDocumentFileName:!!o._testsOutputDocumentFileName)),!o._ignoreLaggyOutputHack&&s&&t.languageId===A){var a=o._testsOutputChannel;s===o._consoleOutputDocumentFileName&&(a=o._consoleOutputChannel),s=!1,o._ignoreLaggyOutputHack=!0,a.hide(),a.show(!0)}o._testsOutputEditor&&o._testsOutputEditor.document===t&&o._revealFirstLineInTestOutputEditor()}})),i.disposables.add(y.onDidChangeTextDocument(function(e){return o._processDocumentContentChange(i,e.document,e.contentChanges)})),this._processOpenedEditors(i),i.disposables.add(L.onDidChangeActiveTextEditor(function(e){e&&(i.activeEditor===e&&(i.filesWithSameEditorReActivated||(i.filesWithSameEditorReActivated=Object.create(null)),i.filesWithSameEditorReActivated[o._getDocumentFilePath(e.document)]=!0),i.activeEditor=e,o._testTimelineContentProvider&&!o._testTimelineContentProvider.isClosing()&&(o._updateTimelineEditorIfRequired(e),o._highlightActiveTraceStepIfRequired(e,{reveal:!n._isTimelineViewer(e)}))),o._setContext("wallaby.uncoveredDisplayed",!1),o._processOpenedEditors(i),o._displayStatusForActiveEditor(i)})),i.disposables.add(L.onDidChangeVisibleTextEditors(function(){return o._processOpenedEditors(i)})),i.disposables.add(function(){delete i.activeEditor,n._closeTestTimeline(!0)}),i.disposables.add(L.onDidChangeTextEditorSelection(function(e){return o._handleEditorSelectionChange(i,e)}))}},p.prototype._updateTimelineEditorIfRequired=function(e){if(this._isTimelineViewer(e))if(this._testTimelineContentProvider.isTimelineLoaded())this._testTimelineContentProvider.update(e);else if(this._traceExplorer.traceBeingNavigated()){var t=this._traceExplorer.lastActiveStep();this.showTestStory({before:t&&t.frame},!0,this._testTimelineContentProvider.openedBeside())}},p.prototype._isTimelineViewer=function(e){if(this._testTimelineContentProvider)return e&&e.document&&e.document.uri&&"wallaby-test-timeline"===e.document.uri.scheme},p.prototype._forEachVisibleTimelineEditor=function(e){var t=this;return L.visibleTextEditors.filter(function(e){return t._isTimelineViewer(e)}).forEach(e)},p.prototype._visibleTimelineEditors=function(){var t=this;return L.visibleTextEditors.filter(function(e){return t._isTimelineViewer(e)})},p.prototype._anyVisibleTimelineEditors=function(e){var t=this;return!!(e||L.visibleTextEditors).find(function(e){return t._isTimelineViewer(e)})},p.prototype._closeTestTimeline=function(a){return s(this,void 0,void 0,function(){var t;return h(this,function(e){switch(e.label){case 0:if(!this._testTimelineContentProvider)return[3,8];if(t=this._testTimelineContentProvider.uri(),this._testTimelineContentProvider.clear(this._visibleTimelineEditors()),!t||this._testTimelineContentProvider.isClosing())return[3,8];e.label=1;case 1:return e.trys.push([1,6,7,8]),this._testTimelineContentProvider.closing(),a?[4,L.showTextDocument(t,{preserveFocus:!1})]:[3,5];case 2:return e.sent(),[4,new Promise(function(e){return setTimeout(function(){return e()},100)})];case 3:return e.sent(),this._isTimelineViewer(L.activeTextEditor)?[4,S.commands.executeCommand("workbench.action.closeActiveEditor")]:[3,5];case 4:e.sent(),e.label=5;case 5:return[3,8];case 6:return e.sent(),[3,8];case 7:return this._testTimelineContentProvider.closed(),[7];case 8:return[2]}})})},p.prototype._highlightActiveTraceStepIfRequired=function(e,t){var a=t.reveal,i=void 0!==a&&a,n=t.onlyHighlightRangeInVisibleEditors,o=void 0===n||n;if(e&&this._traceExplorer.traceBeingNavigated()){var r=this._traceExplorer.lastActiveStep();if(r&&e.document)(this._getDocumentFilePath(e.document)===r.file||this._anyVisibleTimelineEditors())&&this._navigateWithTraceHighlight(r,this._activeTraceFrameDecorationType,{onlyHighlightRangeInVisibleEditors:o,reveal:i})}},p.prototype._handleEditorSelectionChange=function(e,t){if(t&&t.selections&&t.selections.length){var a=t.selections[0];this._traceExplorer.traceBeingNavigated()&&a.start.line===a.end.line&&a.start.character!==a.end.character&&this._showValue("show")}},p.prototype._displayStatusForActiveEditor=function(e){var t=this;if(e.isDisposed())return t._updateStatusExtension();var a=L.activeTextEditor;if(!a)return t._updateStatusExtension();var i=t._getDocumentFilePath(a.document);if(i){var n=e.openedDocuments[i];if(!n)return t._updateStatusExtension();n.coverage&&t._updateStatusExtension(n.coverage)}},p.prototype._processOpenedEditors=function(l){var n=this;if(!l.isDisposed()){var o=k.reduce(L.visibleTextEditors,function(e,t){if(t){var a=n._getDocumentFilePath(t.document);if(a&&l.filesToTrack[a]){var i=e[a];i||(i=e[a]=Object.create(null)),i[t._id||t.id]=!0}}return e},{});k.each(o,function(e,t){var a=k.keys(e).length,i=l.openedDocuments[t],n=a;if(i?0!==(n=a-i.editorCount)&&(i.editorCount=a):i=l.openedDocuments[t]={changes:[],path:t,editorCount:n},0!==n)for(var o=0<n?function(){return l.fileOpenedInEditor(t)}:function(){return l.fileClosedInEditor(t)},r=0,s=Math.abs(n);r<s;r++)o();else(!k.isEqual(i.editors,e)||l.filesWithSameEditorReActivated&&l.filesWithSameEditorReActivated[t])&&(l.fileClosedInEditor(t),l.fileOpenedInEditor(t));i.editors=e}),k.each(l.openedDocuments,function(e,t){if(!o[t]){for(var a=0,i=e.editorCount;a<i;a++)l.fileClosedInEditor(t);delete l.openedDocuments[t]}}),delete l.filesWithSameEditorReActivated}},p.prototype._processDocumentContentChange=function(e,t,a){if(!(e.isDisposed()||t&&t.uri&&t.uri.scheme&&"file"!==t.uri.scheme)){var i=this._getDocumentFilePath(t),n=e.openedDocuments[i];n&&(n.changeTs=c++,n.changes=n.changes.concat(a),this._hideMessagesForChangedRanges(n.changes),this._onceDocumentStopsChanging(e,n,t))}},p.prototype._onceDocumentStopsChanging=function(e,t,a){!e.isDisposed()&&t.changes.length&&(e.fileChangedInEditor(t.path,a.getText(),{start:k.chain(t.changes).map(function(e){return e.range.start.line}).min().value()+1,end:k.chain(t.changes).map(function(e){return e.range.end.line}).max().value()+1}),t.changes=[],this._destroyUncoveredDecorations(L.activeTextEditor))},p.prototype._updateStatus=function(e){var t=this;if(clearTimeout(this._statusUpdateTimeout),e||(e=k.isString(this._stats)?"failure":this._stats?this._stats.errors.length?"failure":"success":void 0),e){if("progress"===e)this._statusBar.displayProgress();else{this._statusBar.stopProgress();var a=t._traceExplorer.traceBeingNavigated()?"$(bug)   ":t._testFilterToggled?"$(filter)   ":"";if("failure"===e)t._statusBar.setMainText(a+"✗                ");else{var i=this._stats.totalNumber,n=this._stats.failingNumber,o=i-n-(this._stats.skippedNumber||0)-(this._stats.todoNumber||0);t._statusBar.setMainText(a+"✗ "+k.pad(n||0,3," ","right")+" ✔ "+k.pad(o||0,5," ","right"))}this._stats&&this._stats.totalNumber&&this._setProjectRunningState(!0),t._statusBar.updateText()}this._statusBar.show()}},p.prototype._updateStatusExtension=function(e){this._statusBar.setExtensionText(e||void 0),this._statusBar.updateText()},p.prototype._continueTrial=function(){this._session&&this._session.continueTrial()},p.prototype._openPurchasePage=function(){try{o("openurl").open("https://wallabyjs.com/purchase")}catch(e){}},p.prototype._openPhantomJsDocs=function(){try{o("openurl").open("https://wallabyjs.com/docs/integration/phantomjs2.html")}catch(e){}},p.prototype._openAutoConfigDocs=function(){try{o("openurl").open("https://wallabyjs.com/docs/intro/config.html")}catch(e){}},p.prototype._requestTrialLicense=function(){S.window.showInputBox({prompt:"Wallaby.js: email address for trial license",ignoreFocusOut:!0,placeHolder:"user@domain.com"}).then(function(e){if(void 0!==e){var t=o("https"),a=JSON.stringify({email:e,type:"wallaby"}),i={hostname:"x55r2pae4l.execute-api.us-east-1.amazonaws.com",port:443,path:"/Prod/bc88894221b34ae4adac5c39a51547a2",method:"POST",headers:{"Content-Type":"application/json","Content-Length":Buffer.byteLength(a)}},n=t.request(i,function(e){200===e.statusCode?S.window.showInformationMessage("Your Wallaby.js trial license request has been processed. Please check your email."):S.window.showErrorMessage("Something went wrong processing your Wallaby.js trial license request. Please send us an email instead to hello@wallabyjs.com")});n.on("error",function(e){S.window.showErrorMessage("Something went wrong processing your Wallaby.js trial license request. Please send us an email instead to hello@wallabyjs.com"),console.error(e)}),n.write(a),n.end()}})},p.prototype._removeStatus=function(){this._statusBar.hide()},p.prototype._updateDocuments=function(i,n){var o=this;if(!i.isDisposed()){var d=this,r=c++,s=n.hasGlobalError||n.hasRunError?r:void 0;k.each(L.visibleTextEditors,function(a){var l=a.document,e=d._getDocumentFilePath(a.document),c=i.openedDocuments[e]||{};delete c.coverage;var t=n[e];if(t&&(a._wallabySuppressUncoveredReset?delete a._wallabySuppressUncoveredReset:o.resetUncovered(a),t.lines)){c.createTs=c.createTs?c.createTs:r,c.updateTs=r,c.errorTs=s?c.errorTs?c.errorTs:s:void 0,c.messages=Object.create(null),c.errors=Object.create(null),c.testDeclarations=Object.create(null),c.testMatchSnapshotCalls=Object.create(null),t.coverage&&k.isNumber(t.coverage.value)&&(c.coverage=t.coverage.value+"%");var u={};k.each(d._coverageDecorationTypes,function(e,t){u[t]=[]}),k.each(t.lines,function(e){var t=e.num-1;if(!(t<0||t>=l.lineCount)){var a=l.lineAt(t);if(a){var i,n={range:new S.Range(a.lineNumber,a.firstNonWhitespaceCharacterIndex,a.lineNumber,a.range.end.character)},o=e.err&&e.snap?d._snapshotFailedInlineMessage:e.err||e.log,r=e.longLog||e.err||e.log;r&&(n.hoverMessage=S.MarkdownString?new S.MarkdownString("```\n"+r+"\n```"):r);var s=e.meta||{};i=e.decl?(c.testDeclarations[a.lineNumber]={filtered:s.filtered,snap:s.snap,debugged:s.debugged},4!=e.state||e.err?e.state:0):e.state,s.system&&(i+=6),e.snap&&(i+=20),u[i].push(n),e.snap&&(c.testMatchSnapshotCalls[a.lineNumber]=!0),o&&(e.log&&(c.messages[a.lineNumber]=!0),e.err&&(c.errors[a.lineNumber]={snap:e.snap,diff:s.error&&s.error.diff,source:s.error&&s.error.source}),d._hideAfterContentDecorationType&&(n.renderOptions={after:{contentText:"  "+p._escapeInlineMessage(o)}}))}}}),k.each(u,function(e,t){return a.setDecorations(d._coverageDecorationTypes[t],e)}),d._scheduleHiddenMessagesDisplay(),!c.errorTs&&c.provideLenses&&(!c.changeTs||c.changeTs<c.updateTs)&&c.provideLenses()}}),this._onDidUpdateDocuments.fire()}},p._escapeInlineMessage=function(e){return p._cssEscape(e).replace(/'/g,'"')},p.prototype._hideMessagesForChangedRanges=function(e){this._hideAfterContentDecorationType&&(clearTimeout(this._displayHiddenMessagesTimeout),this._messagesHiddenAt=+new Date,L.activeTextEditor&&L.activeTextEditor.setDecorations(this._hideAfterContentDecorationType,e.map(function(e){return{range:new S.Range(e.range.start.line,0,e.range.end.line,Number.MAX_SAFE_INTEGER)}})))},p.prototype._scheduleHiddenMessagesDisplay=function(){if(this._hideAfterContentDecorationType){var t=this;clearTimeout(this._displayHiddenMessagesTimeout);var e=this._messagesHiddenAt?+new Date-this._messagesHiddenAt:400;this._displayHiddenMessagesTimeout=setTimeout(function(){try{k.each(L.visibleTextEditors,function(e){return e.setDecorations(t._hideAfterContentDecorationType,[])})}catch(e){}},Math.max(0,500-e))}},p.prototype.navigate=function(e){return this._navigate(e.file,e.loc)},p.prototype._navigate=function(t,e,a){var i=this,n=void 0===a?{reveal:!0,focus:!0,select:!0}:a,o=n.reveal,r=void 0===o||o,s=n.focus,l=void 0===s||s,c=n.select,u=void 0===c||c,d=n.viewColumn,p=void 0===d?void 0:d;if(t){var h,g,f=this._absoluteFilePath(t);return k.isNumber(e)?h=e:k.isArray(e)?(h=e[0],g=e[1]):k.isString(e)&&(e=e.split(":"),h=e[0]&&parseInt(e[0],10),g=e[1]&&parseInt(e[1],10)),k.isNumber(h)?h-=1:h=0,k.isNumber(g)||(g=0),p=p||(k.find(L.visibleTextEditors,function(e){return e&&e.document&&i._getDocumentFilePath(e.document)===t})||{}).viewColumn,y.openTextDocument(f).then(function(e){return L.showTextDocument(e,p,!l)}).then(function(e){if(!r)return e;if(!g){var t=e.document&&e.document.lineAt(h);t&&(g=t.firstNonWhitespaceCharacterIndex)}var a=new S.Position(h,g);return e.revealRange(new S.Range(a,a),2),u&&(e.selection=new S.Selection(a,a)),e})}},p.prototype._relativeConfigPath=function(){return this._configPath()&&C.relative(this._activeProjectRoot(),this._configPath())},p.prototype._absoluteFilePath=function(e){return this._configFolderPath()&&C.resolve(this._configFolderPath(),e)},p.prototype._relativeNormalizedFilePath=function(e,t,a){return(a||this._configFolderPath())&&e.normalizePath(C.relative(a||this._configFolderPath(),t))},p.prototype._configByConvention=function(){var t=this;if(this._activeProjectRoot())return[{path:C.join(this._activeProjectRoot(),"node_modules","@jest","core","package.json"),majorVersion:24,minorVersion:0,revisionVersion:0},{path:C.join(this._activeProjectRoot(),"node_modules","@angular","cli","package.json"),majorVersion:8,minorVersion:2,revisionVersion:0}].find(function(e){if(_.existsSync(e.path))try{var t=JSON.parse(_.readFileSync(e.path).toString()).version.split("."),a=t[0],i=t[1],n=t[2],o=parseInt(a),r=parseInt(i),s=parseInt(n);if(o>e.majorVersion)return!0;if(o===e.majorVersion&&r>e.minorVersion)return!0;if(o===e.majorVersion&&r===e.minorVersion&&s>e.revisionVersion)return!0}catch(e){}return!1})?(L.showInformationMessage("Wallaby has set your project to use 'automatic configuration'. If you want to use a configuration file or have a mono-repo and only want to run for one project, you may select a different configuration.",{title:"Select Different Configuration",command:"selectConfigFile"},{title:"View Documentation",command:"_openAutoConfigDocs"}).then(t._executeCommand),C.join(t._activeProjectRoot(),"auto.detect")):k.chain(["wallaby.js","wallaby.conf.js",".wallaby.js",".wallaby.conf.js","wallaby.json",".wallaby.json"]).map(function(e){return C.join(t._activeProjectRoot(),e)}).find(function(e){return _.existsSync(e)}).value()},p.prototype._setContext=function(e,t){S.commands.executeCommand("setContext",e,t)},p.prototype._buildTestName=function(e,t,a,i){if(a&&"executed"!=a){var n="";if(i&&(n="todo"===a?"todo ":"skipped"===a?"skipped ":""),"todo"===a)return"$(clock)  "+n+e;if("skipped"===a)return"$(dialog-warning)  "+n+e}return t?"$(chrome-close)  "+e:"$(check)  "+e},p.prototype._setOutputLanguage=function(e){for(var t,a=0,i=e;a<i.length;a++){var n=i[a],o=n.document;if(o&&o.uri&&"output"===o.uri.scheme){if(this._testsOutputDocumentFileName){if(o.fileName===this._testsOutputDocumentFileName){t=n,o.languageId!==A&&S.languages.setTextDocumentLanguage(o,A);break}}else if(this._doesStartWithOutputPrefix(o,"‌")){this._testsOutputDocumentFileName=o.fileName,t=n,S.languages.setTextDocumentLanguage(o,A);break}if(this._consoleOutputDocumentFileName){if(o.fileName===this._consoleOutputDocumentFileName&&o.languageId!==A){S.languages.setTextDocumentLanguage(o,A);break}}else if(this._doesStartWithOutputPrefix(o,"‍")){this._consoleOutputDocumentFileName=o.fileName,S.languages.setTextDocumentLanguage(o,A);break}}}this._testsOutputEditor=t},p.prototype._doesStartWithOutputPrefix=function(e,t){if(0<e.lineCount){var a=e.lineAt(0);if(a.text&&a.text.length&&~a.text.indexOf(t))return!0}return!1},p.prototype._detectTestsOutputEditor=function(e){var t=this;this._testsOutputEditor=e.find(function(e){return e.document.fileName===t._testsOutputDocumentFileName})},p.prototype._revealFirstLineInTestOutputEditor=function(){var e=this._testsOutputEditor.document;if(e&&1<e.lineCount){var t=e.lineAt(0).firstNonWhitespaceCharacterIndex,a=new S.Position(0,t);this._testsOutputEditor.revealRange(new S.Range(a,a),3),this._testsOutputEditor.selection=new S.Selection(a,a)}},p.prototype._outputTestResults=function(e,t,a){var i,n=e.lines();e.build(t,this._testFilterToggled);var o=e.lines();if(!(i=a||o.length!==n.length))for(var r=0,s=o.length;r<s;r++)if(e.areDifferent(o[r],n[r])){i=!0;break}i&&e.render()},p._hash=function(e){return n.createHash("md5").update(e).digest("hex").substr(0,16)},p._cssEscape=function(e){for(var t,a=String(e),i=a.length,n=-1,o="",r=a.charCodeAt(0);++n<i;)1<=(t=a.charCodeAt(n))&&t<=31||127==t||0==n&&48<=t&&t<=57||1==n&&48<=t&&t<=57&&45==r?o+="\\"+t.toString(16)+" ":o+=128<=t||45==t||95==t||48<=t&&t<=57||65<=t&&t<=90||97<=t&&t<=122?a.charAt(n):"\\"+a.charAt(n);return o},p}(l.EventEmitter);e.exports=d},{"./compositeDisposable":3,"./screenshotContentProvider":5,"./testFileCoverageExplorer":6,"./testTimelineContentProvider":7,"./testsOutputBuilder":8,"./traceExplorer":9,"./valueExplorer":10,crypto:void 0,events:void 0,"fs-extra":void 0,https:void 0,lodash:void 0,openurl:void 0,os:void 0,path:void 0,vscode:void 0}],5:[function(e,t,a){"use strict";var i=e("vscode"),n=e("path"),o=function(){function e(e){this._onDidChange=new i.EventEmitter,this._screenshotUriResolver=e,this._screenShotUri=i.Uri.parse("wallaby-screenshot://authority/wallaby-screenshot"),this._panel=void 0}return e.prototype.display=function(){var e=this,t=function(){try{i.commands.executeCommand("vscode.previewHtml",i.Uri.parse("wallaby-screenshot://authority/wallaby-screenshot"),i.ViewColumn.Two)}catch(e){}};if(!this._panel)try{if(!i.window.createWebviewPanel)return void t();this._panel=i.window.createWebviewPanel("wallabyJsScreenshot","Wallaby Last Screenshot",i.ViewColumn.Two,{localResourceRoots:[i.Uri.file(n.dirname(this._screenshotUriResolver()))]})}catch(e){return void t()}this._panel.onDidDispose(function(){e._panel=void 0}),this.updateDisplay()},e.prototype.updateDisplay=function(){this._panel.webview.html=this.provideTextDocumentContent()},e.prototype.provideTextDocumentContent=function(){var e;try{e=this._screenshotUriResolver()}catch(e){return""}return'<!DOCTYPE html>\n            <html>\n            <head>\n            </head>\n            <body>\n                <img src="'+this._panel.webview.asWebviewUri(i.Uri.file(e)).toString()+"?ts="+ +new Date+'" />\n            </body>\n            </html>'},Object.defineProperty(e.prototype,"onDidChange",{get:function(){return this._onDidChange.event},enumerable:!0,configurable:!0}),e.prototype.update=function(){this._onDidChange.fire(this._screenShotUri),this._panel&&this.updateDisplay()},e}();t.exports=o},{path:void 0,vscode:void 0}],6:[function(e,t,a){"use strict";var i=e("vscode"),n=e("lodash"),o=function(){function e(e){this._context=e,this._treeDataProvider=new s,i.window.registerTreeDataProvider&&i.window.registerTreeDataProvider("wallaby.testFileCoverageExplorer",this._treeDataProvider)}return e.prototype.reset=function(){this._treeDataProvider._rootNodes=[],this._treeDataProvider.refresh()},e.prototype.update=function(e){var t=this,a=n.first(e.testFiles);this._treeDataProvider._rootNodes=[],a&&(this._treeDataProvider._rootNodes=[new r(this._context,a.file,a.coveredFiles.map(function(e){return new r(t._context,e)}))]),this._treeDataProvider.refresh()},e}(),r=function(){function e(e,t,a){this.iconPath=i.ThemeIcon.File,this.resourceUri=i.Uri.file(t.name),this.label=t.name+""+this._formatCodeCoverage(t.coverage),this.description=""+t.dir,this.tooltip="Open "+t.path,this.command={command:"wallaby.openFile",arguments:[{path:t.path,showCoverage:t.coverage&&t.coverage.low}]},this.collapsibleState=a?2:0,this._children=a}return e.prototype._formatCodeCoverage=function(e){return e?" | "+e.value+"%"+(e.low?"  ⚠️":""):""},e.prototype.getChildren=function(){return this._children?this._children:[]},e}(),s=function(){function e(){this._onDidChangeTreeData=new i.EventEmitter,this.onDidChangeTreeData=this._onDidChangeTreeData.event}return e.prototype.refresh=function(){this._onDidChangeTreeData.fire()},e.prototype.getTreeItem=function(e){return e},e.prototype.getChildren=function(e){return e?e.getChildren():Promise.resolve(this._rootNodes||[])},e}();t.exports=o},{lodash:void 0,vscode:void 0}],7:[function(e,t,a){"use strict";var j=this&&this.__assign||function(){return(j=Object.assign||function(e){for(var t,a=1,i=arguments.length;a<i;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},s=this&&this.__awaiter||function(e,r,s,l){return new(s||(s=Promise))(function(a,t){function i(e){try{o(l.next(e))}catch(e){t(e)}}function n(e){try{o(l.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(i,n)}o((l=l.apply(e,r||[])).next())})},l=this&&this.__generator||function(a,i){var n,o,r,e,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&t[0]?o.return:t[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,t[1])).done)return r;switch(o=0,r&&(t=[2&t[0],r.value]),t[0]){case 0:case 1:r=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,o=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(r=0<(r=s.trys).length&&r[r.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!r||t[1]>r[0]&&t[1]<r[3])){s.label=t[1];break}if(6===t[0]&&s.label<r[1]){s.label=r[1],r=t;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(t);break}r[2]&&s.ops.pop(),s.trys.pop();continue}t=i.call(a,s)}catch(e){t=[6,e],o=0}finally{n=r=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},F=e("vscode"),i=function(){function N(e){this._absolutePathResolver=e,this._onDidChange=new F.EventEmitter,this._onDidChangeCodeLenses=new F.EventEmitter;var t=new F.ThemeColor("editorCodeLens.foreground");this._annotationDecorationType=F.window.createTextEditorDecorationType({rangeBehavior:F.DecorationRangeBehavior.ClosedOpen,textDecoration:"none",before:{height:"100%",margin:"0 26px 0 0"}}),this._subtleDecorationType=F.window.createTextEditorDecorationType({rangeBehavior:F.DecorationRangeBehavior.ClosedOpen,textDecoration:"none",opacity:".3"}),this._logDecorationType=F.window.createTextEditorDecorationType({isWholeLine:!0,light:{after:{color:"#0000ff"}},dark:{after:{color:"rgba(86, 156, 214, 1)"}}}),this._systemLogDecorationType=F.window.createTextEditorDecorationType({isWholeLine:!0,after:{color:t}}),this._errorDecorationType=F.window.createTextEditorDecorationType({isWholeLine:!0,light:{after:{color:"#c80000"}},dark:{after:{color:"#fe536a"}}}),this._lineNumberStyle={color:t,opacity:".6"},this._fileNameStyle={color:t,opacity:".5",fontWeight:"bold"},this._headerStyle=this._footerStyle={color:t,opacity:".5",border:"solid",borderWidth:"0 0 1px 0"},this._fileContentSeparatorStyle={color:t,opacity:".5"},this._content={},this._unlocked=!1}return Object.defineProperty(N.prototype,"onDidChange",{get:function(){return this._onDidChange.event},enumerable:!0,configurable:!0}),Object.defineProperty(N.prototype,"onDidChangeCodeLenses",{get:function(){return this._onDidChangeCodeLenses.event},enumerable:!0,configurable:!0}),N.prototype._initialize=function(){this._initialized||(this._definitionProvider=F.languages.registerDefinitionProvider({scheme:"wallaby-test-timeline",language:"wallaby-timeline"},this),this._codeLensProvider||(this._codeLensProvider=F.languages.registerCodeLensProvider({scheme:"wallaby-test-timeline",language:"wallaby-timeline"},this)),this._changeRevealIfOpenSetting(),this._initialized=!0,this._unlocked=!1,F.commands.executeCommand("setContext","wallaby.testStoryUnlocked",this._unlocked))},N.prototype.changeLock=function(e,t){var a=this;this._unlocked=!e,F.commands.executeCommand("setContext","wallaby.testStoryUnlocked",!e),this._unlocked&&(t.forEach(function(e){e.setDecorations(a._logDecorationType,[]),e.setDecorations(a._systemLogDecorationType,[])}),this._content&&this._content.codeLens&&(this._content.codeLens.forEach(function(e){e.command.title="The rest of the test story can not be viewed in a detached mode.",delete e.command.command}),this._onDidChangeCodeLenses.fire()))},N.prototype.unlocked=function(){return this._unlocked},N.prototype.clear=function(e){var t=this;this._initialized&&!this._unlocked&&(this._definitionProvider.dispose(),delete this._content,delete this._showNewTimelineBeside,delete this._expectingTimelineLoad,e.forEach(function(e){return t._resetAllDecorations(e)}),this._uri&&this._onDidChange.fire(this._uri),this._restoreRevealIfOpenSetting(),delete this._uri,delete this._initialized)},N.prototype.uri=function(){return this._uri},N.prototype.dispose=function(){this.clear([]),this._codeLensProvider&&(this._codeLensProvider.dispose(),delete this._codeLensProvider)},N.prototype.expectingTimelineLoad=function(){this._expectingTimelineLoad=!0},N.prototype.isExpectingTimelineLoad=function(){return this._expectingTimelineLoad},N.prototype.provideTextDocumentContent=function(){return this._providedTextDocumentContent=(this._content||{}).text||"",this._providedTextDocumentContent},N.prototype.provideDefinition=function(e,t){if(this._content&&!this._updating&&!this._unlocked){var a=this._content.lines[t.line];if(a&&a.file&&a.num)return new F.Location(F.Uri.file(this._absolutePathResolver(a.file)),new F.Position(a.num-1,t.character))}},N.prototype.provideCodeLenses=function(e){if(this._initialized&&(this._onCodeLensProvided&&(this._onCodeLensProvided(),delete this._onCodeLensProvided),this._content&&this._content.codeLens&&!this._updating))return this._content.codeLens},N.prepareContentText=function(e){return e.replace(/ /g," ")},N.prototype.getLineByStep=function(e){if(this._content)return this._content.lineByStep[e]},N.prototype.getOriginalLocationByLine=function(e){if(this._content&&!this._unlocked){var t=this._content.lines[e-1];if(t&&t.file&&t.num)return{file:t.file,line:t.num,step:t.step}}},N.prototype._changeRevealIfOpenSetting=function(){try{var e=F.workspace.getConfiguration();this._revealIfOpenSetting=(e.inspect("workbench.editor.revealIfOpen")||{}).globalValue,e.update("workbench.editor.revealIfOpen",!0,!0)}catch(e){}},N.prototype._restoreRevealIfOpenSetting=function(){try{F.workspace.getConfiguration().update("workbench.editor.revealIfOpen",this._revealIfOpenSetting,!0),delete this._revealIfOpenSetting}catch(e){}},N.prototype.closing=function(){var t=this;this._closing=new Promise(function(e){t._closed=e})},N.prototype.isClosing=function(){return!!this._closing},N.prototype.closed=function(){this._closed(),delete this._closing,delete this._closed},N.prototype.show=function(o,r){return s(this,void 0,void 0,function(){var t,a,i,n=this;return l(this,function(e){switch(e.label){case 0:return e.trys.push([0,,7,8]),o?this._closing?(r.length=0,[4,this._closing]):[3,2]:[2];case 1:e.sent(),e.label=2;case 2:return t=!!r.length,this._content=this._generateDecoratedContent(o),this._initialize(),this._uri=F.Uri.parse("wallaby-test-timeline://authority/Test Story"),r.length?[3,5]:[4,this._updateTimelineDocument()];case 3:return e.sent(),a={preview:!1},this._showNewTimelineBeside?(a.viewColumn=-2,a.preserveFocus=!0,this._openedBeside=!0):this.resetOpenedBesideMode(),[4,F.window.showTextDocument(this._uri,a)];case 4:i=e.sent(),delete this._showNewTimelineBeside,i.options.lineNumbers=F.TextEditorLineNumbersStyle.Off,F.languages.setTextDocumentLanguage(i.document,"wallaby-timeline"),this._viewColumnWhenOpened=i.viewColumn,r=[i],e.label=5;case 5:return[4,Promise.all(r.map(function(e){return n._updateEditor(e,t)}))];case 6:return e.sent(),[3,8];case 7:return delete this._expectingTimelineLoad,[7];case 8:return[2]}})})},N.prototype.resetOpenedBesideMode=function(){delete this._openedBeside},N.prototype.openedBeside=function(){return this._openedBeside},N.prototype.viewColumnWhenOpened=function(){return this._viewColumnWhenOpened},N.prototype._updateTimelineDocument=function(){return s(this,void 0,void 0,function(){return l(this,function(e){switch(e.label){case 0:return void 0===this._providedTextDocumentContent||this._content.text===this._providedTextDocumentContent?[2]:(this._onDidChange.fire(this._uri),[4,new Promise(function(t){var a=F.workspace.onDidChangeTextDocument(function(e){e.document&&e.document.uri&&"wallaby-test-timeline"===e.document.uri.scheme&&(clearTimeout(i),a.dispose(),t())}),i=setTimeout(function(){a.dispose(),t()},2e3)})]);case 1:return e.sent(),[2]}})})},N.prototype._updateEditor=function(i,n){return s(this,void 0,void 0,function(){var t,a=this;return l(this,function(e){switch(e.label){case 0:return this._updating=!0,n?(t=new Promise(function(e){var t=setTimeout(function(){e()},500);a._onCodeLensProvided=function(){clearTimeout(t),setImmediate(e)}}),this._onDidChangeCodeLenses.fire(),[4,t]):[3,2];case 1:e.sent(),e.label=2;case 2:return[4,this._updateTimelineDocument()];case 3:return e.sent(),delete this._updating,this._onDidChangeCodeLenses.fire(),this._resetAllDecorations(i),this._updateDecorations(i),[2]}})})},N.prototype.update=function(e){e.options.lineNumbers=F.TextEditorLineNumbersStyle.Off,this._updateDecorations(e)},N.prototype.isTimelineLoaded=function(){return!!this._content},N.prototype._updateDecorations=function(e){if(e&&e.document&&e.document.uri&&"wallaby-test-timeline"===e.document.uri.scheme){var t=this._content;t?(e.setDecorations(this._annotationDecorationType,t.annotationDecorations),e.setDecorations(this._subtleDecorationType,t.subtleDecorations),e.setDecorations(this._errorDecorationType,t.errorDecorations)):this._resetAllDecorations(e)}},N.prototype._resetAllDecorations=function(e){e.setDecorations(this._logDecorationType,[]),e.setDecorations(this._systemLogDecorationType,[]),e.setDecorations(this._errorDecorationType,[]),e.setDecorations(this._annotationDecorationType,[]),e.setDecorations(this._subtleDecorationType,[])},N.prototype.updateTimelineEditorInlineValueDecorations=function(e,t,a){if(!this._unlocked&&e&&t&&e.document&&e.document.uri&&"wallaby-test-timeline"===e.document.uri.scheme){var i=this.getOriginalLocationByLine(t);if(i){var n=a[i.file];if(n&&n.lines&&n.lines.length){var o=n.lines.find(function(e){return e.num===i.line});if(o){var r=e.document.lineAt(t-1);if(r){var s={range:new F.Range(r.lineNumber,r.firstNonWhitespaceCharacterIndex,r.lineNumber,r.range.end.character)},l=o.log||"",c=o.longLog||l;c&&(s.hoverMessage=F.MarkdownString?new F.MarkdownString("```js\n"+c+"\n```"):c),s.renderOptions={after:{contentText:" ".repeat(2)+l}};var u=o.meta&&o.meta.system?this._systemLogDecorationType:this._logDecorationType;e.setDecorations(this._logDecorationType,[]),e.setDecorations(this._systemLogDecorationType,[]),l&&e.setDecorations(u,[s])}}}}}},N.prototype.showNewTimelineBeside=function(e){e?this._showNewTimelineBeside=!0:delete this._showNewTimelineBeside},N.prototype._generateDecoratedContent=function(e){var w,T,t,a,x=this,C=[],S=[],k=[],D=[],E={},P=function(){return D.length-1},i=e.maxLineNumber.toString().length,n=" ".repeat(i),O=function(e){var t,a=P();C.push({range:new F.Range(a,0,a,1),renderOptions:{before:j({contentText:N.prepareContentText((t=e,""+" ".repeat(i-t.toString().length)+t))},x._lineNumberStyle)}})},o=function(e,t,a){for(var i=0,n=t;i<n.length;i++){var o=n[i],r=o.n||"",s=o.content?""+o.content:o.separator?"​​":" ",l={text:s,num:r,file:e};D.push(l),o.separator&&(void 0,b=P(),C.push({range:new F.Range(b,0,b,1),renderOptions:{after:j({contentText:N.prepareContentText("…")},x._fileContentSeparatorStyle)}}));var c=P();if(o.executedLine){o.steps=o.steps||[a];for(var u=0,d=o.steps;u<d.length;u++){var p=d[u];E[p]=c}if(o.error){var h={range:new F.Range(c,0,c,s.length)},g=o.error;h.renderOptions={after:{contentText:" ".repeat(2)+g}},k.push(h)}l.step=o.steps[0],void 0===w&&(w=l.step),T=o.steps[o.steps.length-1]}if((!o.executedLine||o.contextRanges)&&!o.separator)if(o.contextRanges)for(var f=0,y=o.contextRanges;f<y.length;f++){var m=y[f],_=m[0],v=m[1];S.push({range:new F.Range(c,_,c,v)})}else S.push({range:new F.Range(c,0,c,s.length)});O(r)}var b},r=function(e){D.push({text:"​"}),D.push({text:"​"});var t,a=P();C.push({range:new F.Range(a,0,a,1),renderOptions:{after:j({contentText:N.prepareContentText((t=e,t))},x._fileNameStyle),before:{contentText:N.prepareContentText(n)}}}),D.push({text:"​"})},s=function(){D.push({text:"​"});var e=P();C.push({range:new F.Range(e,0,e,1),renderOptions:{after:j({contentText:N.prepareContentText(" ".repeat(100))},x._footerStyle)}})};e.truncatedStart&&(D.unshift({text:"​"}),t=new F.CodeLens(new F.Range(1,0,1,1),{title:"Load previous entries",command:"wallaby.showTestStory"}),function(){D.push({text:"​"});var e=P();C.push({range:new F.Range(e,0,e,1),renderOptions:{after:j({contentText:N.prepareContentText(" ".repeat(100))},x._headerStyle)}})}());for(var l=0,c=e.entries;l<c.length;l++){var u=c[l];u.file&&r(u.file),o(u.file,u.lines,u.step),s()}e.truncatedEnd&&(D.push({text:" "}),D.push({text:" "}),a=new F.CodeLens(new F.Range(D.length-1,0,D.length-1,1),{title:"Load next entries",command:"wallaby.showTestStory"}));var d=[];return t&&(t.command.arguments=[{before:w}],d.push(t)),a&&(a.command.arguments=[{after:T}],d.push(a)),{lines:D,lineByStep:E,text:D.map(function(e){return e.text}).join("\n"),annotationDecorations:C,subtleDecorations:S,errorDecorations:k,codeLens:d}},N}();t.exports=i},{vscode:void 0}],8:[function(e,t,a){"use strict";var c=this&&this.__assign||function(){return(c=Object.assign||function(e){for(var t,a=1,i=arguments.length;a<i;a++)for(var n in t=arguments[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},h=e("vscode"),g=e("lodash"),i={text:"",link:Array(2).join("​"),error:{start:"",end:" "},duration:Array(4).join("​"),suite:Array(5).join("​"),message:{start:"",end:" ",altEnd:" "+Array(6).join("​")},diffIns:Array(2).join("‌⁠"),diffDel:Array(2).join("‍"),tmpDiffIns:{start:"wsDiffIns",end:"weDiffIns"},tmpDiffDel:{start:"wsDiffDel",end:"weDiffDel"},linkNoStack:Array(2).join("​")},u=void 0!==h.env.remoteName,f="All tests covering the line of code:",y=" failing test",m="Launch Coverage & Test Explorer",_="Search Tests",v="Reset Test Filter",n=function(){function p(e,t,a,i,n,o,r,s,l,c,u){var d=this;this._lines=[],this._links=[],this._lineAndColumnLinks=n,this._contentLimit=204800,this._channel=e,this._absolutePathResolver=t,this._inExperimentalMode=u,this._channelPrefix=c||"",this._failingTestsOutput=o,this._tryGetDmp=a,this._timeEnd=" ms]​",this._sideBySideDiffSupported=s,this._wallabyAppLinkResolver=l,h.languages.registerDocumentLinkProvider&&i.add(h.languages.registerDocumentLinkProvider(r,{provideDocumentLinks:function(e){var t=e.lineAt(0);return t&&t.text&&(d._failingTestsOutput&&~t.text.indexOf(y)||!d._failingTestsOutput&&~t.text.indexOf(f))?d._links:[]}}))}return p.prototype.build=function(e,t){var i=this,n=this;if(n._lines=[],n._links=[],g.isString(e))n._appendLine(this._failingTestsOutput?"error":"message",0,e,this._failingTestsOutput&&"Error");else if(g.isObject(e)){var a=e.totalNumber,o=e.failingNumber,r=e.skippedNumber||0,s=e.todoNumber||0,l=a-o-r-s;if(this._failingTestsOutput){var c,u,d=this._markupStartToken("message")+o+y+(1===o?", ":"s, ")+l+" passing";r&&(c={start:(d+=", ").length},d+=r+" skipped",c.end=d.length),s&&(u={start:(d+=", ").length},d+=s+" todo",u.end=d.length),d+=(e.additionalHeaderMessage?" "+e.additionalHeaderMessage:"")+this._markupEndToken("message")+" "+this._markupStartToken("link")+m+this._markupEndToken("link")+" | "+this._markupStartToken("link")+_+this._markupEndToken("link")+(t?" | "+this._markupStartToken("link")+v+this._markupEndToken("link"):"")+(e.errors&&e.errors.length?"\n":""),n._appendLine("none",0,d,void 0,void 0,function(e){e=n._channelPrefix+e;var t=n._lines.length;if(c){var a={skipped:!0};n._links.push({range:new h.Range(t,c.start+n._channelPrefix.length,t,c.end+n._channelPrefix.length),target:h.Uri.parse("command:wallaby.jumpToTest?"+JSON.stringify(a))})}if(u){a={todo:!0};n._links.push({range:new h.Range(t,u.start+n._channelPrefix.length,t,u.end+n._channelPrefix.length),target:h.Uri.parse("command:wallaby.jumpToTest?"+JSON.stringify(a))})}~e.indexOf(m)&&n._links.push({range:new h.Range(t,e.indexOf(m),t,e.indexOf(m)+m.length),target:h.Uri.parse(i._wallabyAppLinkResolver())}),~e.indexOf(v)&&n._links.push({range:new h.Range(t,e.indexOf(v),t,e.indexOf(v)+v.length),target:h.Uri.parse("command:wallaby.resetTestFilter")}),~e.indexOf(_)&&n._links.push({range:new h.Range(t,e.indexOf(_),t,e.indexOf(_)+_.length),target:h.Uri.parse("command:wallaby.jumpToTest")})})}else n._appendLine("message",0,f,"");g.each(e.errors,function(e){n._outputError(e.message,e.stack,e.expected,e.actual,e.snapshot),n._appendLine("text",0,"")}),g.each(e.tests,function(e){return n._outputTest(e)})}},p.prototype.lines=function(){return this._lines},p.prototype.render=function(){this._channel.clear();for(var e=this._channelPrefix,t=0,a=this._lines.length;t<a;t++){if((e+=this._lines[t]+"\n").length>this._contentLimit){e+="\n--- output truncated to "+this._contentLimit+' bytes (use the "wallaby.outputContentSize" user setting to change the bytes limit) ---\n';break}}this._channel.append(e.replace(/\u0000/g,""))},p.prototype.show=function(){this._channel.hide(),this._channel.show(!0)},p.prototype.areDifferent=function(e,t){return!(e===t||~e.indexOf(this._timeEnd)&&~t.indexOf(this._timeEnd)&&e.substr(0,e.lastIndexOf("["))===t.substr(0,t.lastIndexOf("[")))},p.prototype.setContentLimit=function(e){e&&(this._contentLimit=e)},p.prototype.reset=function(){this._lines=[],this._links=[]},p.markupText=function(e,t){var a=[p.prototype._markupStartToken(e)||"",p.prototype._markupEndToken(e)||""];return""+a[0]+t+a[1]},p.diffCommandArguments=function(e,t){return[h.Uri.parse("wallaby-diff:data?"+new Buffer(e).toString("base64")),h.Uri.parse("wallaby-diff:data?"+new Buffer(t).toString("base64")),"Expected vs Actual"]},p.prototype.createDiffMarkdown=function(e,t,a,i){var n=[];return this._sideBySideDiffOutputLink(e,t,a,i,0,n),n.push("```wallaby-output"),this._diffOutput(e,t,0,n),n.push("```"),n.join("\n")},p.prototype._markupStartToken=function(e){var t=i[e];return g.isObject(t)?t.start:t},p.prototype._markupEndToken=function(e){var t=i[e];return g.isObject(t)?t.end:t},p.prototype._markupAltEndToken=function(e){var t=i[e];return g.isObject(t)?t.altEnd||t.end:t},p.prototype._sideBySideDiffOutputLink=function(e,t,a,i,n,o){var r=this;if(e=e||"",t=t||"",n=n||0,this._sideBySideDiffSupported){var s="\nShow side-by-side diff",l=h.Uri.parse("command:_workbench.diff?"+JSON.stringify([p.diffCommandArguments(e,t)])),c="Update snapshot",u=h.Uri.parse("command:wallaby.updateTestSnapshots?"+JSON.stringify(i)),d=a&&i;o?h.MarkdownString&&(s="[Show side-by-side diff]("+l+")",d&&(s+="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;["+c+"]("+u+")"),this._appendLine("linkNoStack",n,s,void 0,void 0,void 0,o)):this._appendLine("linkNoStack",n,s+(d?"  "+c:""),void 0,void 0,function(e,t){var a=r._lines.length;r._links.push({range:new h.Range(a,t,a,t+s.length-1),target:l}),d&&r._links.push({range:new h.Range(a,t+s.length+1,a,t+s.length+c.length+1),target:u})})}},p.prototype._updateSnapshotOutputLink=function(e,t){var i=this,n="Update snapshots\n",o=h.Uri.parse("command:wallaby.updateTestSnapshots?"+JSON.stringify(e));this._appendLine("linkNoStack",t,n,void 0,void 0,function(e,t){var a=i._lines.length;i._links.push({range:new h.Range(a,t,a,t+n.length-1),target:o})})},p.prototype._diffOutput=function(e,t,a,i){var o=this;e=e||"",t=t||"",a=a||0;var n=this._tryGetDmp();if(n){var r=(i?"":"\n")+n[n.diff_prettyCompactHtml?"diff_prettyCompactHtml":"diff_prettyHtml"](n.diff_wordMode(e,t)).replace(/&para;<br>/g,"\n").replace(/<br>/g,"\n").replace(/<span class="dots">\.\.\.<\/span>/g,this._markupStartToken("duration")||"..."+this._markupEndToken("duration")).replace(/<\/?span[^>]*>/g,"").replace(/<ins[^>]*>/g,this._markupStartToken("tmpDiffIns")).replace(/<del[^>]*>/g,this._markupStartToken("tmpDiffDel")).replace(/<\/ins[^>]*>/g,this._markupEndToken("tmpDiffIns")).replace(/<\/del[^>]*>/g,this._markupEndToken("tmpDiffDel")).replace(/style="background:#e6ffe6;"/g,"").replace(/style="background:#ffe6e6;"/g,"").replace(/&lt;/g,"<").replace(/&amp;/g,"&").replace(/&gt;/g,">"),s=0,l=0;this._appendLine("none",a,r,void 0,void 0,function(e){if(!e)return e;0<s&&(e=o._markupStartToken("diffIns")+e),0<l&&(e=o._markupStartToken("diffDel")+e);var t=(e.match(new RegExp(o._markupStartToken("tmpDiffIns"),"g"))||[]).length,a=(e.match(new RegExp(o._markupEndToken("tmpDiffIns"),"g"))||[]).length;s+=t-a;var i=(e.match(new RegExp(o._markupStartToken("tmpDiffDel"),"g"))||[]).length,n=(e.match(new RegExp(o._markupEndToken("tmpDiffDel"),"g"))||[]).length;return l+=i-n,0<s&&(e+=o._markupEndToken("diffIns")),0<l&&(e+=o._markupEndToken("diffDel")),e.replace(new RegExp(o._markupStartToken("tmpDiffIns"),"g"),o._markupStartToken("diffIns")).replace(new RegExp(o._markupEndToken("tmpDiffIns"),"g"),o._markupEndToken("diffIns")).replace(new RegExp(o._markupStartToken("tmpDiffDel"),"g"),o._markupStartToken("diffDel")).replace(new RegExp(o._markupEndToken("tmpDiffDel"),"g"),o._markupEndToken("diffDel"))},i)}},p.prototype._outputError=function(e,t,a,i,n,o){var r=this;o=o||0,this._tryGetDmp()&&(a||i?(this._sideBySideDiffOutputLink(a,i,n,t&&t.length&&t[0],o),this._diffOutput(a,i,o)):n&&this._updateSnapshotOutputLink(t&&t.length&&t[0],o)),this._appendLine("error",o,e),g.each(t,function(e){return r._outputLink(e,o+1)})},p.prototype._outputTest=function(i){var n=this,e=i.path&&g.last(i.path)||"",t=g.initial(i.path||[]).join(" "),o=""+this._markupStartToken("suite")+(t+" "+e).replace(/\r?\n|\r/g," ").replace(/\s\s+/g," ")+this._markupEndToken("suite"),a=g.isNumber(i.time)?"["+i.time+this._timeEnd:"",r=" Debug test",s=" Open test story",l=" |"+this._markupStartToken("link")+s+this._markupEndToken("link");n._appendLine("text",1,""),n._appendLine("text",1,o+" "+this._markupStartToken("duration")+a+this._markupEndToken("duration")+this._markupStartToken("link")+r+this._markupEndToken("link")+l,void 0,void 0,function(e,t){var a=n._lines.length;n._links.push({range:new h.Range(a,t,a,t+o.length),target:u?h.Uri.parse("command:wallaby.navigate?"+encodeURIComponent(JSON.stringify({file:i.file,loc:i.loc}))):h.Uri.parse(h.Uri.file(n._absolutePathResolver(i.file)).toString()+n._location(i.loc))}),n._links.push({range:new h.Range(a,e.lastIndexOf(r)+1,a,e.lastIndexOf(r)+r.length),target:h.Uri.parse("command:wallaby.debugTest?"+encodeURIComponent(JSON.stringify(i)))}),n._links.push({range:new h.Range(a,e.lastIndexOf(s)+1,a,e.lastIndexOf(s)+s.length),target:h.Uri.parse("command:wallaby.debugTest?"+encodeURIComponent(JSON.stringify(c(c({},i),{showTimeline:!0}))))})}),g.each(i.errors,function(e){return n._outputError("\n"+e.message,e.stack,e.expected,e.actual,e.snapshot,2)}),i.messages&&i.messages.length&&(n._appendLine("message",2,"\nFrom console:"),g.each(i.messages,function(e){return n._appendLine("message",3,"\n"+e.text),n._outputLink(e,3)}))},p.prototype._outputLink=function(i,e){var n=this;if(i.file){var o=i.file+":"+i.loc;this._appendLine("link",e,o,void 0,i.context,function(e,t){var a=n._lines.length;n._links.push({range:new h.Range(a,t,a,t+o.length),target:u?h.Uri.parse("command:wallaby.navigate?"+encodeURIComponent(JSON.stringify({file:i.file,loc:i.loc}))):h.Uri.parse(h.Uri.file(n._absolutePathResolver(i.file)).toString()+n._location(i.loc))})})}},p.prototype._location=function(e){var t,a;return g.isNumber(e)?t=e:g.isArray(e)?(t=e[0],a=e[1]):g.isString(e)&&(t=(e=e.split(":"))[0]&&parseInt(e[0],10),a=e[1]&&parseInt(e[1],10)),"#"+(this._lineAndColumnLinks&&g.isNumber(a)?t+","+(a+1):t)},p.prototype._appendLine=function(n,o,e,r,s,l,c){var u=this,t=e.split(/\r\n|\r|\n/);s&&s.replace&&(s=s.replace(/\r\n\s*/g," ").replace(/\n\s*/g," "));var d=[this._markupStartToken(n)||"",this._markupEndToken(n)||""];g.each(t,function(e){var t=(r?"["+r+"] ":"")+g.pad("",2*o,"   ")+("link"===n?"at "+(s?s+" ":""):"")+d[0],a=t+e+d[1];if(l){var i=l(a,t.length);i&&(a=i)}(c||u._lines).push(a)})},p}();t.exports=n},{lodash:void 0,vscode:void 0}],9:[function(e,t,a){"use strict";var i=e("vscode"),n=e("path"),o=e("lodash"),r=function(){function e(e){var t=this;this._callStackRootId=0,this._context=e,this._treeDataProvider=new u(function(){return t.traceBeingNavigated()}),this._onTraceNavigationStarted=new i.EventEmitter,this.onTraceNavigationStarted=this._onTraceNavigationStarted.event,i.window.registerTreeDataProvider&&i.window.registerTreeDataProvider("wallaby.traceExplorer",this._treeDataProvider)}return e.prototype.reset=function(e,t){this._sessionContext&&this._sessionContext.runPendingUpdates(),this._treeDataProvider._rootNodes=[],delete this._callStackNodes,e&&t&&(this._sessionContext=new s(this._context,e,t)),this._setTraceBeingNavigatedContext(!1)},e.prototype.update=function(e){var t=this;if(this._setTraceBeingNavigatedContext(!!e),e){if(e.callStack){var a=e.callStack[this._sessionContext.currentTraceFrame()];a&&a.stack&&(this._callStackNodes=a.stack.map(function(e){return new l(e,t._context)}))}e.tests&&(this._testNodes=o.map(e.tests,function(e){return new c(t._context,e,!0)})),e.files&&(this._fileNodes=o.map(e.files,function(e){return new c(t._context,e)})),e.length&&(this._traceLength=e.length,this._traceBeingNavigated&&this._currentStep&&(this._statusNode=this._navigationStatusNode(this._currentStep,this._traceLength))),this._sessionContext.receivedCallStack(e.callStack),this._sessionContext.runPendingUpdates(),this._updateNodes()}},e.prototype._navigationStatusNode=function(e,t){return{label:"Executed "+Math.floor((e.frame+1)/t*100)+"%",description:"step "+(e.frame+1)+" of "+t+" (click to locate)",iconPath:{light:this._context.asAbsolutePath("images/progress.light.svg"),dark:this._context.asAbsolutePath("images/progress.dark.svg")},command:{command:"wallaby.revealTraceStep",arguments:[e]}}},e.prototype._buildRootNodes=function(){var t=this,e=[];return this._statusNode&&e.push(this._statusNode),this._testNodes&&this._testNodes.length&&e.push({label:"Jump to",collapsibleState:2,iconPath:{light:this._context.asAbsolutePath("images/location.light.svg"),dark:this._context.asAbsolutePath("images/location.dark.svg")},getChildren:function(){var e=[];return t._testNodes&&t._testNodes.length&&(e=e.concat(t._testNodes)),t._fileNodes&&t._fileNodes.length&&e.push({label:"Loaded Files",collapsibleState:1,iconPath:{light:t._context.asAbsolutePath("images/files.light.svg"),dark:t._context.asAbsolutePath("images/files.dark.svg")},getChildren:function(){return t._fileNodes}}),e}}),this._traceBeingNavigated&&e.push({id:this._callStackRootId,label:"Call Stack",iconPath:{light:this._context.asAbsolutePath("images/callStack.light.svg"),dark:this._context.asAbsolutePath("images/callStack.dark.svg")},collapsibleState:1,getChildren:function(){if(t._callStackNodes){var e=t._callStackNodes;return delete t._callStackNodes,t._callStackRootId++,e}return t._sessionContext.requestCallStack(),new Promise(function(e){t._sessionContext.scheduleOnUpdate(e)})}}),e},e.prototype.requestTrace=function(e){return void 0===e&&(e={}),this._sessionContext.requestTrace(e)},e.prototype._setTraceBeingNavigatedContext=function(e,t){i.commands.executeCommand("setContext","wallaby.traceBeingNavigated",e);var a=!!this._traceBeingNavigated;(this._traceBeingNavigated=e)||(this._statusNode=void 0),a!==e&&!t&&this._updateNodes(),e&&!a&&this._onTraceNavigationStarted.fire()},e.prototype._updateNodes=function(){this._treeDataProvider._rootNodes=this._buildRootNodes(),this._treeDataProvider.refresh()},e.prototype.traceBeingNavigated=function(){return this._traceBeingNavigated},e.prototype.traceNavigated=function(e){e&&(this._currentStep=e,this._statusNode=this._navigationStatusNode(e,this._traceLength),this._sessionContext._traceContext.frame=e.frame),this._setTraceBeingNavigatedContext(!0,!0),this._updateNodes()},e.prototype.lastActiveStep=function(){return this._currentStep},e.prototype.updateTraceContext=function(e){return this._sessionContext.updateTraceContext(e)},e.prototype.stopTraceNavigation=function(){this._setTraceBeingNavigatedContext(!1),this._sessionContext.stopTraceNavigation(),this.update()},e}(),s=function(){function e(e,t,a){this._traceContext={},this._onUpdate=[],this._extensionContext=e,this._session=a,this._controller=t,this.id=a.id}return e.prototype.asAbsolutePath=function(e){return this._extensionContext.asAbsolutePath(e)},e.prototype.scheduleOnUpdate=function(e){this._onUpdate.push(e)},e.prototype.runPendingUpdates=function(){o.each(this._onUpdate,function(e){try{return e()}catch(e){}}),this._onUpdate.length=0},e.prototype.requestTrace=function(e){var a=this;return new Promise(function(t){return a._session.requestTrace(e,function(e){return t(e)})})},e.prototype.updateTraceContext=function(e){this._session.isDisposed()||this._session.traceContext({currentFrame:e.frame})},e.prototype.requestCallStack=function(){this._session.isDisposed()||(this._session.traceContext({captureCallStackFrame:this._traceContext.frame}),this._controller._runTests("valueLine"))},e.prototype.receivedCallStack=function(e){this._callStack=e},e.prototype.currentCallStack=function(){return this._callStack},e.prototype.currentTraceFrame=function(){return this._traceContext.frame},e.prototype.stopTraceNavigation=function(){this._session.isDisposed()||this._session.traceContext({stopNavigation:!0})},e}(),l=function(e,t){this._data=e,this.label=e.context||"...",this.description=n.basename(e.file)+":"+e.loc[0]+":"+e.loc[1],this.tooltip=this.label+" at "+e.file+":"+e.loc[0]+":"+e.loc[1],this.command={command:"wallaby.openCallStackFrame",arguments:[e]},this.iconPath={light:t.asAbsolutePath("images/location.light.svg"),dark:t.asAbsolutePath("images/location.dark.svg")}},c=function(e,t,a){this.iconPath={light:e.asAbsolutePath("images/location.light.svg"),dark:e.asAbsolutePath("images/location.dark.svg")},a?(this.label="Test ",this.description=t.name,this.iconPath={light:e.asAbsolutePath("images/test.light.svg"),dark:e.asAbsolutePath("images/test.dark.svg")}):this.label=t.name,this.tooltip="Jump to "+t.name,this.command={command:"wallaby.playTraceNextStep",arguments:[{frame:t.start}]}},u=function(){function e(e){this._traceBeingNavigated=e,this._onDidChangeTreeData=new i.EventEmitter,this.onDidChangeTreeData=this._onDidChangeTreeData.event}return e.prototype.refresh=function(){this._traceBeingNavigated()&&this._onDidChangeTreeData.fire()},e.prototype.getTreeItem=function(e){if(this._traceBeingNavigated())return e},e.prototype.getChildren=function(e){if(this._traceBeingNavigated())return e?e.getChildren():Promise.resolve(this._rootNodes)},e}();t.exports=r},{lodash:void 0,path:void 0,vscode:void 0}],10:[function(e,t,a){"use strict";var n=e("vscode"),d=e("lodash"),i=function(){function u(e,t){this._context=e,this._docsNode={label:"No logged values, click to see the feature docs",iconPath:this._context.asAbsolutePath("images/question.svg"),command:{command:"vscode.open",get arguments(){return[n.Uri.parse(t())]}},getParent:function(){}},this._treeDataProvider=new r(this._docsNode),this._treeDataProvider._rootNodes={},this._treeView=n.window.createTreeView("wallaby.valueExplorer",{treeDataProvider:this._treeDataProvider}),this._treeView.onDidExpandElement(function(e){return e.element.uiCollapsibleState=2}),this._treeView.onDidCollapseElement(function(e){return e.element.uiCollapsibleState=1})}return u.prototype.reveal=function(o,r){var s=this;if(Object.keys(this._treeDataProvider._rootNodes).length){var l=function(e){var t=s._treeDataProvider._rootNodes;for(var a in t)if(t.hasOwnProperty(a)){var i=t[a];if(i.label===e)return i}},e=l(o),c={expand:!0,focus:!0};if(e){var t=e.getChildren();if(t)if("function"==typeof t[Symbol.iterator]){for(var a=0,i=t;a<i.length;a++){var n=i[a];if(n.data().expressionLocation.line===r)return void this._reveal(n,c)}this._reveal(e,c)}else t.then(function(){var e=l(o);if(e){var t=e.getChildren();if(t)for(var a=0,i=t;a<i.length;a++){var n=i[a];if(n.data().expressionLocation.line===r)return void s._reveal(n,c)}s._reveal(e,c)}});else this._reveal(e,c)}else{var u=this._treeDataProvider._rootNodes;for(var d in u)if(u.hasOwnProperty(d)){var p=u[d];this._reveal(p,{expand:!1,focus:!1,select:!1})}}}else this._reveal(this._docsNode,{expand:!1,focus:!1,select:!1})},u.prototype._reveal=function(e,t){var a=this;return this._treeView.reveal(e,t).catch(function(){return a._treeView.reveal(e,t).catch(function(e){return console.error(e)})})},u.prototype.reset=function(e,t){this._sessionContext&&this._sessionContext.runPendingUpdates(),this._treeDataProvider._rootNodes={},this._treeDataProvider.refresh(),e&&t&&(this._sessionContext=new o(this._context,e,t))},u.prototype.update=function(l){var c=this;try{if(l.reset&&(this._treeDataProvider._rootNodes={},this._sessionContext.resetExpressionsToEvaluate()),!l.specificFile){var a=l.files||{};d.each(this._treeDataProvider._rootNodes,function(e,t){a[t]||(delete c._treeDataProvider._rootNodes[t],c._sessionContext.removeFileFromExpressionsToEvaluate(t))})}d.each(l.files,function(i,e){var t=c._treeDataProvider._rootNodes[e];if(!t||i.messages&&i.messages.length||i.active){var a=new p(c._sessionContext,{id:e,name:i.name,queryPath:e.toString(),label:{name:i.name},fileNode:!0,disallowToCopyPath:!0,disallowToCopyData:!0,expandable:!0}),n=!1;a._children=d.chain(i.messages).map(function(e){var t=(e.valueBag||{}).data;if(t){t.name||(t.name=u.removeExcessiveSpacesTabsLineBreaks(e.context));var a=(e.loc.toString()||"").split(":")[0];return a&&(t.name="line "+a+(t.name?": "+t.name:"")),t.label=t.label||{},t.label.name=t.name,t.context=e.context,t.rootValueNode=!0,t.expressionLocation={file:i.name,loc:e.loc,line:parseInt(a,10)},t}}).filter(function(e){return!!e}).sortBy(function(e){return e.expressionLocation.line}).map(function(e){return n=n||e.autoExpand,new p(c._sessionContext,e,a,e.autoExpand)}).value();var o=n||i.active;if(a._children.length?o&&(a.collapsibleState=2):l.reset?a.collapsibleState=1:(delete a._children,o&&(a.collapsibleState=2)),t){var r=t.uiCollapsibleState,s=t.collapsibleState;void 0!==r?2!==r&&n?a.id=t.id.toString().startsWith("A")?a.id:"A"+a.id:(a.uiCollapsibleState=r,a.collapsibleState=r):void 0!==s&&a.collapsibleState!==s&&(a.id=t.id.toString().startsWith("A")?a.id:"A"+a.id)}c._treeDataProvider._rootNodes[e]=a}}),this._sessionContext.runPendingUpdates(),this._treeDataProvider.refresh()}catch(e){console.warn("Error while updating Value Explorer nodes: "+e.stack)}},u.removeExcessiveSpacesTabsLineBreaks=function(e){return e&&e.replace(/\r\n\s*/g," ").replace(/\n\s*/g," ")},u}(),o=function(){function e(e,t,a){this._expressionsToEvaluate={},this._onUpdate=[],this._extensionContext=e,this._session=a,this._controller=t,this.id=a.id}return e.prototype.asAbsolutePath=function(e){return this._extensionContext.asAbsolutePath(e)},e.prototype.isPathRequested=function(e,t){if("string"!=typeof e){var a=this._expressionsToEvaluate,i=d.every(e,function(e){return!!a[e]&&(a=a[e],!0)});return i&&t?JSON.stringify(t)===JSON.stringify(a):i}},e.prototype.requestNodes=function(e,t){var a=e._queryPath;if("string"!=typeof a){var i=this._expressionsToEvaluate;d.each(a,function(e){i[e]=i[e]||{},i=i[e]}),t&&(i.props=t.props,i.strLength=t.strLength,i.ranges=t.ranges),this._session.isDisposed()||(this._session.expressionsToEvaluate(this._expressionsToEvaluate),this._controller._runTests("valueLine",e.getRootExpressionLocation()))}else!this._session.isDisposed()&&this._session.getFileMessages(a)},e.prototype.scheduleOnUpdate=function(e){this._onUpdate.push(e)},e.prototype.copyToClipboard=function(e){!this._session.isDisposed()&&this._session.copyToClipboard(e)},e.prototype.cancelPendingUpdates=function(){this._onUpdate=[]},e.prototype.runPendingUpdates=function(){d.each(this._onUpdate,function(e){try{return e()}catch(e){}}),this._onUpdate.length=0},e.prototype.removeFileFromExpressionsToEvaluate=function(t){var a=this;d.each(d.keys(this._expressionsToEvaluate),function(e){parseInt(e.split(",")[0],10)&&delete a._expressionsToEvaluate[t]})},e.prototype.resetExpressionsToEvaluate=function(){this._expressionsToEvaluate={}},e}(),p=function(){function t(e,t,a,i){this._context=e,this._parent=a,this._data=t,this.label=this._createLabel(),this.description=t.label&&t.label.description,this._queryPath=t.queryPath,this.id=(i?"A":"")+t.id,this.iconPath=this._getIconPath(),this.contextValue="",t.target&&(t.target.range=[t.target.line,0,t.target.line,1e4],t.target.noTrace=!0,this.command={command:"wallaby.openCallStackFrame",arguments:[t.target]}),t.disallowToCopyPath||(this.contextValue+="WallabyAllowToCopyPath"),t.disallowToCopyData||(this.contextValue+="WallabyAllowToCopyData"),t.rootValueNode&&(this.contextValue+="WallabyAllowToGoToSource"),this._autoExpand=i&&!this._data.cappedProps&&!this._data.capped&&!this._data.callStackNode&&!this._data.loadActionNode&&!this._data.rangeNode&&"string"!==this._data.type&&!this._data.getter&&!this._data.setter,this.collapsibleState=t.expandable?this._autoExpand?2:1:0,t.rangeNode&&(this._parentArray=a._parentArray||a,this._queryPath=this._parentArray._queryPath),t.fileNode&&(this.iconPath=n.ThemeIcon.File,this.resourceUri=n.Uri.file(t.name))}return t.prototype.getParent=function(){return this._parent},t.prototype.getChildren=function(){var a=this;if(this._children)return this._children;if("string"===this._data.type&&this._data.capped)return this._getChildren({strLength:Number.MAX_VALUE});if(this._data.loadActionNode)return this._getChildren({props:Number.MAX_VALUE});var e=(this._data.props||[]).map(function(e){return new t(a._context,e,a,a._autoExpand)});return e.length?Promise.resolve(e):this._data.rangeNode?this._getChildren({ranges:{props:JSON.parse(JSON.stringify(this._parentArray._data.props,function(e,t){return t.props&&(!t.props.length&&t===a._data||t.props.length&&!t.props[0].rangeNode)&&(t.props=!0),t})),length:this._parentArray._data.length}}):this._getChildren()},t.prototype.copyExpressionPath=function(){(this._data||{}).expressionPath&&this._context.copyToClipboard(this._data.expressionPath.join(""))},t.prototype.copyExpressionData=function(){this._data&&this._context.copyToClipboard(this._data)},t.prototype.data=function(){return this._data},t.prototype.getRootExpressionLocation=function(){for(var e=this;e&&!e._data.rootValueNode;)e=e._parent;if(e)return e._data.expressionLocation},t.prototype._getChildren=function(e){var t=this;return this._context.isPathRequested(this._queryPath,e)?[]:(this._context.requestNodes(this,e),new Promise(function(e){return t._context.scheduleOnUpdate(e)}))},t.prototype._getIconPath=function(){if(this._data.getter)return this._context.asAbsolutePath("images/getter.svg");if(this._data.functionsNode)return this._context.asAbsolutePath("images/function.svg");if(this._data.loadActionNode)return this._context.asAbsolutePath("images/more.svg");if(this._data.error)return this._context.asAbsolutePath("images/error.svg");if(this._data.rangeNode)return this._context.asAbsolutePath("images/range.svg");if(this._data.callStackNode)return{light:this._context.asAbsolutePath("images/callStack.light.svg"),dark:this._context.asAbsolutePath("images/callStack.dark.svg")};if(this._data.callStackEntryNode)return{light:this._context.asAbsolutePath("images/location.light.svg"),dark:this._context.asAbsolutePath("images/location.dark.svg")};if(this._data.proxyNode)return{light:this._context.asAbsolutePath("images/usages.light.svg"),dark:this._context.asAbsolutePath("images/usages.dark.svg")};if(!this._data.fileNode){if(this._data.type)switch(this._data.type.toLowerCase()){case"string":if(this._data.capped)return this._context.asAbsolutePath("images/cappedString.svg");case"object":case"array":case"number":case"function":case"boolean":case"date":case"regexp":case"symbol":case"null":case"undefined":return this._context.asAbsolutePath("images/"+this._data.type.toLowerCase()+".svg")}return this._context.asAbsolutePath("images/object.svg")}},t.prototype._createLabel=function(){var e=this._data.label,t="";return e.name&&(t+=e.name),e.type&&(t+=": "+e.type+" "),e.value&&(t+=(e.type?"":": ")+e.value),t},t}(),r=function(){function e(e){this._docsNode=e,this._onDidChangeTreeData=new n.EventEmitter,this.onDidChangeTreeData=this._onDidChangeTreeData.event}return e.prototype.refresh=function(){this._onDidChangeTreeData.fire()},e.prototype.getTreeItem=function(e){return e},e.prototype.getParent=function(e){if(e)return e.getParent()},e.prototype.getChildren=function(e){if(e)return e.getChildren();if(d.isEmpty(this._rootNodes))return Promise.resolve([this._docsNode]);try{return Promise.resolve(d.chain(this._rootNodes).values().sortBy(function(e){return e._data.name}).value())}catch(e){console.warn("Error while trying to get Value Explorer root nodes: "+e.stack),Promise.resolve([])}},e}();t.exports=i},{lodash:void 0,vscode:void 0}],11:[function(e,t,a){t.exports={name:"wallaby-vscode",displayName:"Wallaby.js",description:"Accelerated Distraction-free JavaScript Testing.",version:"1.0.244",author:"Wallaby.js",homepage:"http://wallabyjs.com",bugs:{url:"https://github.com/wallabyjs/public/issues"},publisher:"WallabyJs",repository:{},engines:{vscode:"^1.25.0"},keywords:["testing","runner","unittest","JavaScript","TypeScript"],categories:["Other"],activationEvents:["*"],main:"./index",icon:"images/logo.png",galleryBanner:{color:"#ffffff",theme:"light"},contributes:{viewsContainers:{activitybar:[{id:"wallaby",title:"Wallaby Tools",icon:"images/logo.svg"}]},views:{wallaby:[{id:"wallaby.valueExplorer",name:"Value Explorer",when:"wallaby.started && wallaby.reportedAtLeastOnceLogValue"},{id:"wallaby.traceExplorer",name:"Debugger",when:"wallaby.traceBeingNavigated"},{id:"wallaby.testFileCoverageExplorer",name:"Test File Coverage",when:"wallaby.started"}]},commands:[{command:"wallaby.start",title:"Start",category:"Wallaby.js"},{command:"wallaby.stop",title:"Stop",category:"Wallaby.js"},{command:"wallaby.showCommandPalette",title:"Show Commands",category:"Wallaby.js"},{command:"wallaby.jumpToFailingTest",title:"Jump to Failing Test",category:"Wallaby.js"},{command:"wallaby.jumpToErrorSource",title:"Jump to Error Source",category:"Wallaby.js"},{command:"wallaby.toggleUncovered",title:"Toggle Uncovered Code Regions",category:"Wallaby.js"},{command:"wallaby.showLineTests",title:"Show Line Tests",category:"Wallaby.js"},{command:"wallaby.showLineTestsFromMenu",title:"Wallaby.js: Show Line Tests",category:"Wallaby.js"},{command:"wallaby.showFailingTests",title:"Show Failing Tests",category:"Wallaby.js"},{command:"wallaby.showSideBySideDiff",title:"Show Side-by-Side Diff",category:"Wallaby.js"},{command:"wallaby.runProjectTests",title:"Run Project Tests",category:"Wallaby.js"},{command:"wallaby.runFileTests",title:"Run File Tests",category:"Wallaby.js"},{command:"wallaby.runLineTests",title:"Run Line Tests",category:"Wallaby.js"},{command:"wallaby.startExclusively",title:"Start Exclusive Test Run",category:"Wallaby.js"},{command:"wallaby.startExclusivelyFromMenu",title:"Wallaby.js: Start Exclusive Test Run",category:"Wallaby.js"},{command:"wallaby.addToExclusiveTestRun",title:"Add to Exclusive Test Run",category:"Wallaby.js"},{command:"wallaby.addToExclusiveTestRunFromMenu",title:"Wallaby.js: Add to Exclusive Test Run",category:"Wallaby.js"},{command:"wallaby.updateProjectSnapshots",title:"Update Project Snapshots",category:"Wallaby.js"},{command:"wallaby.updateFileSnapshots",title:"Update File Snapshots",category:"Wallaby.js"},{command:"wallaby.updateTestSnapshots",title:"Update Test Snapshots",category:"Wallaby.js"},{command:"wallaby.showValue",title:"Show Value",category:"Wallaby.js"},{command:"wallaby.copyValue",title:"Copy Value",category:"Wallaby.js"},{command:"wallaby.openWallabyApp",title:"Launch Coverage & Test Explorer",category:"Wallaby.js"},{command:"wallaby.selectConfigFile",title:"Select Configuration",category:"Wallaby.js"},{command:"wallaby.showLastScreenshot",title:"Show Last Screenshot",category:"Wallaby.js"},{command:"wallaby.showLicense",title:"Manage License Key",category:"Wallaby.js"},{command:"wallaby.copyExpressionPath",title:"Copy Path",category:"Wallaby.js"},{command:"wallaby.copyExpressionData",title:"Copy Data",category:"Wallaby.js"},{command:"wallaby.goToExpressionSource",title:"Go to Source",category:"Wallaby.js"},{command:"wallaby.copyDiagnosticsReportToClipboard",title:"Copy Diagnostics Report",category:"Wallaby.js"},{command:"wallaby.runModeOnSave",title:"Make Current Session Run Only on Save",category:"Wallaby.js"},{command:"wallaby.runModeImmediate",title:"Make Current Session Run on Any Change",category:"Wallaby.js"},{command:"wallaby.runModeToggle",title:"Toggle Current Session Run Mode (Any Change/On Save)",category:"Wallaby.js"},{command:"wallaby.forceCoreUpdate",title:"Force Core Update",category:"Wallaby.js"},{command:"wallaby.toggleTestFilter",title:"Toggle Test Filter",category:"Wallaby.js"},{command:"wallaby.resetTestFilter",title:"Reset Test Filter",category:"Wallaby.js"},{command:"wallaby.resetUncovered",title:"Reset Uncovered Code Regions",category:"Wallaby.js"},{command:"wallaby.playTraceNextStep",title:"Step Into",category:"Wallaby.js",icon:{dark:"images/debug-step-into.dark.svg",light:"images/debug-step-into.light.svg"}},{command:"wallaby.playTracePrevStep",title:"Step Back Into",category:"Wallaby.js",icon:{dark:"images/debug-step-into-back.dark.svg",light:"images/debug-step-into-back.light.svg"}},{command:"wallaby.playTraceForwardToSelection",title:"Run to Active Line",category:"Wallaby.js",icon:{dark:"images/debug-continue.dark.svg",light:"images/debug-continue.light.svg"}},{command:"wallaby.playTraceBackwardToSelection",title:"Run Back to Active Line",category:"Wallaby.js",icon:{dark:"images/debug-continue-back.dark.svg",light:"images/debug-continue-back.light.svg"}},{command:"wallaby.playTraceNextStepOver",title:"Step Over",category:"Wallaby.js",icon:{dark:"images/debug-step-over.dark.svg",light:"images/debug-step-over.light.svg"}},{command:"wallaby.playTracePrevStepOver",title:"Step Back Over",category:"Wallaby.js",icon:{dark:"images/debug-step-over-back.dark.svg",light:"images/debug-step-over-back.light.svg"}},{command:"wallaby.playTraceNextStepOut",title:"Step Out",category:"Wallaby.js",icon:{dark:"images/debug-step-out.dark.svg",light:"images/debug-step-out.light.svg"}},{command:"wallaby.playTracePrevStepOut",title:"Step Back Out",category:"Wallaby.js",icon:{dark:"images/debug-step-out-back.dark.svg",light:"images/debug-step-out-back.light.svg"}},{command:"wallaby.openCallStackFrame",title:"Open Call Stack Frame",category:"Wallaby.js"},{command:"wallaby.revealTraceStep",title:"Reveal Trace Step",category:"Wallaby.js"},{command:"wallaby.stopTraceNavigation",title:"Stop Debugger",category:"Wallaby.js",icon:{dark:"images/stop.dark.svg",light:"images/stop.light.svg"}},{command:"wallaby.lockTestStory",title:"Attach Test Story File to Debugger and Code",category:"Wallaby.js",icon:{dark:"images/lock.dark.svg",light:"images/lock.light.svg"}},{command:"wallaby.unlockTestStory",title:"Detach Test Story File from Debugger and Code",category:"Wallaby.js",icon:{dark:"images/unlock.dark.svg",light:"images/unlock.light.svg"}},{command:"wallaby.statusBarCommand",title:"Status Bar Command",category:"Wallaby.js"},{command:"wallaby.debugTest",title:"Debug Test",category:"Wallaby.js"},{command:"wallaby.showTestStory",title:"Open Test Story",category:"Wallaby.js"},{command:"wallaby.showTestStoryBeside",title:"Open Test Story Beside",category:"Wallaby.js"},{command:"wallaby.jumpToTest",title:"Jump to Test",category:"Wallaby.js"},{command:"wallaby.searchTests",title:"Search Tests",category:"Wallaby.js"},{command:"wallaby.openFile",title:"Open File",category:"Wallaby.js"},{command:"wallaby.revealValue",title:"Reveal in Value Explorer",category:"Wallaby.js"},{command:"wallaby.navigate",title:"Navigate to File",category:"Wallaby.js"}],menus:{"extension/context":[{command:"wallaby.showLicense",when:"extensionStatus == installed && extension == wallabyjs.wallaby-vscode"},{command:"wallaby.forceCoreUpdate",when:"extensionStatus == installed && extension == wallabyjs.wallaby-vscode"}],"explorer/context":[{command:"wallaby.startExclusivelyFromMenu",when:"!wallaby.started && wallaby.feature.exclusiveTestRun && explorerResourceIsFolder && resourceFilename != .idea && resourceFilename != .vs && resourceFilename != .vscode && resourceFilename != node_modules || !wallaby.started && wallaby.feature.exclusiveTestRun && resourceLangId == javascript && resourceFilename =~ /^(?!wallaby).*\\.js$/ && resourceFilename != jest.config.js || !wallaby.started && wallaby.feature.exclusiveTestRun && resourceLangId == javascriptreact || !wallaby.started && wallaby.feature.exclusiveTestRun && resourceLangId == typescript || !wallaby.started && wallaby.feature.exclusiveTestRun && resourceLangId == typescriptreact || !wallaby.started && wallaby.feature.exclusiveTestRun && resourceLangId == coffeescript || !wallaby.started && wallaby.feature.exclusiveTestRun && resourceLangId == vue",group:"WallabyGroup@1"},{command:"wallaby.addToExclusiveTestRunFromMenu",when:"wallaby.started && wallaby.feature.exclusiveTestRun && explorerResourceIsFolder && resourceFilename != .idea && resourceFilename != .vs && resourceFilename != .vscode && resourceFilename != node_modules || wallaby.started && wallaby.feature.exclusiveTestRun && resourceLangId == javascript && resourceFilename =~ /^(?!wallaby).*\\.js$/ && resourceFilename != jest.config.js || wallaby.started && wallaby.feature.exclusiveTestRun && resourceLangId == javascriptreact || wallaby.started && wallaby.feature.exclusiveTestRun && resourceLangId == typescript || wallaby.started && wallaby.feature.exclusiveTestRun && resourceLangId == typescriptreact || wallaby.started && wallaby.feature.exclusiveTestRun && resourceLangId == coffeescript || wallaby.started && wallaby.feature.exclusiveTestRun && resourceLangId == vue",group:"WallabyGroup@1"}],"editor/title":[{command:"wallaby.playTraceBackwardToSelection",when:"wallaby.started && wallaby.traceBeingNavigated && resourceScheme != wallaby-test-timeline || wallaby.started && wallaby.traceBeingNavigated && !wallaby.testStoryUnlocked",group:"navigation@-999"},{command:"wallaby.playTracePrevStepOut",when:"wallaby.started && wallaby.traceBeingNavigated && resourceScheme != wallaby-test-timeline || wallaby.started && wallaby.traceBeingNavigated && !wallaby.testStoryUnlocked",group:"navigation@-998"},{command:"wallaby.playTracePrevStep",when:"wallaby.started && wallaby.traceBeingNavigated && resourceScheme != wallaby-test-timeline || wallaby.started && wallaby.traceBeingNavigated && !wallaby.testStoryUnlocked",group:"navigation@-997"},{command:"wallaby.playTracePrevStepOver",when:"wallaby.started && wallaby.traceBeingNavigated && resourceScheme != wallaby-test-timeline || wallaby.started && wallaby.traceBeingNavigated && !wallaby.testStoryUnlocked",group:"navigation@-996"},{command:"wallaby.stopTraceNavigation",when:"wallaby.started && wallaby.traceBeingNavigated && resourceScheme != wallaby-test-timeline || wallaby.started && wallaby.traceBeingNavigated && !wallaby.testStoryUnlocked",group:"navigation@-995"},{command:"wallaby.playTraceNextStepOver",when:"wallaby.started && wallaby.traceBeingNavigated && resourceScheme != wallaby-test-timeline || wallaby.started && wallaby.traceBeingNavigated && !wallaby.testStoryUnlocked",group:"navigation@-994"},{command:"wallaby.playTraceNextStep",when:"wallaby.started && wallaby.traceBeingNavigated && resourceScheme != wallaby-test-timeline || wallaby.started && wallaby.traceBeingNavigated && !wallaby.testStoryUnlocked",group:"navigation@-993"},{command:"wallaby.playTraceNextStepOut",when:"wallaby.started && wallaby.traceBeingNavigated && resourceScheme != wallaby-test-timeline || wallaby.started && wallaby.traceBeingNavigated && !wallaby.testStoryUnlocked",group:"navigation@-992"},{command:"wallaby.playTraceForwardToSelection",when:"wallaby.started && wallaby.traceBeingNavigated && resourceScheme != wallaby-test-timeline || wallaby.started && wallaby.traceBeingNavigated && !wallaby.testStoryUnlocked",group:"navigation@-991"},{command:"wallaby.lockTestStory",when:"wallaby.started && wallaby.traceBeingNavigated && wallaby.testStoryUnlocked && resourceScheme == wallaby-test-timeline",group:"navigation@-990"},{command:"wallaby.unlockTestStory",when:"wallaby.started && wallaby.traceBeingNavigated && !wallaby.testStoryUnlocked && resourceScheme == wallaby-test-timeline",group:"navigation@-990"}],commandPalette:[{command:"wallaby.jumpToFailingTest",when:"wallaby.started"},{command:"wallaby.jumpToErrorSource",when:"wallaby.started"},{command:"wallaby.toggleUncovered",when:"wallaby.started && activeEditor"},{command:"wallaby.showLineTests",when:"wallaby.started && activeEditor"},{command:"wallaby.showLineTestsFromMenu",when:"false"},{command:"wallaby.showFailingTests",when:"wallaby.started"},{command:"wallaby.showSideBySideDiff",when:"wallaby.started && activeEditor"},{command:"wallaby.runProjectTests",when:"wallaby.started"},{command:"wallaby.runFileTests",when:"wallaby.started && activeEditor"},{command:"wallaby.runLineTests",when:"wallaby.started && activeEditor"},{command:"wallaby.startExclusively",when:"activeEditor && wallaby.feature.exclusiveTestRun"},{command:"wallaby.startExclusivelyFromMenu",when:"false"},{command:"wallaby.addToExclusiveTestRun",when:"activeEditor && wallaby.started && wallaby.feature.exclusiveTestRun"},{command:"wallaby.addToExclusiveTestRunFromMenu",when:"false"},{command:"wallaby.updateProjectSnapshots",when:"wallaby.started"},{command:"wallaby.updateFileSnapshots",when:"wallaby.started && activeEditor"},{command:"wallaby.updateTestSnapshots",when:"wallaby.started && activeEditor"},{command:"wallaby.showValue",when:"wallaby.started && activeEditor"},{command:"wallaby.copyValue",when:"wallaby.started && activeEditor"},{command:"wallaby.openWallabyApp",when:"wallaby.started"},{command:"wallaby.showLastScreenshot",when:"wallaby.started"},{command:"wallaby.copyDiagnosticsReportToClipboard",when:"wallaby.started && wallaby.feature.diagnostics"},{command:"wallaby.runModeOnSave",when:"wallaby.started"},{command:"wallaby.runModeImmediate",when:"wallaby.started"},{command:"wallaby.runModeToggle",when:"wallaby.started"},{command:"wallaby.copyExpressionPath",when:"false"},{command:"wallaby.copyExpressionData",when:"false"},{command:"wallaby.goToExpressionSource",when:"false"},{command:"wallaby.toggleTestFilter",when:"wallaby.started && activeEditor && wallaby.feature.testFilters"},{command:"wallaby.resetTestFilter",when:"wallaby.started && wallaby.testFilterToggled && wallaby.feature.testFilters"},{command:"wallaby.resetUncovered",when:"wallaby.started && wallaby.uncoveredToggled"},{command:"wallaby.playTraceNextStep",when:"false"},{command:"wallaby.playTracePrevStep",when:"false"},{command:"wallaby.playTraceForwardToSelection",when:"false"},{command:"wallaby.playTraceBackwardToSelection",when:"false"},{command:"wallaby.playTraceNextStepOver",when:"false"},{command:"wallaby.playTracePrevStepOver",when:"false"},{command:"wallaby.playTraceNextStepOut",when:"false"},{command:"wallaby.playTracePrevStepOut",when:"false"},{command:"wallaby.openCallStackFrame",when:"false"},{command:"wallaby.revealTraceStep",when:"false"},{command:"wallaby.stopTraceNavigation",when:"wallaby.started && wallaby.traceBeingNavigated"},{command:"wallaby.statusBarCommand",when:"false"},{command:"wallaby.debugTest",when:"wallaby.started && activeEditor && wallaby.feature.debugger"},{command:"wallaby.showTestStory",when:"wallaby.started && wallaby.feature.testStory && wallaby.traceBeingNavigated || wallaby.started && wallaby.feature.testStory && activeEditor"},{command:"wallaby.showTestStoryBeside",when:"wallaby.started && wallaby.feature.testStory && wallaby.traceBeingNavigated || wallaby.started && wallaby.feature.testStory && activeEditor"},{command:"wallaby.jumpToTest",when:"wallaby.started"},{command:"wallaby.searchTests",when:"wallaby.started"},{command:"wallaby.openFile",when:"false"},{command:"wallaby.revealValue",when:"wallaby.started && activeEditor"},{command:"wallaby.lockTestStory",when:"false"},{command:"wallaby.unlockTestStory",when:"false"},{command:"wallaby.navigate",when:"false"}],"view/title":[{command:"wallaby.playTraceBackwardToSelection",when:"view =~ /wallaby.traceExplorer/",group:"navigation@1"},{command:"wallaby.playTracePrevStepOut",when:"view =~ /wallaby.traceExplorer/",group:"navigation@2"},{command:"wallaby.playTracePrevStep",when:"view =~ /wallaby.traceExplorer/",group:"navigation@3"},{command:"wallaby.playTracePrevStepOver",when:"view =~ /wallaby.traceExplorer/",group:"navigation@4"},{command:"wallaby.stopTraceNavigation",when:"view =~ /wallaby.traceExplorer/ && wallaby.traceBeingNavigated",group:"navigation@5"},{command:"wallaby.playTraceNextStepOver",when:"view =~ /wallaby.traceExplorer/",group:"navigation@6"},{command:"wallaby.playTraceNextStep",when:"view =~ /wallaby.traceExplorer/",group:"navigation@7"},{command:"wallaby.playTraceNextStepOut",when:"view =~ /wallaby.traceExplorer/",group:"navigation@8"},{command:"wallaby.playTraceForwardToSelection",when:"view =~ /wallaby.traceExplorer/",group:"navigation@9"}],"view/item/context":[{command:"wallaby.copyExpressionPath",when:"viewItem =~ /WallabyAllowToCopyPath/"},{command:"wallaby.copyExpressionData",when:"viewItem =~ /WallabyAllowToCopyData/"},{command:"wallaby.goToExpressionSource",when:"viewItem =~ /WallabyAllowToGoToSource/"}],"editor/context":[{command:"wallaby.showLineTestsFromMenu",group:"WallabyGroup@1",when:"wallaby.started"}]},keybindings:[{command:"wallaby.showCommandPalette",key:"ctrl+shift+=",mac:"cmd+shift+="},{command:"wallaby.start",key:"ctrl+shift+r r",mac:"cmd+shift+r r"},{command:"wallaby.stop",key:"ctrl+shift+r s",mac:"cmd+shift+r s"},{command:"wallaby.runProjectTests",key:"ctrl+shift+r p",mac:"cmd+shift+r p",when:"wallaby.started"},{command:"wallaby.showLastScreenshot",key:"ctrl+shift+r h",mac:"cmd+shift+r h",when:"wallaby.started"},{command:"wallaby.runLineTests",key:"ctrl+shift+r c",mac:"cmd+shift+r c",when:"wallaby.started && editorTextFocus"},{command:"wallaby.runFileTests",key:"ctrl+shift+r f",mac:"cmd+shift+r f",when:"wallaby.started && editorTextFocus"},{command:"wallaby.jumpToFailingTest",key:"ctrl+shift+r o",mac:"cmd+shift+r o",when:"wallaby.started && editorTextFocus"},{command:"wallaby.jumpToErrorSource",key:"ctrl+shift+r p",mac:"cmd+shift+r p",when:"wallaby.started && editorTextFocus"},{command:"wallaby.toggleUncovered",key:"ctrl+shift+r u",mac:"cmd+shift+r u",when:"wallaby.started && editorTextFocus"},{command:"wallaby.showFailingTests",key:"ctrl+shift+r t",mac:"cmd+shift+r t",when:"wallaby.started"},{command:"wallaby.showLineTests",key:"ctrl+shift+r l",mac:"cmd+shift+r l",when:"wallaby.started && editorTextFocus"},{command:"wallaby.showSideBySideDiff",key:"ctrl+shift+r d",mac:"cmd+shift+r d",when:"wallaby.started && editorTextFocus"},{command:"wallaby.showValue",key:"ctrl+shift+r v",mac:"cmd+shift+r v",when:"wallaby.started && editorTextFocus"},{command:"wallaby.copyValue",key:"ctrl+shift+r x",mac:"cmd+shift+r x",when:"wallaby.started && editorTextFocus"},{command:"wallaby.resetUncovered",key:"Escape",mac:"Escape",when:"wallaby.started && wallaby.uncoveredToggled && editorTextFocus"},{command:"wallaby.resetTestFilter",key:"shift+escape",mac:"shift+escape",when:"wallaby.started && wallaby.testFilterToggled && editorTextFocus"},{command:"wallaby.stopTraceNavigation",key:"shift+f5",mac:"shift+f5",when:"wallaby.started && wallaby.traceBeingNavigated && !inDebugMode"},{command:"wallaby.debugTest",key:"shift+f5",mac:"shift+f5",when:"wallaby.started && !wallaby.traceBeingNavigated && !inDebugMode"},{command:"wallaby.playTraceNextStep",key:"f11",mac:"f11",when:"wallaby.started && wallaby.traceBeingNavigated && !inDebugMode"},{command:"wallaby.playTraceForwardToSelection",key:"f5",mac:"f5",when:"wallaby.started && wallaby.traceBeingNavigated && !inDebugMode"},{command:"wallaby.playTraceNextStepOver",key:"f10",mac:"f10",when:"wallaby.started && wallaby.traceBeingNavigated && !inDebugMode"},{command:"wallaby.playTraceNextStepOut",key:"shift+f11",mac:"shift+f11",when:"wallaby.started && wallaby.traceBeingNavigated && !inDebugMode"},{command:"wallaby.playTracePrevStep",key:"ctrl+f11",mac:"ctrl+f11",when:"wallaby.started && wallaby.traceBeingNavigated && !inDebugMode"},{command:"wallaby.playTraceBackwardToSelection",key:"ctrl+f5",mac:"ctrl+f5",when:"wallaby.started && wallaby.traceBeingNavigated && !inDebugMode"},{command:"wallaby.playTracePrevStepOver",key:"ctrl+f10",mac:"ctrl+f10",when:"wallaby.started && wallaby.traceBeingNavigated && !inDebugMode"},{command:"wallaby.playTracePrevStepOut",key:"ctrl+shift+f11",mac:"ctrl+shift+f11",when:"wallaby.started && wallaby.traceBeingNavigated && !inDebugMode"}],languages:[{id:"wallaby-output"},{id:"wallaby-timeline"}],grammars:[{language:"wallaby-output",scopeName:"wallaby.output",path:"./wallaby-output.tmLanguage.json"},{language:"wallaby-timeline",scopeName:"source.wallaby-timeline",path:"./wallaby-timeline.tmGrammar.json"}],configuration:{type:"object",title:"Wallaby configuration",properties:{"wallaby.startAutomatically":{description:"Start Wallaby automatically if Wallaby was running when the folder/workspace was last opened",type:"boolean",default:!0},"wallaby.useHttpForDownload":{description:"Use HTTP protocol to download wallaby updates",type:"boolean",default:!1},"wallaby.strictSSL":{description:"Use strict SSL to download wallaby updates",type:"boolean",default:!0},"wallaby.noAutomaticInstall":{description:"Stop automatic wallaby core updates",type:"boolean",default:!1},"wallaby.showUpdateNotifications":{description:"Show wallaby core update notifications",type:"boolean",default:!0},"wallaby.suppressExpirationNotifications":{description:"Stop wallaby expiring license update reminders",type:"boolean",default:!1},"wallaby.node":{description:"Path to node.js executable that is used to run wallaby core",type:"string",default:""},"wallaby.useWsl":{description:"Use Windows Subsystem for Linux",type:"boolean",default:!1},"wallaby.reportFailuresAsProblems":{description:"Report Failing Tests to the VS Code Problems View",type:"boolean",default:!0},"wallaby.outputContentSize":{description:"Wallaby output content limit in bytes",type:"number",default:0},"wallaby.codeLens":{description:"Enable Code Lens",type:"boolean",default:!0},"wallaby.colors":{description:"Wallaby gutter indicators colors (requires a restart after change)",type:"object",default:{covered:"#62b455",errorPath:"#ffa0a0",errorSource:"#fe536a",notCovered:"#cccccc",partiallyCovered:"#d2a032","snapshot.covered":"#62b455","snapshot.errorPath":"#ffa0a0","snapshot.errorSource":"#fe536a","snapshot.notCovered":"#cccccc","snapshot.partiallyCovered":"#d2a032"}}}}},devDependencies:{"@babel/core":"^7.11.1","@babel/preset-env":"^7.11.0","@babel/preset-typescript":"^7.10.4","babel-jest":"^26.3.0",grunt:"*","grunt-babel":"5.0.1","grunt-browserify":"*","grunt-bump":"0.0.16","grunt-contrib-clean":"*","grunt-contrib-compress":"^0.12.0","grunt-contrib-copy":"*","grunt-contrib-uglify":"*","grunt-ts":"^6.0.0-beta.16",jest:"^26.4.0",lodash:"*",typescript:"^3.1.1",vsce:"^1.46.0",vscode:"^1.1.21"},optionalDependencies:{"aws-sdk":"^2.353.0",keytar:"^4.10.0"},dependencies:{"adm-zip-mit":"0.4.12","fs-extra":"0.26.2",lodash:"3.0.0",openurl:"1.1.1",request:"2.88.0","tar-stream":"1.3.1","unbzip2-stream":"1.0.8"},__metadata:{id:"6766254a-8e43-4ebc-9b89-e5be39cb5318",publisherDisplayName:"Wallaby.js",publisherId:"9e43bb4e-4318-4e59-b5c2-df1109a963dd"},scripts:{postinstall:"node ./node_modules/vscode/bin/install",build:"npm run test && node ./node_modules/grunt/bin/grunt",pub:"node ./node_modules/grunt/bin/grunt bump-only && npm run build && vsce publish && vsce package && node ./node_modules/grunt/bin/grunt publish-complete",release:"node ./docker/run.js",test:"jest"}}},{}]},{},[2]);