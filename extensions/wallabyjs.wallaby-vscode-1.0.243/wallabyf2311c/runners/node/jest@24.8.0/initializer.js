/*
 * Wallaby.js - v1.0.963
 * https://wallabyjs.com
 * Copyright (c) 2014-2020 Wallaby.js - All Rights Reserved.
 *
 * This source code file is a part of Wallaby.js and is a proprietary (closed source) software.

 * IMPORTANT:
 * Wallaby.js is a tool made by software developers for software developers with passion and love for what we do.
 * Pirating the tool is not only illegal and just morally wrong,
 * it is also unfair to other fellow programmers who are using it legally,
 * and very harmful for the tool and its future.
 */
var __assign=this&&this.__assign||function(){return __assign=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++){t=arguments[i];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},__assign.apply(this,arguments)},__awaiter=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n["throw"](e))}catch(t){s(t)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,s&&(o=2&i[0]?s["return"]:i[0]?s["throw"]||((o=s["return"])&&o.call(s),0):s.next)&&!(o=o.call(s,i[1])).done)return o;switch(s=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,s=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(o=l.trys,!(o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){l.label=i[1];break}if(6===i[0]&&l.label<o[1]){l.label=o[1],o=i;break}if(o&&l.label<o[2]){l.label=o[2],l.ops.push(i);break}o[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(n){i=[6,n],s=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,s,o,a,l={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},__read=this&&this.__read||function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,r,s=i.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(a){r={error:a}}finally{try{n&&!n.done&&(i=s["return"])&&i.call(s)}finally{if(r)throw r.error}}return o},path=require("path"),fs=require("fs"),tracer=global.$_$tracer,workerId=tracer.workerId,utils=tracer._utils,localProjectRoot=path.dirname(global.wallaby._localNodeModules),originalCacheRoot=global.wallaby._originalCacheRoot,jasmineInitializerPath=path.join(__dirname,"jasmineInitializer.js"),jestInstalledAndConfigured=!1,jest,jestCLI,jestRuntime,jestConfig,JestTestScheduler,jestRunGlobalHook;process.env.VUE_CLI_BABEL_TRANSPILE_MODULES=!0,process.env.BABEL_ENV||(process.env.BABEL_ENV="test"),process.env.NODE_ENV||(process.env.NODE_ENV="test"),process.env.PUBLIC_URL="",process.env.JEST_WORKER_ID=workerId,utils.patchModulesCode([{files:["@jest/transform/build/ScriptTransformer"],replacements:[{from:"const getScriptCacheKey = (filename, instrument) => {",to:"const getScriptCacheKey = (filename, instrument) => { var wallabyKey = global.$_$tracer._fileCacheKey(filename); if (wallabyKey) return wallabyKey;"},{from:"constructor(config) {",to:"constructor(config) { var _getTransformer = this._getTransformer; this._getTransformer = function(filename) { var transformer = _getTransformer.apply(this, arguments); return global.$_$tracer._extendJestTransformer ? global.$_$tracer._extendJestTransformer(filename, transformer) : transformer; };"},{from:"!!this._config.transform && !!this._config.transform.length && !isIgnored",to:"!isIgnored"},{from:"transform(filename, options, fileSource) {",to:"transform(filename, options, fileSource) { var wallabyFileId = global.$_$tracer._fileId(filename); if (wallabyFileId) { global.$_$tracer.programScopeStartLoading(wallabyFileId); }"}]},{files:["jest-resolve/build/defaultResolver"],replacements:[{from:"const checkedPaths = new Map();",to:"const checkedPaths = new Map(); checkedPaths.get = function() {};"}]},{files:["jest-message-util/build/index"],replacements:[{from:"${renderedCallsite}\\n${stacktrace}",to:"${stacktrace}"}]},{files:["vue-jest/lib/process.js"],replacements:[{from:"return { code: output }",to:"return { code: output, scriptSrc: parts.script && parts.script.src }",optional:!0},{from:"code: output.code,",to:"code: output.code, scriptSrc: descriptor.script && descriptor.script.src,",optional:!0}]},{files:["jest-snapshot/build/inline_snapshots.js"],replacements:[{from:"_callee$property$loc$.column",to:"0",optional:!0},{from:"const {line, column} = callee.property.loc.start;",to:"const {line } = callee.property.loc.start; const column = 0;",optional:!0},{from:"const snapshotsByFile = groupSnapshotsByFile(snapshots);",to:"global.$_$tracer._remapInlineSnapshots(snapshots); const snapshotsByFile = groupSnapshotsByFile(snapshots);"}]},{files:["jest-snapshot/build/State.js"],replacements:[{from:"const pass = expected === receivedSerialized;",to:"const pass = expected === receivedSerialized; global.$_$tracer._matchSnapshot({key, snapshotPath: this._snapshotPath});"},{from:"hasSnapshot && this._updateSnapshot === 'all'",to:"hasSnapshot && (!global.$_$tracer._updateNoMoreThanOneSnapshotPerTestFileRun || !pass && (this.updated === 0)) && this._updateSnapshot === 'all'"},{from:"this._updateSnapshot === 'all' && this._uncheckedKeys.size",to:"this._updateSnapshot === 'all' && (!global.$_$tracer._updateNoMoreThanOneSnapshotPerTestFileRun || (this.updated === 0)) && this._uncheckedKeys.size"}]},{files:["ts-jest/dist/compiler.js"],replacements:[{from:"getScriptVersion: function (fileName) {",to:'getScriptVersion: function (fileName) { fileName = require("path").normalize(fileName);'},{from:"getScriptSnapshot: function (fileName) {",to:'getScriptSnapshot: function (fileName) { fileName = require("path").normalize(fileName);'}]},{files:["jest-runner/build/index.js"],replacements:[{from:"process.env.JEST_WORKER_ID = '1';",to:""}]},{files:["jest-jasmine2/build/jasmine/Env.js"],replacements:[{from:"oldListenersException = process",to:"oldListenersException = (j$.process || process)"},{from:"oldListenersRejection = process",to:"oldListenersRejection = (j$.process || process)"}]},{files:["jest-util/build/setGlobal.js"],replacements:[{from:"globalToMutate[key] = value;",to:"globalToMutate[key] = value;\n             if (globalToMutate.$_$wp) return;\n             if (!globalToMutate.regeneratorRuntime && global.regeneratorRuntime) {\n              globalToMutate.regeneratorRuntime = global.regeneratorRuntime;\n             }\n             globalToMutate.$_$wp = global.$_$wp;\n             globalToMutate.$_$wpe = global.$_$wpe;\n             globalToMutate.$_$w = global.$_$w;\n             globalToMutate.$_$w_ = global.$_$w_;\n             globalToMutate.$_$wf = global.$_$wf;\n             globalToMutate.$_$wv = global.$_$wv;\n             globalToMutate.$_$tracer = global.$_$tracer;\n             global.$_$tracer.setEnvGlobal(globalToMutate);\n             globalToMutate.$_$tracer._jasmineAdapter = new global.$_$tracer.JasmineReporter(global.$_$tracer);\n        "}]}],"Possibly incompatible/unsupported Jest version");var JasmineReporter=function(e){var t=global.$_$session,i=e.initialSpecId(),n=[],r=function(){return t!==global.$_$session};this.jasmineDone=function(){r()||(global.$_$initialSpecId=i+1)},this.jasmineStarted=function(){r()||e.started({total:"unknown number of"})},this.suiteStarted=function(e){r()||n.push(e.description)},this.suiteDone=function(){r()||n.pop()},this.specStarted=function(t){r()||(t._id=++i,e.specStart(t._id,t.fullName),t._time=(new e._Date).getTime())},this.specDone=function(t){if(!r()){var i=e.specEnd(),s="passed"===t.status,o="disabled"===t.status||"pending"===t.status||"todo"===t.status,a=o?"pending"===t.status?"skipped":"todo"===t.status?"todo":"disabled"===t.status?"disabled":"executed":"executed",l={id:t._id,timeRange:i,name:t.description,suite:n.slice(),status:a,time:o?0:(new e._Date).getTime()-t._time,log:[],testFile:t._testFile};if(!s&&!o)for(var c=t.failedExpectations,u=0;u<c.length;u++){var h=c[u];if(h.error){if(h.message&&0===h.message.indexOf("Error: expect(")){var f=h.message.split("\n");f.shift(),f[0]&&0!==f[0].length||f.shift(),h.message=f.join("\n")}h.error.matcherResult?(h.matcherName=h.error.matcherResult.name,h.actual=h.error.matcherResult.actual,h.expected=h.error.matcherResult.expected):(h.showDiff=h.error.showDiff,h.actual=h.error.actual,h.expected=h.error.expected)}h.showDiff=h.showDiff||"toEqual"===h.matcherName||"toBe"===h.matcherName||"toMatchSnapshot"===h.matcherName||"toMatchInlineSnapshot"===h.matcherName||"toThrowErrorMatchingSnapshot"===h.matcherName,l.log.push(e.setAssertionData(h,{message:h.message,stack:h.stack}))}l.log.length||delete l.log,e.result(l)}}};tracer.JasmineReporter=JasmineReporter;var WallabyRunner=function(){function e(e){this._sessionId=e,this._runComplete=!1}return e.prototype.onRunStart=function(){},e.prototype.onTestStart=function(){},e.prototype.isActive=function(){return this._sessionId===global.$_$session},e.prototype.getLastError=function(){return this._error},e.prototype._setError=function(e){this._error=e},e.prototype.completeRun=function(e){!this._runComplete&&this.isActive()&&(this._runComplete=!0,tracer.resetEnvGlobal(),tracer.complete(e))},e.prototype.onTestResult=function(e,t){t.testExecError&&this.isActive()&&(tracer.reportGlobalErrorObject(__assign(__assign({},t.testExecError),{message:t.testExecError.message,stack:t.testExecError.stack,testFilePath:t.testFilePath})),this.completeRun())},e.prototype.onRunComplete=function(e,t){!tracer.canUpdateSnapshots()&&t&&t.testResults&&t.testResults.forEach&&t.testResults.forEach(function(e){if(e&&e.snapshot&&e.snapshot.unchecked){var t=e.snapshot.unchecked+" snapshot"+(e.snapshot.unchecked>1?"s":"")+" obsolete "+(e.snapshot.uncheckedKeys&&"\n\t"+e.snapshot.uncheckedKeys.join("\n\t")||"");tracer.reportGlobalErrorObject({message:t,stack:t+"\n    at "+e.testFilePath+":1:0",snapshot:!0,allowNotMappedStackLines:!0})}}),this.completeRun()},e}(),initializeJest=function(){return __awaiter(void 0,void 0,void 0,function(){var e,t,i,n,r,s,o,a,l;return __generator(this,function(c){switch(c.label){case 0:return[4,utils.loadJest(localProjectRoot,global.wallaby._testFrameworkPath,global.wallaby._testConfigFile)];case 1:if(e=c.sent()||{},t=e.jestCLI,i=e.jestConfigLoader,jestConfig=global.wallaby.customJestConfig||e.jestConfig,!t)throw new Error("Can not find jest-cli module");if(!jestConfig)throw new Error("Can not load jest config");if(!i)throw new Error("Can not find jest-config module");if(jestRuntime=utils.tryRequireModuleWithPathFrom(i.path,"jest-runtime",1),!jestRuntime)throw new Error("Can not find Jest runtime module");if(n=utils.tryRequireModuleWithPathFrom(t.path,"@jest/core"),!n)throw new Error("Can not find Jest core module");if(JestTestScheduler=n.module.TestScheduler,!JestTestScheduler)throw new Error("Can not find Jest test scheduler module");return r=utils.tryRequireModuleWithPathFrom(t.path,"@jest/reporters"),r?(s=function(e,t){var i=e.prototype;i.log=i._write=t?function(){}:function(e){console.log("Jest: "+e+"\n")}},s(r.module.BaseReporter),s(r.module.DefaultReporter),s(r.module.SummaryReporter,!0)):console.warn("Can not find Jest reporters module"),jestRunGlobalHook=utils.tryRequireModuleWithPathFrom(t.path,"@jest/core/build/runGlobalHook"),jestRunGlobalHook||console.warn("Can not find Jest run global hook module"),o=utils.tryRequireModuleWithPathFrom(t.path,"@jest/console"),o?tracer._reportConsoleErrorAsError&&(a=function(e){var t=e.prototype,i=t.error;t.error=function(){return tracer._error.apply(tracer,arguments),i.apply(this,arguments)}},a(o.module.BufferedConsole),a(o.module.CustomConsole)):console.warn("Can not find Jest console module"),jestConfig.configs=(jestConfig.configs||[]).filter(function(e){return"jest-runner"===e.runner||~utils.normalizePath(e.runner||"").indexOf("node_modules/jest-runner/")||"jest-runner-groups"===e.runner||~utils.normalizePath(e.runner||"").indexOf("node_modules/jest-runner-groups/")}),jestConfig.configs.forEach(function(e){if(e.bail=0,e.notify=0,e.collectCoverage=!1,e.collectCoverageFrom=e.collectCoverageFrom||(jestConfig.globalConfig||{}).collectCoverageFrom,e.collectCoverageFrom&&e.collectCoverageFrom.length||(e.collectCoverageFrom=["**/*.{"+e.moduleFileExtensions.join(",")+"}"]),e.coveragePathIgnorePatterns=e.coveragePathIgnorePatterns&&e.coveragePathIgnorePatterns.map(function(e){return new RegExp(e)}),e.errorOnDeprecated=!1,e.setupFilesAfterEnv=e.setupFilesAfterEnv||[],e.transformIgnorePatterns=e.transformIgnorePatterns||[],e.testRunner=e.testRunner.replace("jest-circus/runner","jest-jasmine2/build/index").replace("jest-circus\\runner","jest-jasmine2\\build\\index"),e.setupFilesAfterEnv.unshift(jasmineInitializerPath),e.transformIgnorePatterns.push(utils.replacePathSepForRegex(path.join(path.basename(path.dirname(jasmineInitializerPath)),path.basename(jasmineInitializerPath)))),e.verbose=null,delete e.watchPlugins,e.globals=e.globals||{},e.globals["ts-jest"]=e.globals["ts-jest"]||{},e.globals["ts-jest"].diagnostics!==!0&&(e.globals["ts-jest"].diagnostics=!1),e.resolver){var t=path.join("node_modules","@nrwl","jest","plugins","resolver.js");if(e.resolver.endsWith(t)){var i=path.dirname(path.dirname(path.dirname(path.dirname(path.dirname(e.resolver))))),n=path.join(i,"angular.json"),r=path.join(i,"workspace.json"),s=fs.existsSync(n)?n:fs.existsSync(r)?r:void 0;if(s&&fs.statSync(s)){var o=path.relative(i,e.rootDir).replace(/\\/,"/");try{var a=JSON.parse(fs.readFileSync(s).toString()),l=Object.keys(a.projects).map(function(e){return __assign({},a.projects[e])}).filter(function(e){return e.root===o}).filter(function(e){return e.architect&&e.architect.test&&"@nrwl/jest:jest"===e.architect.test.builder}).map(function(e){return e.architect.test.options});if(1===l.length){var c=l[0].tsConfig,u=l[0].setupFile;c&&(e.globals["ts-jest"].tsConfig="<rootDir>/"+path.relative(o,c)),u&&e.setupFilesAfterEnv.push(path.resolve(i,u)),e.globals["ts-jest"].stringifyContentPathRegex="\\.html$",s===n&&(utils.tryRequireModuleWithPathFrom(localProjectRoot,"jest-preset-angular/InlineHtmlStripStylesTransformer")?e.globals["ts-jest"].astTransformers=["jest-preset-angular/InlineHtmlStripStylesTransformer"]:utils.tryRequireModuleWithPathFrom(localProjectRoot,"jest-preset-angular/build/InlineFilesTransformer")&&(e.globals["ts-jest"].astTransformers=["jest-preset-angular/build/InlineFilesTransformer","jest-preset-angular/build/StripStylesTransformer"]))}}catch(h){}}}}}),l=jestConfig.globalConfig,l.notify=!1,l.bail=0,l.collectCoverage=!1,l.detectLeaks=!1,l.detectOpenHandles=!1,l.errorOnDeprecated=!1,l.json=!1,l.maxWorkers=1,l.useStderr=!1,l.watch=!1,l.verbose=null,process.env.NO_WATCHMAN&&(l.watchman=!1),delete l.findRelatedTests,delete l.listTests,delete l.forceExit,delete l.onlyChanged,delete l.onlyFailures,delete l.outputFile,delete l.passWithNoTests,delete l.watchAll,delete l.watchPlugins,[2]}})})},testRunner,testFiles,testContexts,testFilesByPath,noopTestWatcher={setState:function(){},isInterrupted:function(){return!1},isWatchMode:function(){return!1}},configure=function(e){return __awaiter(void 0,void 0,void 0,function(){var t;return __generator(this,function(i){switch(i.label){case 0:return t=global.$_$session,testRunner?[2,testRunner]:[4,initializeJest()];case 1:return i.sent(),e&&jestConfig.configs.forEach(function(t){Object.keys(e).forEach(function(i){"bail"!==i&&"notify"!==i&&"collectCoverage"!==i&&"errorOnDeprecated"!==i&&"testRunner"!==i&&"verbose"!==i&&"watchPlugins"!==i&&("setupFilesAfterEnv"===i||"transformIgnorePatterns"===i?t[i]=t[i].concat(e[i]):t[i]=e[i])})}),[4,Promise.all(jestConfig.configs.map(function(e){return jestRuntime.module.createContext(e,{maxWorkers:jestConfig.globalConfig.maxWorkers,watchman:jestConfig.globalConfig.watchman})}))];case 2:return testContexts=i.sent(),t!==global.$_$session?[2]:(testRunner=new JestTestScheduler(jestConfig.globalConfig),[2,testRunner])}})})},getTestData=function(e){return e.map(function(e){return{path:e,context:testContexts.length>1?testContexts.reduce(function(t,i){e&&(e=e.normalize());var n=e.replace((i.config.rootDir||"").normalize(),"").length;return t?t.relativePathLength>n?{context:i,relativePathLength:n}:t:{context:i,relativePathLength:n}},void 0).context:testContexts[0]}})},globalSetupTeardown=function(e,t){return __awaiter(void 0,void 0,void 0,function(){var i,n,r,s,o,a;return __generator(this,function(l){switch(l.label){case 0:i={},l.label=1;case 1:l.trys.push([1,3,,4]);try{i=JSON.parse(JSON.stringify(process.env))}catch(c){return tracer.reportGlobalError("Failed to serialize existing process.env: "+(c&&c.message||"")),e.completeRun(),[2]}return[4,jestRunGlobalHook.module({allTests:t,globalConfig:jestConfig.globalConfig,moduleName:"globalSetup"})];case 2:return l.sent(),[3,4];case 3:return n=l.sent(),tracer.reportGlobalError("Failed to run jest globalSetup: "+(n&&n.message||"")),e.completeRun(),[2];case 4:r={};try{s=JSON.parse(JSON.stringify(process.env)),o=Object.keys(s).filter(function(e){return void 0===i[e]||i[e]!==s[e]}).map(function(e){return{variable:e,value:s[e]}}),a=Object.keys(i).filter(function(e){return void 0===s[e]}),r={updates:o,deletions:a}}catch(c){return tracer.reportGlobalError("Failed to serialize process.env: "+(c&&c.message||"")),e.completeRun(),[2]}return tracer.globalSetupComplete(r),global.wallaby.teardown=function(){return __awaiter(void 0,void 0,void 0,function(){var i;return __generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,jestRunGlobalHook.module({allTests:t,globalConfig:jestConfig.globalConfig,moduleName:"globalTeardown"})];case 1:return n.sent(),e.completeRun(),[3,3];case 2:return i=n.sent(),tracer.reportGlobalError("Failed to run jest globalTeardown: "+(i&&i.message||"")),e.completeRun(),[2];case 3:return[2]}})})},[2]}})})};tracer.start(function(){return __awaiter(void 0,void 0,void 0,function(){var e,t,i,n,r;return __generator(this,function(s){switch(s.label){case 0:return s.trys.push([0,8,,9]),testFilesByPath=void 0,e=new WallabyRunner(global.$_$session),[4,configure()];case 1:return t=s.sent(),t&&e.isActive()?(t.removeReporter(WallabyRunner),t.addReporter(e),i=getTestData(testFiles),global.wallaby.runGlobals?[4,globalSetupTeardown(e,i)]:[3,3]):[2];case 2:return s.sent(),[3,7];case 3:return s.trys.push([3,5,6,7]),jestConfig.globalConfig.updateSnapshot=tracer.canUpdateSnapshots()?"all":process.env.CI?"none":"new",e.isActive()?[4,t.scheduleTests(i,noopTestWatcher)]:[2];case 4:return s.sent(),[3,7];case 5:return n=s.sent(),n&&console.error(n.stack),[3,7];case 6:return e.completeRun(),[7];case 7:return[3,9];case 8:return r=s.sent(),tracer.reportGlobalError("Failed to initialize wallaby jest.\n"+(r&&r.message||"")),[3,9];case 9:return[2]}})})});var getFileData=function(e){var t=global.wallaby.localProjectDir,i=global.wallaby.projectCacheDir,n=utils.normalizePath(e.replace(t,"").replace(i,""));return"/"===n[0]&&(n=n.substr(1)),tracer._filePathToFileData[n]},initializeTestsByFilePath=function(){testFilesByPath||(testFilesByPath={},global.$_$testFiles.forEach(function(e){testFilesByPath[e.path]=e}))};tracer._fileCacheKey=function(e){var t=getFileData(e);if(t){var i=t.path+"_"+workerId+"_"+t.id+"_"+t.ts;if(t.childFilePath){var n=getFileData(t.childFilePath);n&&(i+="_"+n.id+"_"+n.ts)}return i}},tracer._fileId=function(e){var t=getFileData(e);if(t)return t.id},tracer._remapInlineSnapshots=function(e){initializeTestsByFilePath(),e.forEach(function(e){if(e.frame){var t=testFilesByPath[path.normalize(e.frame.file)];t&&t.lineMap&&(e.frame.line=utils.getOriginalLineByGeneratedLine(t.lineMap,e.frame.line,e.frame.column)||e.frame.line,e.frame.column=1)}})},tracer._matchSnapshot=function(e){var t=e.key,i=e.snapshotPath;if(tracer._expectedMatchSnapshotCall){var n=__read(tracer._expectedMatchSnapshotCall,2),r=n[0],s=n[1];delete tracer._expectedMatchSnapshotCall,tracer._matchSnapshotCalls||(tracer._matchSnapshotCalls=[]),tracer._matchSnapshotCalls.push({fileId:r,snapshotCallRangeId:s,snapshotKey:t,snapshotPath:utils.normalizePath(path.relative(localProjectRoot,i))})}},tracer._beforeMatchSnapshot=function(e,t){tracer._expectedMatchSnapshotCall=[e,t]};var readFileSync=fs.readFileSync;fs.readFileSync=function(e){var t=getFileData(e);return t&&t.inOriginalFilesCache&&(arguments[0]=path.join(originalCacheRoot,t.path)),readFileSync.apply(this,arguments)},tracer._extendJestTransformer=function(e,t){var i=getFileData(e);if(!i||!i.instrument)return t;var n=function(e,t,i){return!!e.test||!(i.coveragePathIgnorePatterns||[]).some(function(e){return utils.pathMatchesPattern(t,e,{absolute:!0})})&&(".node"!==path.extname(t)&&".json"!==path.extname(t)&&!i.collectCoverageFrom.some(function(t){return"!"===t[0]&&!utils.pathMatchesPattern(e.path,t,{micromatch:!0})})&&i.collectCoverageFrom.some(function(t){return"!"!==t[0]&&utils.pathMatchesPattern(e.path,t,{micromatch:!0})}))},r=function(e){var t=e.getCacheKey||function(e,t){return t};e.getCacheKey=function(i,n,r,s){var o=t.call(e,i,n,r,s),a=getFileData(n);if(a&&(o+="_"+a.id+"_"+workerId+"_"+a.ts+(global.wallaby.runGlobals?"_1":""),a.childFilePath)){var l=getFileData(a.childFilePath);l&&(o+="_"+l.id+"_"+l.ts)}return o};var i=e.process;return e.process=function(t,r,s,o){var a=i.call(e,t,r,s,o),l=!0;a&&null===a.code&&(a.code=t,l=!1);var c;a&&a.scriptSrc&&(c=getFileData(r),c&&(r=path.join(r,"..",a.scriptSrc)),delete a.scriptSrc);var u=getFileData(r);if(u&&!global.wallaby.runGlobals&&n(u,r,s)){var h=u.id;"string"==typeof a?a={code:a,map:utils.getSourceMapFromCode(a)}:l&&"string"==typeof a.code&&!a.map&&(a.map=utils.getSourceMapFromCode(a.code)),"string"==typeof a.map&&(a.map=JSON.parse(a.map)),a.map&&a.map.constructor&&"SourceMapGenerator"===a.map.constructor.name&&(a.map=JSON.parse(a.map.toString()));var f=a.code,d=_.extend({},global.$_$tracer._hints);u.test&&(d.allowIgnoringCoverageInTests||(d=_.omit(d,"ignoreCoverage","ignoreCoverageForFile"))),d=_.omit(d,"testFileSelection");var p=a.map&&(u.changeStart||u.transientChange||u.test)&&new utils.SourceMapConsumer(a.map),g=utils.mapTextPosition(u.changeStart&&u.changePosition,p),v=void 0;try{var y=u.transientChange&&u.transientChange.range&&utils.mapOriginalRangeToTransformed(p,u.transientChange.range);v=utils.instrument(f,{file:h,test:u.test,fileName:path.basename(u.path),testFileChangeStart:g,hints:d,recordValues:global.$_$tracer._autoConsoleLog,recordMatchSnapshotRanges:!0,preserveComments:global.$_$tracer._preserveComments,virtualLog:y?{changeId:u.transientChange.id,traceId:u.transientChange.traceId,expanded:u.transientChange.expanded,range:y}:void 0})}catch(m){throw utils.formatInstrumentationError(m,f,u.path)}if(tracer.sendTransformedFile({id:h,parentFilePath:c&&c.path,transformed:_.omit(a,"code"),instrumented:_.omit(v,"code","map"),lineMap:utils.updateFileMap({},a.map?[a.map,v.map]:[v.map]),ts:u.ts,matchSnapshotRanges:v.matchSnapshotRanges&&v.matchSnapshotRanges.length&&p?v.matchSnapshotRanges.map(function(e){return utils.mapTransformedRangeToOriginal(p,e)}):void 0}),v.numberOfFunctions!==u.numberOfFunctions&&delete v.testName,u.test&&(!global.$_$traceContext||!global.$_$traceContext.test))if(v.testName&&u.allowedToRunSingleTestOnly){"*"===global.$_$tests&&(global.$_$tests={});var b=global.$_$tests[":?"]=global.$_$tests[":?"]||{};b[":"+v.testName]="*"}else global.$_$tests&&global.$_$tests[":?"]&&(global.$_$tests="*");var T=utils.docBlockComment(a.code).replace(/\r?\n|\r/g," ");T&&(v.code=T+v.code),a.code=v.code,delete a.map;for(var S=global.$_$coverage[h]=[],k=0;k<v.ranges.length;k++)S[k]={}}return a},e._wallabyExtended=!0,e};return t?t&&!t._wallabyExtended?r(t):t:r({getCacheKey:function(e,t,i,n){return t},process:function(e,t,i,n){return{code:null,map:null}}})},module.exports={init:function(e){return testFiles=e,{configure:function(e){testRunner||configure(e)["catch"](function(e){return console.error("Error while trying to configure jest: "+(e&&e.message||""))})}}}};