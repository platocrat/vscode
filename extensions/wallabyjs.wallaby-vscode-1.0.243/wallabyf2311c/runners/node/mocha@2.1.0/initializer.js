/*
 * Wallaby.js - v1.0.963
 * https://wallabyjs.com
 * Copyright (c) 2014-2020 Wallaby.js - All Rights Reserved.
 *
 * This source code file is a part of Wallaby.js and is a proprietary (closed source) software.

 * IMPORTANT:
 * Wallaby.js is a tool made by software developers for software developers with passion and love for what we do.
 * Pirating the tool is not only illegal and just morally wrong,
 * it is also unfair to other fellow programmers who are using it legally,
 * and very harmful for the tool and its future.
 */
var __awaiter=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n["throw"](e))}catch(t){s(t)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,s&&(o=2&i[0]?s["return"]:i[0]?s["throw"]||((o=s["return"])&&o.call(s),0):s.next)&&!(o=o.call(s,i[1])).done)return o;switch(s=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,s=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(o=l.trys,!(o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){l.label=i[1];break}if(6===i[0]&&l.label<o[1]){l.label=o[1],o=i;break}if(o&&l.label<o[2]){l.label=o[2],l.ops.push(i);break}o[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(n){i=[6,n],s=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,s,o,a,l={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},Mocha;if(global.wallaby._testFrameworkPath)Mocha=require(global.wallaby._testFrameworkPath);else try{Mocha=require("mocha")}catch(e){Mocha=require("./framework/index.js")}var mocha,tracer=global.$_$tracer;tracer.start(function(){return __awaiter(this,void 0,void 0,function(){var e,t,i,n,r;return __generator(this,function(s){switch(s.label){case 0:return e=tracer.initialSpecId(),t=[],n=global.$_$session,r=function(){return n!==global.$_$session},mocha.reporter(function(n){var s=n._grep||/.*/,o=n._invert,a=!1;if(n._invert=!1,n.runTest=function(e){if(!r()){var t=this.test,i=this;this.asyncOnly&&(t.asyncOnly=!0);try{this._addEventListener?this._addEventListener(t,"error",function(e){i.fail(t,e)}):t.on("error",function(e){i.fail(t,e)}),tracer.specSyncStart();try{t.run(e)}finally{tracer.specSyncEnd()}}catch(n){e(n)}}},n.grep=function(e,t){s=e,o=t,n._invert=!1},n.grepTotal=function(e){var t=0;return e.eachTest(function(e){var i=s.test(e.fullTitle());o&&(i=!i),i&&t++}),t},n._grep={test:function(e){var i=s.test(e);if(o&&(i=!i),!i)return!1;if(!tracer.hasSpecFilter())return!0;var n=t.slice(1);return n.push(e.substr(n.join(" ").length+(a&&0===n.length?0:1))),tracer.specFilter(n)}},tracer.needToNotifySingleTestRun()){var l=n.hook;n.hook=function(e,t){if(!r()){if("afterEach"!==e)return Function.prototype.apply.call(l,this,arguments);var i=arguments,s=this;tracer.notifySingleTestAfterEach(function(){Function.prototype.apply.call(l,s,i)}),n.hook=l}}}n.on("start",function(){r()||tracer.started({total:n.total})}),n.on("end",function(){r()||tracer.complete()}),n.on("suite",function(e){a=a||!!e.titlePath,r()||(t.push(e.title),i=e)}),n.on("suite end",function(){r()||t.pop()}),n.on("test",function(t){r()||(t._id=++e,t._failures=[],t._time=(new tracer._Date).getTime(),tracer.specStart(t._id,t.title))}),n.on("fail",function(e,t){r()||("hook"===e.type||e._finished?(e._hook="hook"===e.type&&e.title||!0,e._failures=[t],n.emit("test end",e)):e._failures.push(t))}),n.on("test end",function(i){if(!r()){i._finished=!0;var n=tracer.specEnd(),s=function(e){return!!e&&(e.pending===!0||s(e.parent))},o=s(i),a="passed"===i.state,l=o?"skipped":"executed",c={id:void 0===i._id?++e:i._id,timeRange:n,name:i.title,suite:t.slice(1),status:l,time:o?0:(new tracer._Date).getTime()-i._time,log:[],hook:i._hook,slow:i.slow?i.duration>i.slow():void 0,testFile:i._testFile};if(!a&&!o)for(var u=i._failures,h=0;h<u.length;h++){var f=u[h];c.log.push(tracer.setAssertionData(f,{message:f.message,stack:f.stack}))}c.log.length||delete c.log,tracer.result(c)}})}),mocha.suite.on("pre-require",function(e){var t=e.it;e.it=function(){var e=Function.prototype.apply.call(t,this,arguments);return e._testFile=tracer.entryFile(),e},Object.keys(t).forEach(function(i){e.it[i]=t[i]})}),mocha.loadFilesAsync?[4,mocha.loadFilesAsync()]:[3,2];case 1:s.sent(),s.label=2;case 2:return mocha.run(function(){}),[2]}})})}),module.exports={init:function(e){mocha&&mocha.dispose&&mocha.dispose(),mocha=new Mocha,mocha.files=e;try{mocha.slow&&mocha.slow(global.wallaby.slowTestThreshold),mocha.fullTrace&&mocha.fullTrace()}catch(t){}return mocha}};